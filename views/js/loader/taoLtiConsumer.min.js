!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash")):"function"==typeof define&&define.amd?define("core/format",["lodash"],factory):(global=global||self)["core/format"]=factory(global._)}(this,function(_){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_;var pattern=/(%[sdj])/g;return function(message){var replacements=Array.prototype.slice.call(arguments,1);return _.reduce(message.match(pattern),function(acc,match,index){var replacement="";if(void 0!==replacements[index]){switch(match){case"%d":replacement=Number(replacements[index]);break;case"%j":try{replacement=JSON.stringify(
replacements[index]).replace(/"/g,"")}catch(e){}break;default:replacement=replacements[index]}message=message.replace(match,replacement)}return message},message)}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("core/promise",factory):(global=global||self)["core/promise"]=factory()}(this,function(){"use strict";return Promise}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("lib/uuid",factory):(global=global||self).uuid=factory()}(this,function(){"use strict"
;var CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");return function(len,radix){var i,r,chars=CHARS,uuid=[];if(radix=radix||chars.length,len)for(i=0;i<len;i++)uuid[i]=chars[0|Math.random()*radix];else for(uuid[8]=uuid[13]=uuid[18]=uuid[23]="-",uuid[14]="4",i=0;i<36;i++)uuid[i]||(r=0|16*Math.random(),uuid[i]=chars[19===i?3&r|8:r]);return uuid.join("")}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/format"),require("core/promise")):"function"==typeof define&&define.amd?define("core/logger/api",["lodash","core/format","core/promise"],factory
):(global=global||self)["core/logger/api"]=factory(global._,global["core/format"],global["core/promise"])}(this,function(_,format,Promise){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,format=format&&format.hasOwnProperty("default")?format.default:format,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise;function loggerFactory(name,minLevel,fields){var baseRecord,logger;if(!_.isString(name)||_.isEmpty(name))throw new TypeError("A logger needs a name");return _.isPlainObject(minLevel)&&"undefined"==typeof field&&(fields=minLevel,minLevel=defaultLevel),baseRecord=_.defaults(fields||{},{name:name,pid:1,
hostname:navigator.userAgent}),logger={log:function(level,recordFields,message){var record,err,rest=[],time=(new Date).toISOString();if(!1!==loggerFactory.providers&&checkMinLevel(minLevel||defaultLevel,level))return rest=_.isString(recordFields)||recordFields instanceof Error?(message=recordFields,recordFields={},[].slice.call(arguments,2)):[].slice.call(arguments,3),record={level:getLevel(level),v:0,time:time},checkMinLevel(levels.error,level)||message instanceof Error?(err=message instanceof Error?message:(message=_.isObject(message)?JSON.stringify(message):message,new Error(message)),record.msg=err.message,record.err=err):record.msg=format.apply(null,[
message].concat(rest)),_.merge(record,baseRecord,recordFields),logQueue.push(record),loggerFactory.flush(),this},level:function(value){return void 0!==value?(minLevel=getLevelNum(value),this):getLevel(minLevel)},child:function(childFields){return loggerFactory(name,minLevel,_.defaults(childFields,baseRecord))}},_.reduce(levels,function(target,level,levelName){return target[levelName]=_.partial(logger.log,level),target},logger)}var defaultLevel="info",levels={fatal:60,error:50,warn:40,info:30,debug:20,trace:10},logQueue=[],getLevel=function(level){return void 0===level||_.isString(level)&&!_.has(levels,level)?defaultLevel:_.isNumber(level)?_.findKey(levels,
function(l){return l===level})||defaultLevel:level},getLevelNum=function(level){return _.isString(level)&&_.has(levels,level)?levels[level]:_.isNumber(level)&&_.contains(levels,level)?level:levels[defaultLevel]},checkMinLevel=function(minLevel,level){return getLevelNum(level)>=getLevelNum(minLevel)};return loggerFactory.levels=levels,loggerFactory.providers=!1,loggerFactory.load=function(providerConfigs){var self=this,modules=[];return this.providers=[],new Promise(function(resolve,reject){_.forEach(providerConfigs,function(providerConfig,providerName){modules.push(providerName)}),require(modules,function(){var loadedProviders=[].slice.call(arguments)
;_.forEach(loadedProviders,function(provider,moduleKey){try{self.register(provider,providerConfigs[modules[moduleKey]])}catch(err){reject(err)}}),self.flush(),resolve()},reject)})},loggerFactory.register=function(provider,providerConfig){if(!_.isPlainObject(provider)||!_.isFunction(provider.log))throw new TypeError("A log provider is an object with a log method");provider.checkMinLevel=checkMinLevel,_.isFunction(provider.setConfig)&&provider.setConfig(providerConfig),this.providers=this.providers||[],this.providers.push(provider)},loggerFactory.flush=function(){_.isArray(this.providers)&&0<this.providers.length&&(_.forEach(logQueue,function(message){
_.forEach(loggerFactory.providers,function(provider){provider.log.call(provider,message)})}),logQueue=[])},loggerFactory.setDefaultLevel=function(level){return defaultLevel=getLevel(level)},loggerFactory}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("module"),require("core/logger/api")):"function"==typeof define&&define.amd?define("core/logger",["lodash","module","core/logger/api"],factory):(global=global||self)["core/logger"]=factory(global._,global.module,global["core/logger/api"])}(this,function(_,module,loggerFactory){"use strict";_=_&&_.hasOwnProperty("default"
)?_.default:_,module=module&&module.hasOwnProperty("default")?module.default:module;var defaultConfig={level:(loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory.default:loggerFactory).levels.warn,loggers:{"core/logger/console":{level:"warn"}}},config=_.defaults(module.config()||{},defaultConfig),logger=loggerFactory("core/logger");return loggerFactory.setDefaultLevel(config.level),loggerFactory.load(config.loggers),window.onerror=function(msg,url,line,col,error){logger.error("Caught[via window.onerror]: '"+msg+"' from "+url+":"+line+":"+col)},window.setTaoLogLevel=function(level){return loggerFactory.setDefaultLevel(level)},
loggerFactory}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("lib/uuid"),require("core/logger")):"function"==typeof define&&define.amd?define("core/eventifier",["lodash","core/promise","lib/uuid","core/logger"],factory):(global=global||self)["core/eventifier"]=factory(global._,global["core/promise"],global["lib/uuid"],global["core/logger"])}(this,function(_,Promise,uuid,loggerFactory){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,uuid=uuid&&uuid.hasOwnProperty(
"default")?uuid.default:uuid,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory.default:loggerFactory;var defaultNs="@",eventifierLogger=loggerFactory("core/eventifier");function getEventNames(eventNames){return!_.isString(eventNames)||_.isEmpty(eventNames)?[]:_(eventNames.split(/\s/g)).compact().uniq().value()}function getName(eventName){return-1<eventName.indexOf(".")?eventName.substr(0,eventName.indexOf(".")):eventName}function getNamespace(eventName){return-1<eventName.indexOf(".")?eventName.substr(eventName.indexOf(".")+1):defaultNs}return function(target){var targetName,logger,stoppedEvents,eventHandlers={},
getHandlers=function(eventName,type){var name=getName(eventName),ns=getNamespace(eventName);return type=type||"between",eventHandlers[ns]=eventHandlers[ns]||{},eventHandlers[ns][name]=eventHandlers[ns][name]||{before:[],between:[],after:[]},eventHandlers[ns][name][type]},eventApi={on:function(eventNames,handler){return _.isFunction(handler)&&_.forEach(getEventNames(eventNames),function(eventName){getHandlers(eventName).push(handler)}),this},off:function(eventNames){return _.forEach(getEventNames(eventNames),function(eventName){var offNamespaces,name=getName(eventName),ns=getNamespace(eventName);ns&&!name?"*"===ns?((offNamespaces={}
)[defaultNs]=eventHandlers[defaultNs],eventHandlers=offNamespaces):eventHandlers[ns]={}:_.forEach(eventHandlers,function(nsHandlers,namespace){!nsHandlers[name]||ns!==defaultNs&&ns!==namespace||(nsHandlers[name]={before:[],between:[],after:[]})})}),this},removeAllListeners:function(){return eventHandlers={},this},trigger:function(eventNames){var self=this,args=[].slice.call(arguments,1);function triggerBetween(allHandlers,event){shouldStop(event.name)?logHandlerStop("before",event):triggerHandlers(allHandlers.between,event).then(function(){!function(handlers,event){shouldStop(event.name)?logHandlerStop("on",event):triggerHandlers(handlers,event).then(
function(){shouldStop(event.name)&&logHandlerStop("after",event)}).catch(function(err){logHandlerStop("after",event,err)})}(allHandlers.after,event)}).catch(function(err){logHandlerStop("on",event,err)})}function triggerHandlers(handlers,event){var pHandlers;return pHandlers=handlers.map(function(handler){return shouldStop(event.name)?Promise.reject():handler.apply(self,args)}),Promise.all(pHandlers)}function logHandlerStop(stoppedIn,event,err){err instanceof Error&&logger.error(err),logger.trace({err:err,event:event.name,stoppedIn:stoppedIn},event.name+" handlers stopped")}function shouldStop(name){return stoppedEvents[name]}return stoppedEvents={},
_.forEach(getEventNames(eventNames),function(eventName){var ns=getNamespace(eventName),name=getName(eventName),mergedHandlers=_(eventHandlers).filter(function(nsHandlers,namespace){return nsHandlers[name]&&(ns===defaultNs||ns===namespace||"*"===namespace)}).reduce(function(acc,nsHandlers){return acc.before=acc.before.concat(nsHandlers[name].before),acc.between=acc.between.concat(nsHandlers[name].between),acc.after=acc.after.concat(nsHandlers[name].after),acc},{before:[],between:[],after:[]});logger.trace({event:eventName,args:args},"trigger %s",eventName),mergedHandlers&&function(allHandlers,name,ns){var event={name:name,namespace:ns}
;allHandlers.before.length?function(handlers,event){var pHandlers,beforeArgs=args.slice();return beforeArgs.unshift(event),pHandlers=handlers.map(function(handler){var value=!shouldStop(event.name)&&handler.apply(self,beforeArgs);return!1===value?Promise.reject():value}),Promise.all(pHandlers)}(allHandlers.before,event).then(function(){triggerBetween(allHandlers,event)}).catch(function(err){logHandlerStop("before",event,err)}):triggerBetween(allHandlers,event)}(mergedHandlers,name,ns)}),this},before:function(eventNames,handler){return _.isFunction(handler)&&_.forEach(getEventNames(eventNames),function(eventName){getHandlers(eventName,"before").push(handler)}
),this},after:function(eventNames,handler){return _.isFunction(handler)&&_.forEach(getEventNames(eventNames),function(eventName){getHandlers(eventName,"after").push(handler)}),this},stopEvent:function(name){_.isString(name)&&!_.isEmpty(name.trim())&&(stoppedEvents[name.trim()]=!0)},spread:function(destination,eventNames){var self=this;return destination&&_.isFunction(destination.trigger)&&(_.isString(eventNames)&&(eventNames=getEventNames(eventNames)),_.forEach(eventNames,function(eventName){self.on(eventName,function(){var args=[eventName].concat([].slice.call(arguments));destination.trigger.apply(destination,args)})})),this}};return targetName=(
target=target||{}).name||target.id||target.serial||uuid(6),logger=eventifierLogger.child({target:targetName}),_(eventApi).functions().forEach(function(method){_.isFunction(target[method])&&eventifierLogger.warn("The target object has already a method named "+method,target),target[method]=function(){var args=[].slice.call(arguments);return eventApi[method].apply(target,args)}}),target}}),define("ui/selecter",["jquery","select2"],function($,select2){"use strict";return $=$&&$.hasOwnProperty("default")?$.default:$,function($container){$("select.select2",$container).each(function(){var $elt=$(this),hasSearch=!(!1===$elt.data("has-search")),hasPlaceholder=!(
!$elt.attr("placeholder")&&!$elt.data("placeholder")),widthMethod=$elt.data("width")||"resolve",hasSelectedIndex=function(options){for(var i=options.length,selected=!1;i--;)if("string"==typeof options[i].getAttribute("selected")){selected=!0;break}return selected}(this.options),settings={width:widthMethod};hasPlaceholder&&this.options[0]&&this.options[0].text&&($elt.prepend("<option>"),hasSelectedIndex||(this.selectedIndex=this.options[0])),hasSearch||(settings.minimumResultsForSearch=-1),$elt.select2(settings)})}}),define("ui/filter",["jquery","lodash","i18n","core/eventifier","handlebars","lib/dompurify/purify","ui/selecter"],function($$1,_,__,eventifier,
Handlebars,DOMPurify,selecter){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",
void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,
options){if(_.contains(haystack,needle))return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier.default:eventifier,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,
">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+="<div>\n    ",!(stack1=helpers.if.call(depth0,depth0&&depth0.label,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){var stack1,helper,buffer="";return buffer+='\n    <label class="form_desc">',stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"</label>\n    "},data),data:data}))&&0!==stack1||(buffer+=stack1),
buffer+='\n    <div class="item-filter"></div>\n</div>'});var defaults={placeholder:__("Filter by value"),width:300,minimumResultsForSearch:10,minimumInputLength:3,enable:!0,quietMillis:2e3,label:!1};return function($container,options){var selected={uri:"",code:"",name:""};return options=_.defaults(options||{},defaults),eventifier({render:function(format){var self=this,$component=$$1(function(data,options){var html=Template(data,options);return html}(options)),$list=$$1(".item-filter",$component);return $list.select2({placeholder:options.placeholder,allowClear:!0,width:options.width,minimumResultsForSearch:options.minimumResultsForSearch,
minimumInputLength:options.minimumInputLength,maximumInputLength:200,formatResult:_.isFunction(options.formatter)?options.formatter:function(data){return _.template(format)(data)},ajax:{quietMillis:options.quietMillis,data:function(term,page){return{q:term,page:page}},transport:function(params){self.trigger("request",params)},results:function(data,page){var more=25*page<data.total;return{results:data.items,more:more}},cache:!0}}),$list.select2("enable",options.enable),$list.on("change.select2",function(){selected=$list.select2("data"),self.trigger("change",selected&&selected.uri?selected.uri:"")}),$container.append($component),this},enable:function(){$$1(
".item-filter",$container).select2("enable",!0)},disable:function(){$$1(".item-filter",$container).select2("enable",!1)},getSelected:function(){return selected},reset:function(){$$1(".item-filter",$container).select2("val","")},destroy:function(){var $list=$$1(".item-filter",$container);return $list.select2("destroy"),$list.remove(),this.trigger("destroy"),this}})}}),define("css!ui/component/css/components",[],function(){}),define("ui/component",["jquery","lodash","core/eventifier","handlebars","i18n","lib/dompurify/purify","css!ui/component/css/components.css"],function($$1,_,eventifier,Handlebars,__,DOMPurify,components_css){"use strict";function Helpers0(
hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),
fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle)
)return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier.default:eventifier,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,__=__&&__.hasOwnProperty("default")?__.default:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,
Handlebars.helpers),'<div class="component"></div>'});function defaultTpl(data,options,asString){var html=Template(data,options);return html}var _slice=[].slice;function delegatedResize(){var width=this.config.width,height=this.config.height,$container=this.getContainer(),$element=this.getElement();$container&&("auto"===width&&(width=$container.width()),"auto"===height&&(height=$container.height())),$element&&(_.isNumber(width)&&$element.css({width:width+"px"}),_.isNumber(height)&&$element.css({height:height+"px"})),this._width=width,this._height=height}return function(specs,defaults){var $container,componentTpl=defaultTpl,componentState={},componentApi={
init:function(config){return this.config=_(config||{}).omit(function(value){return null==value}).defaults(defaults||{}).value(),componentState={},this.trigger("init"),this.config.renderTo&&($container=$$1(this.config.renderTo),this.render()),this},destroy:function(){return this.trigger("destroy"),this.$component&&this.$component.remove(),this.$component=null,componentState={},this},render:function(container){return container&&($container=$$1(container)),this.$component=$$1(componentTpl(this.config)),$container&&(this.config.replace&&$container.empty(),$container.append(this.$component)),this.setState("rendered",!0),delegatedResize.call(this),this.trigger(
"render",this.$component),this},setSize:function(width,height){return this.config.width=width,this.config.height=height,this.is("rendered")&&delegatedResize.call(this),this.trigger("setsize",width,height),this},getSize:function(){if(this.is("rendered"))return{width:this._width||0,height:this._height||0}},getOuterSize:function(includeMargin){var $component;if(this.is("rendered"))return $component=this.getElement(),includeMargin=includeMargin||!1,{width:Math.round($component.outerWidth(includeMargin)),height:Math.round($component.outerHeight(includeMargin))}},show:function(){return this.trigger("show",this),this.setState("hidden",!1)},hide:function(){
return this.trigger("hide",this),this.setState("hidden",!0)},enable:function(){return this.trigger("enable",this),this.setState("disabled",!1)},disable:function(){return this.trigger("disable",this),this.setState("disabled",!0)},is:function(state){return!!componentState[state]},setState:function(state,flag){return flag=!!flag,componentState[state]=flag,this.$component&&this.$component.toggleClass(state,flag),this.trigger("state",state,flag,this),this},getContainer:function(){return $container},getElement:function(){return this.$component},getTemplate:function(){return componentTpl},setTemplate:function(template){var tpl=template||defaultTpl
;return componentTpl=tpl,_.isFunction(componentTpl)||(componentTpl=function(){return tpl}),this.trigger("template",componentTpl),this},getConfig:function(){return this.config||defaults||{}}};return specs&&_(specs).functions().forEach(function(method){componentApi[method]=function(){return specs[method].apply(componentApi,_slice.call(arguments))}}),eventifier(componentApi)}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("util/regexEscape",factory):(global=global||self)["util/regexEscape"]=factory()}(this,function(){"use strict";return function(s){
return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("util/regexEscape")):"function"==typeof define&&define.amd?define("util/wrapLongWords",["util/regexEscape"],factory):(global=global||self)["util/wrapLongWords"]=factory(global["util/regexEscape"])}(this,function(regexEscape){"use strict";regexEscape=regexEscape&&regexEscape.hasOwnProperty("default")?regexEscape.default:regexEscape;var getCutTerm=function(longWord,chunkExp){for(var cutTerms=longWord.match(chunkExp),i=cutTerms.length,oldFirst="",newFirst="",offenders=[".",":",";"];i--;
)newFirst=cutTerms[i].charAt(0),-1<offenders.indexOf(newFirst)&&(cutTerms[i]=cutTerms[i].substr(1)),-1<offenders.indexOf(oldFirst)&&(cutTerms[i]=cutTerms[i]+oldFirst),oldFirst=newFirst;return cutTerms.join(" ")};return function(str,threshold){str=str.toString().replace(/([\w])</g,"$1 <");for(var cut,chunkExp=new RegExp(".{1,"+threshold+"}","g"),longWords=str.match(new RegExp("[\\S]{"+threshold+",}","g"))||[],i=longWords.length;i--;)cut=getCutTerm(longWords[i],chunkExp),str=str.replace(new RegExp(regexEscape(longWords[i]),"g"),cut);return str}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(
):"function"==typeof define&&define.amd?define("util/encode",factory):(global=global||self)["util/encode"]=factory()}(this,function(){"use strict";var _reQuot=/"/g,_reApos=/'/g,encodeHTML=function(html){return document.createElement("a").appendChild(document.createTextNode(html)).parentNode.innerHTML};return{html:encodeHTML,attribute:function(html){return encodeHTML(html).replace(_reQuot,"&quot;").replace(_reApos,"&apos;")},encodeBase64:function(str){return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,function(match,p1){return String.fromCharCode("0x"+p1)}))},decodeBase64:function(str){return decodeURIComponent(Array.prototype.map.call(atob(str),
function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join(""))}}}),define("ui/feedback",["jquery","lodash","core/format","ui/component","util/wrapLongWords","util/encode","handlebars","i18n","lib/dompurify/purify"],function($$1,_,format,component,wrapLongWords,encode,Handlebars,__,DOMPurify){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,
fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment
)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,format=format&&format.hasOwnProperty("default")?format.default:format,component=component&&component.hasOwnProperty("default")?component.default:component,
wrapLongWords=wrapLongWords&&wrapLongWords.hasOwnProperty("default")?wrapLongWords.default:wrapLongWords,encode=encode&&encode.hasOwnProperty("default")?encode.default:encode,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,__=__&&__.hasOwnProperty("default")?__.default:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,
helper,options,buffer="",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return buffer+='<div id="',buffer+=escapeExpression(stack1=(helper=helpers.id)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.id)?helper.call(depth0,{hash:{},data:data}):helper)+'" class="feedback feedback-',buffer+=escapeExpression(stack1=(helper=helpers.level)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.level)?helper.call(depth0,{hash:{},data:data}):helper)+" ",!(stack1=helpers.if.call(depth0,depth0&&depth0.popup,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){
return"popup"},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='">\n    <span class="icon-',buffer+=escapeExpression(stack1=(helper=helpers.level)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.level)?helper.call(depth0,{hash:{},data:data}):helper)+'"></span>\n    <div>\n        ',options={hash:{},data:data},!(stack1=(helper=helpers.dompurify||depth0&&depth0.dompurify)?helper.call(depth0,depth0&&depth0.msg,options):helperMissing.call(depth0,"dompurify",depth0&&depth0.msg,options))&&0!==stack1||(buffer+=stack1),buffer+='\n    </div>\n    <span title="'+escapeExpression((options={hash:{},data:data},(
helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Close message",options):helperMissing.call(depth0,"__","Close message",options)))+'" class="icon-close" data-close=":parent .feedback"></span>\n</div>\n'});function tpl(data,options,asString){var html=Template(data,options);return html}var currents=[],levels=["info","success","warning","danger","error"],defaultOptions={timeout:{info:2e3,success:2e3,warning:4e3,danger:4e3,error:8e3},wrapLongWordsAfter:40,encodeHtml:!0,popup:!0};return function($container,config){if($container&&$container.length||($container=$$1("#feedback-box")),!$container.length)throw new TypeError(
"The feedback needs to belong to an existing container");return component({message:function(level,msg,params,options){var displayedMessage=msg;return level&&_.contains(levels,level)||(level="info"),_.isPlainObject(params)&&(options=params,params=[]),this.config=_.defaults(options||{},this.config),this.config.level=level,this.config.encodeHtml&&(displayedMessage=encode.html(displayedMessage)),this.config.wrapLongWordsAfter&&(displayedMessage=wrapLongWords(displayedMessage,this.config.wrapLongWordsAfter)),_.isArray(params)&&params.length&&(displayedMessage=format.apply(format,[displayedMessage].concat(params))),this.config.msg=displayedMessage,this},
info:function(msg,params,options){return this.message("info",msg,params,options).open()},success:function(msg,params,options){return this.message("success",msg,params,options).open()},warning:function(msg,params,options){return this.message("warning",msg,params,options).open()},danger:function(msg,params,options){return this.message("danger",msg,params,options).open()},error:function(msg,params,options){return this.message("error",msg,params,options).open()},open:function(){return _(currents).reject(this).invoke("close"),this.display()},close:function(){this.is("rendered")&&this.destroy()},display:function(){return this.is("rendered")?this.show(
):this.render($container),this}},defaultOptions).setTemplate(tpl).on("init",function(){this.config.id="feedback-"+(currents.length+1),currents.push(this),$container.trigger("create.feedback")}).on("render",function(){var self=this,$component=this.getElement(),$closer=$$1(".icon-close",$component),timeout=_.isPlainObject(this.config.timeout)?this.config.timeout[this.config.level]:this.config.timeout;$closer.off("click").on("click",function(e){e.preventDefault(),self.destroy()}),_.isNumber(timeout)&&0<timeout&&_.delay(function(){self.close()},timeout),$container.trigger("display.feedback")}).on("destroy",function(){$container.trigger("close.feedback"),
_.remove(currents,this)}).init(config)}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("context")):"function"==typeof define&&define.amd?define("util/url",["lodash","context"],factory):(global=global||self)["util/url"]=factory(global._,global.context)}(this,function(_,context){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,context=context&&context.hasOwnProperty("default")?context.default:context;var parsers={absolute:/^(?:[a-z]+:)?\/\//i,base64:/^data:[^\/]+\/[^;]+(;charset=[\w]+)?;base64,/,query:/(?:^|&)([^&=]*)=?([^&]*)/g,
url:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/};return{parse:function(url){var matches,keys=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","queryString","hash"],i=keys.length,parsed=Object.create({toString:function(){return this.source}});if(parsed.base64=parsers.base64.test(url),parsed.base64)parsed.source=url;else{for(matches=parsers.url.exec(url);i--;)parsed[keys[i]]=matches[i]||"";parsed.query={},parsed.queryString.replace(parsers.query,function($0,$1,$2){$1&&(parsed.query[$1]=$2)})}return parsed
},isAbsolute:function(url){return"object"==typeof url&&url.hasOwnProperty("source")?url.source!==url.relative:"string"==typeof url?parsers.absolute.test(url):void 0},isRelative:function(url){var absolute=this.isAbsolute(url);if("boolean"==typeof absolute)return!absolute},isBase64:function(url){return"object"==typeof url&&url.hasOwnProperty("source")?url.base64:"string"==typeof url?parsers.base64.test(url):void 0},encodeAsXmlAttr:function(uri){return/[<>&']+/.test(uri)?encodeURIComponent(uri):uri},build:function(path,params){var url,hasQueryString,queryString="";return path&&(_.isString(path)&&(url=path),_.isArray(path)&&(url="",_.forEach(path,function(chunk
){/\/$/.test(url)&&/^\//.test(chunk)?url+=chunk.substr(1):""===url||/\/$/.test(url)||/^\//.test(chunk)?url+=chunk:url+="/"+chunk})),_.isPlainObject(params)&&(hasQueryString=-1<url.indexOf("?"),queryString=_.reduce(params,function(acc,value,key){return _.isEmpty(acc)&&!hasQueryString||(acc+="&"),"object"!=typeof value||_.isArray(value)?acc+=encodeURIComponent(key)+"="+encodeURIComponent(value):_.forOwn(value,function(parameterValue,parameterName){acc+=encodeURIComponent(key)+"["+encodeURIComponent(parameterName)+"]="+encodeURIComponent(parameterValue)+"&"}),acc},queryString),_.isEmpty(queryString)||(hasQueryString||(url+="?"),url+=queryString))),url},
route:function(action,controller,extension,params,rootUrl){var routeParts=[extension,controller,action];if(_.some(routeParts,function(value){return _.isEmpty(value)||!_.isString(value)}))throw new TypeError("All parts are required to build an URL");return rootUrl=rootUrl||context&&context.root_url,this.build([rootUrl].concat(routeParts),params)}}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("core/eventifier"),require("lib/uuid")):"function"==typeof define&&define.amd?define("core/promiseQueue",["lodash","core/promise","core/eventifier","lib/uuid"],
factory):(global=global||self)["core/promiseQueue"]=factory(global._,global["core/promise"],global["core/eventifier"],global["lib/uuid"])}(this,function(_,Promise,eventifier,uuid){"use strict";return _=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier.default:eventifier,uuid=uuid&&uuid.hasOwnProperty("default")?uuid.default:uuid,function(){function getId(){var id="promise-"+uuid(6);return void 0===queue[id]?id:getId()}var queue={};return{add:function(promise){return queue[getId()]=promise,this},getValues:function(){
return _.values(queue)},clear:function(){return queue={},this},serie:function(promiseFn){var id=getId(),currentQueue=this.getValues(),emitter=eventifier();return queue[id]=new Promise(function(resolve){emitter.on("fulfilled",resolve)}),Promise.all(currentQueue).then(function(){if(_.isFunction(promiseFn))return promiseFn()}).then(function(data){return emitter.trigger("fulfilled"),delete queue[id],data}).catch(function(err){throw queue={},err})}}}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("core/promiseQueue"),require("lib/uuid")
):"function"==typeof define&&define.amd?define("core/store/localstorage",["lodash","core/promise","core/promiseQueue","lib/uuid"],factory):(global=global||self)["core/store/localstorage"]=factory(global._,global["core/promise"],global["core/promiseQueue"],global["lib/uuid"])}(this,function(_,Promise,promiseQueue,uuid){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,promiseQueue=promiseQueue&&promiseQueue.hasOwnProperty("default")?promiseQueue.default:promiseQueue,uuid=uuid&&uuid.hasOwnProperty("default")?uuid.default:uuid;var storage=window.localStorage,
writingQueue=promiseQueue(),setEntry=function(storeName,key,value){return new Promise(function(resolve,reject){try{storage.setItem("tao-store-"+storeName+"."+key,JSON.stringify(value)),resolve(!0)}catch(ex){reject(ex)}})},getEntry=function(storeName,key){return new Promise(function(resolve,reject){var value;try{null===(value=storage.getItem("tao-store-"+storeName+"."+key))?resolve():resolve(JSON.parse(value))}catch(ex){reject(ex)}})},getKnownStores=function(){return getEntry("index","stores")},localStorageBackend=function(storeName){var name,registered=!1,openStore=function(){return registered?Promise.resolve():function(storeName){return getKnownStores(
).then(function(stores){return(stores=stores||{})[storeName]={name:storeName,lastOpen:Date.now()},setEntry("index","stores",stores)})}(storeName).then(function(){registered=!0})};if(_.isEmpty(storeName)||!_.isString(storeName))throw new TypeError("The store name is required");return name="tao-store-"+storeName+".",{getItem:function(key){return writingQueue.serie(function(){return openStore().then(function(){return getEntry(storeName,key)})})},setItem:function(key,value){return writingQueue.serie(function(){return openStore().then(function(){return setEntry(storeName,key,value)})})},removeItem:function(key){return writingQueue.serie(function(){
return openStore().then(function(){return storage.removeItem(name+key),!0})})},getItems:function(){var keyPattern=new RegExp("^"+name);return writingQueue.serie(function(){return openStore().then(function(){return _(storage).map(function(entry,index){return storage.key(index)}).filter(function(key){return keyPattern.test(key)}).reduce(function(acc,key){var value,exposedKey=key.replace(name,"");try{null!==(value=storage.getItem(key))&&(acc[exposedKey]=JSON.parse(value))}catch(ex){acc[exposedKey]=null}return acc},{})})})},clear:function(){var keyPattern=new RegExp("^"+name);return writingQueue.serie(function(){return openStore().then(function(){return _(
storage).map(function(entry,index){return storage.key(index)}).filter(function(key){return keyPattern.test(key)}).forEach(function(key){storage.removeItem(key)}),!0})})},removeStore:function(){return this.clear().then(function(){return function(storeName){return getKnownStores().then(function(stores){return delete(stores=stores||{})[storeName],setEntry("index","stores",stores)})}(storeName)})}}};return localStorageBackend.removeAll=function(validate){return _.isFunction(validate)||(validate=null),getKnownStores().then(function(stores){var removing=_(stores).filter(function(store,storeName){return!validate||validate(storeName,store)}).map(function(store){
return store&&store.name?localStorageBackend(store.name).removeStore():Promise.resolve()}).value();return Promise.all(removing)})},localStorageBackend.getAll=function(validate){return getKnownStores().then(function(stores){return _(stores).filter(function(store,storeName){return!validate||validate(storeName,store)}).map(function(store){return store.name}).value()})},localStorageBackend.getStoreIdentifier=function(){var idStore=localStorageBackend("id");return idStore.getItem("id").then(function(id){return _.isEmpty(id)?(id=uuid(),idStore.setItem("id",id).then(function(){return id})):id})},localStorageBackend}),function(global,factory){
"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("lib/uuid")):"function"==typeof define&&define.amd?define("core/store/indexeddb",["lodash","core/promise","lib/uuid"],factory):(global=global||self)["core/store/indexeddb"]=factory(global._,global["core/promise"],global["lib/uuid"])}(this,function(_,Promise,uuid){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,uuid=uuid&&uuid.hasOwnProperty("default")?uuid.default:uuid
;var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var module,knownStores,idbstore=(function(module){var definition,global;definition=function(){function defaultErrorHandler(error){throw error}function defaultSuccessHandler(){}function IDBStore(kwArgs,onStoreReady){for(var key in void 0===onStoreReady&&"function"==typeof kwArgs&&(onStoreReady=kwArgs),"[object Object]"!=Object.prototype.toString.call(kwArgs)&&(kwArgs={}),defaults)this[key]=void 0!==kwArgs[key]?kwArgs[key]:defaults[key];this.dbName=this.storePrefix+this.storeName,
this.dbVersion=parseInt(this.dbVersion,10)||1,onStoreReady&&(this.onStoreReady=onStoreReady);var env="object"==typeof window?window:self,availableImplementations=this.implementationPreference.filter(function(implName){return implName in env});this.implementation=availableImplementations[0],this.idb=env[this.implementation],this.keyRange=env.IDBKeyRange||env.webkitIDBKeyRange||env.mozIDBKeyRange,this.consts={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange",NEXT:"next",NEXT_NO_DUPLICATE:"nextunique",PREV:"prev",PREV_NO_DUPLICATE:"prevunique"},this.openDB()}var defaults={storeName:"Store",storePrefix:"IDBWrapper-",dbVersion:1,
keyPath:"id",autoIncrement:!0,onStoreReady:function(){},onError:defaultErrorHandler,indexes:[],implementationPreference:["indexedDB","webkitIndexedDB","mozIndexedDB","shimIndexedDB"]},proto={constructor:IDBStore,version:"1.7.0",db:null,dbName:null,dbVersion:null,store:null,storeName:null,storePrefix:null,keyPath:null,autoIncrement:null,indexes:null,implementationPreference:null,implementation:"",onStoreReady:null,onError:null,_insertIdCount:0,openDB:function(){var openRequest=this.idb.open(this.dbName,this.dbVersion),preventSuccessCallback=!1;openRequest.onerror=function(error){var gotVersionErr=!1
;"error"in error.target?gotVersionErr="VersionError"==error.target.error.name:"errorCode"in error.target&&(gotVersionErr=12==error.target.errorCode),gotVersionErr?this.onError(new Error("The version number provided is lower than the existing one.")):this.onError(error)}.bind(this),openRequest.onsuccess=function(event){if(!preventSuccessCallback)if(this.db)this.onStoreReady();else if(this.db=event.target.result,"string"!=typeof this.db.version)if(this.db.objectStoreNames.contains(this.storeName)){var emptyTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY);this.store=emptyTransaction.objectStore(this.storeName)
;var existingIndexes=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(indexData){var indexName=indexData.name;if(!indexName)return preventSuccessCallback=!0,void this.onError(new Error("Cannot create index: No index name given."));if(this.normalizeIndexData(indexData),this.hasIndex(indexName)){var actualIndex=this.store.index(indexName);this.indexComplies(actualIndex,indexData)||(preventSuccessCallback=!0,this.onError(new Error('Cannot modify index "'+indexName+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),existingIndexes.splice(existingIndexes.indexOf(indexName),1)
}else preventSuccessCallback=!0,this.onError(new Error('Cannot create new index "'+indexName+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))},this),existingIndexes.length&&(preventSuccessCallback=!0,this.onError(new Error('Cannot delete index(es) "'+existingIndexes.toString()+'" for current version. Please bump version number to '+(this.dbVersion+1)+"."))),preventSuccessCallback||this.onStoreReady()}else this.onError(new Error("Object store couldn't be created."));else this.onError(new Error("The IndexedDB implementation in this browser is outdated. Please upgrade your browser."))}.bind(this),
openRequest.onupgradeneeded=function(event){if(this.db=event.target.result,this.db.objectStoreNames.contains(this.storeName))this.store=event.target.transaction.objectStore(this.storeName);else{var optionalParameters={autoIncrement:this.autoIncrement};null!==this.keyPath&&(optionalParameters.keyPath=this.keyPath),this.store=this.db.createObjectStore(this.storeName,optionalParameters)}var existingIndexes=Array.prototype.slice.call(this.getIndexList());this.indexes.forEach(function(indexData){var indexName=indexData.name;if(indexName||(preventSuccessCallback=!0,this.onError(new Error("Cannot create index: No index name given."))),this.normalizeIndexData(
indexData),this.hasIndex(indexName)){var actualIndex=this.store.index(indexName);this.indexComplies(actualIndex,indexData)||(this.store.deleteIndex(indexName),this.store.createIndex(indexName,indexData.keyPath,{unique:indexData.unique,multiEntry:indexData.multiEntry})),existingIndexes.splice(existingIndexes.indexOf(indexName),1)}else this.store.createIndex(indexName,indexData.keyPath,{unique:indexData.unique,multiEntry:indexData.multiEntry})},this),existingIndexes.length&&existingIndexes.forEach(function(_indexName){this.store.deleteIndex(_indexName)},this)}.bind(this)},deleteDatabase:function(onSuccess,onError){if(this.idb.deleteDatabase){this.db.close()
;var deleteRequest=this.idb.deleteDatabase(this.dbName);deleteRequest.onsuccess=onSuccess,deleteRequest.onerror=onError}else onError(new Error("Browser does not support IndexedDB deleteDatabase!"))},put:function(key,value,onSuccess,onError){null!==this.keyPath&&(onError=onSuccess,onSuccess=value,value=key),onError=onError||defaultErrorHandler,onSuccess=onSuccess||defaultSuccessHandler;var putRequest,hasSuccess=!1,result=null,putTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);return putTransaction.oncomplete=function(){(hasSuccess?onSuccess:onError)(result)},putTransaction.onabort=onError,putTransaction.onerror=onError,(
putRequest=null!==this.keyPath?(this._addIdPropertyIfNeeded(value),putTransaction.objectStore(this.storeName).put(value)):putTransaction.objectStore(this.storeName).put(value,key)).onsuccess=function(event){hasSuccess=!0,result=event.target.result},putRequest.onerror=onError,putTransaction},get:function(key,onSuccess,onError){onError=onError||defaultErrorHandler,onSuccess=onSuccess||defaultSuccessHandler;var hasSuccess=!1,result=null,getTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY);getTransaction.oncomplete=function(){(hasSuccess?onSuccess:onError)(result)},getTransaction.onabort=onError,getTransaction.onerror=onError
;var getRequest=getTransaction.objectStore(this.storeName).get(key);return getRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},getRequest.onerror=onError,getTransaction},remove:function(key,onSuccess,onError){onError=onError||defaultErrorHandler,onSuccess=onSuccess||defaultSuccessHandler;var hasSuccess=!1,result=null,removeTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);removeTransaction.oncomplete=function(){(hasSuccess?onSuccess:onError)(result)},removeTransaction.onabort=onError,removeTransaction.onerror=onError;var deleteRequest=removeTransaction.objectStore(this.storeName).delete(key)
;return deleteRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},deleteRequest.onerror=onError,removeTransaction},batch:function(dataArray,onSuccess,onError){if(onError=onError||defaultErrorHandler,onSuccess=onSuccess||defaultSuccessHandler,"[object Array]"!=Object.prototype.toString.call(dataArray))onError(new Error("dataArray argument must be of type Array."));else if(0===dataArray.length)return onSuccess(!0);var count=dataArray.length,called=!1,hasSuccess=!1,batchTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);batchTransaction.oncomplete=function(){(hasSuccess?onSuccess:onError)(hasSuccess)},
batchTransaction.onabort=onError,batchTransaction.onerror=onError;function onItemSuccess(){0!==--count||called||(hasSuccess=called=!0)}return dataArray.forEach(function(operation){function onItemError(err){batchTransaction.abort(),called||(called=!0,onError(err,type,key))}var type=operation.type,key=operation.key,value=operation.value;if("remove"==type){var deleteRequest=batchTransaction.objectStore(this.storeName).delete(key);deleteRequest.onsuccess=onItemSuccess,deleteRequest.onerror=onItemError}else if("put"==type){var putRequest;(putRequest=null!==this.keyPath?(this._addIdPropertyIfNeeded(value),batchTransaction.objectStore(this.storeName).put(value)
):batchTransaction.objectStore(this.storeName).put(value,key)).onsuccess=onItemSuccess,putRequest.onerror=onItemError}},this),batchTransaction},putBatch:function(dataArray,onSuccess,onError){var batchData=dataArray.map(function(item){return{type:"put",value:item}});return this.batch(batchData,onSuccess,onError)},upsertBatch:function(dataArray,options,onSuccess,onError){"function"==typeof options&&(onError=onSuccess=options,options={}),onError=onError||defaultErrorHandler,onSuccess=onSuccess||defaultSuccessHandler,options=options||{},"[object Array]"!=Object.prototype.toString.call(dataArray)&&onError(new Error("dataArray argument must be of type Array."))
;var keyField=options.keyField||this.keyPath,count=dataArray.length,called=!1,hasSuccess=!1,index=0,batchTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);batchTransaction.oncomplete=function(){hasSuccess?onSuccess(dataArray):onError(!1)},batchTransaction.onabort=onError,batchTransaction.onerror=onError;function onItemSuccess(event){dataArray[index++][keyField]=event.target.result,0!==--count||called||(hasSuccess=called=!0)}return dataArray.forEach(function(record){var putRequest,key=record.key;(putRequest=null!==this.keyPath?(this._addIdPropertyIfNeeded(record),batchTransaction.objectStore(this.storeName).put(record)
):batchTransaction.objectStore(this.storeName).put(record,key)).onsuccess=onItemSuccess,putRequest.onerror=function(err){batchTransaction.abort(),called||(called=!0,onError(err))}},this),batchTransaction},removeBatch:function(keyArray,onSuccess,onError){var batchData=keyArray.map(function(key){return{type:"remove",key:key}});return this.batch(batchData,onSuccess,onError)},getBatch:function(keyArray,onSuccess,onError,arrayType){if(onError=onError||defaultErrorHandler,onSuccess=onSuccess||defaultSuccessHandler,arrayType=arrayType||"sparse","[object Array]"!=Object.prototype.toString.call(keyArray))onError(new Error("keyArray argument must be of type Array.")
);else if(0===keyArray.length)return onSuccess([]);var data=[],count=keyArray.length,hasSuccess=!1,result=null,batchTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY);batchTransaction.oncomplete=function(){(hasSuccess?onSuccess:onError)(result)},batchTransaction.onabort=onError,batchTransaction.onerror=onError;function onItemSuccess(event){event.target.result||"dense"==arrayType?data.push(event.target.result):"sparse"==arrayType&&data.length++,0===--count&&(hasSuccess=!0,result=data)}return keyArray.forEach(function(key){var getRequest=batchTransaction.objectStore(this.storeName).get(key);getRequest.onsuccess=onItemSuccess,
getRequest.onerror=function(err){onError(result=err),batchTransaction.abort()}},this),batchTransaction},getAll:function(onSuccess,onError){onError=onError||defaultErrorHandler,onSuccess=onSuccess||defaultSuccessHandler;var getAllTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY),store=getAllTransaction.objectStore(this.storeName);return store.getAll?this._getAllNative(getAllTransaction,store,onSuccess,onError):this._getAllCursor(getAllTransaction,store,onSuccess,onError),getAllTransaction},_getAllNative:function(getAllTransaction,store,onSuccess,onError){var hasSuccess=!1,result=null;getAllTransaction.oncomplete=function(){(
hasSuccess?onSuccess:onError)(result)},getAllTransaction.onabort=onError,getAllTransaction.onerror=onError;var getAllRequest=store.getAll();getAllRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},getAllRequest.onerror=onError},_getAllCursor:function(getAllTransaction,store,onSuccess,onError){var all=[],hasSuccess=!1,result=null;getAllTransaction.oncomplete=function(){(hasSuccess?onSuccess:onError)(result)},getAllTransaction.onabort=onError,getAllTransaction.onerror=onError;var cursorRequest=store.openCursor();cursorRequest.onsuccess=function(event){var cursor=event.target.result;cursor?(all.push(cursor.value),cursor.continue()):(
hasSuccess=!0,result=all)},cursorRequest.onError=onError},clear:function(onSuccess,onError){onError=onError||defaultErrorHandler,onSuccess=onSuccess||defaultSuccessHandler;var hasSuccess=!1,result=null,clearTransaction=this.db.transaction([this.storeName],this.consts.READ_WRITE);clearTransaction.oncomplete=function(){(hasSuccess?onSuccess:onError)(result)},clearTransaction.onabort=onError,clearTransaction.onerror=onError;var clearRequest=clearTransaction.objectStore(this.storeName).clear();return clearRequest.onsuccess=function(event){hasSuccess=!0,result=event.target.result},clearRequest.onerror=onError,clearTransaction},_addIdPropertyIfNeeded:function(
dataObj){void 0===dataObj[this.keyPath]&&(dataObj[this.keyPath]=this._insertIdCount+++Date.now())},getIndexList:function(){return this.store.indexNames},hasIndex:function(indexName){return this.store.indexNames.contains(indexName)},normalizeIndexData:function(indexData){indexData.keyPath=indexData.keyPath||indexData.name,indexData.unique=!!indexData.unique,indexData.multiEntry=!!indexData.multiEntry},indexComplies:function(actual,expected){return["keyPath","unique","multiEntry"].every(function(key){if("multiEntry"==key&&void 0===actual[key]&&!1===expected[key])return!0;if("keyPath"!=key||"[object Array]"!=Object.prototype.toString.call(expected[key])
)return expected[key]==actual[key];var exp=expected.keyPath,act=actual.keyPath;if("string"==typeof act)return exp.toString()==act;if("function"!=typeof act.contains&&"function"!=typeof act.indexOf)return!1;if(act.length!==exp.length)return!1;for(var i=0,m=exp.length;i<m;i++)if(!(act.contains&&act.contains(exp[i])||act.indexOf(-1!==exp[i])))return!1;return!0})},iterate:function(onItem,options){var directionType="desc"==(options=mixin({index:null,order:"ASC",autoContinue:!0,filterDuplicates:!1,keyRange:null,writeAccess:!1,onEnd:null,onError:defaultErrorHandler,limit:1/0,offset:0,allowItemRejection:!1},options||{})).order.toLowerCase()?"PREV":"NEXT"
;options.filterDuplicates&&(directionType+="_NO_DUPLICATE");var hasSuccess=!1,cursorTransaction=this.db.transaction([this.storeName],this.consts[options.writeAccess?"READ_WRITE":"READ_ONLY"]),cursorTarget=cursorTransaction.objectStore(this.storeName);options.index&&(cursorTarget=cursorTarget.index(options.index));var recordCount=0;cursorTransaction.oncomplete=function(){hasSuccess?options.onEnd?options.onEnd():onItem(null):options.onError(null)},cursorTransaction.onabort=options.onError,cursorTransaction.onerror=options.onError;var cursorRequest=cursorTarget.openCursor(options.keyRange,this.consts[directionType]);return cursorRequest.onerror=options.onError,
cursorRequest.onsuccess=function(event){var cursor=event.target.result;if(cursor)if(options.offset)cursor.advance(options.offset),options.offset=0;else{var onItemReturn=onItem(cursor.value,cursor,cursorTransaction);options.allowItemRejection&&!1===onItemReturn||recordCount++,options.autoContinue&&(recordCount+options.offset<options.limit?cursor.continue():hasSuccess=!0)}else hasSuccess=!0},cursorTransaction},query:function(onSuccess,options){var result=[],processedItems=0;return(options=options||{}).autoContinue=!0,options.writeAccess=!1,options.allowItemRejection=!!options.filter,options.onEnd=function(){onSuccess(result,processedItems)},this.iterate(
function(item){processedItems++;var accept=!options.filter||options.filter(item);return!1!==accept&&result.push(item),accept},options)},count:function(onSuccess,options){var onError=(options=mixin({index:null,keyRange:null},options||{})).onError||defaultErrorHandler,hasSuccess=!1,result=null,cursorTransaction=this.db.transaction([this.storeName],this.consts.READ_ONLY);cursorTransaction.oncomplete=function(){(hasSuccess?onSuccess:onError)(result)},cursorTransaction.onabort=onError,cursorTransaction.onerror=onError;var cursorTarget=cursorTransaction.objectStore(this.storeName);options.index&&(cursorTarget=cursorTarget.index(options.index))
;var countRequest=cursorTarget.count(options.keyRange);return countRequest.onsuccess=function(evt){hasSuccess=!0,result=evt.target.result},countRequest.onError=onError,cursorTransaction},makeKeyRange:function(options){var keyRange,hasLower=void 0!==options.lower,hasUpper=void 0!==options.upper;switch(!0){case void 0!==options.only:keyRange=this.keyRange.only(options.only);break;case hasLower&&hasUpper:keyRange=this.keyRange.bound(options.lower,options.upper,options.excludeLower,options.excludeUpper);break;case hasLower:keyRange=this.keyRange.lowerBound(options.lower,options.excludeLower);break;case hasUpper:keyRange=this.keyRange.upperBound(options.upper,
options.excludeUpper);break;default:throw new Error('Cannot create KeyRange. Provide one or both of "lower" or "upper" value, or an "only" value.')}return keyRange}},empty={};function mixin(target,source){var name,s;for(name in source)(s=source[name])!==empty[name]&&s!==target[name]&&(target[name]=s);return target}return IDBStore.prototype=proto,IDBStore.version=proto.version,IDBStore},global=commonjsGlobal,module.exports?module.exports=definition():global.IDBStore=definition()}(module={exports:{}},module.exports),module.exports),isIndexedDB2="undefined"!=typeof IDBObjectStore&&"getAll"in IDBObjectStore.prototype,openStore=function(storeName){
return new Promise(function(resolve,reject){var store=new idbstore({dbVersion:1,storeName:storeName,storePrefix:"tao-store-",keyPath:"key",autoIncrement:!0,onStoreReady:function(){store.db.onversionchange=function(e){e&&e.newVersion||store.db.close()},resolve(store)},onError:reject})})},setEntry=function(store,key,value){return new Promise(function(resolve,reject){var entry={key:key,value:value};store.put(entry,function(returnKey){resolve(returnKey===key)},reject)})},getEntry=function(store,key){return new Promise(function(resolve,reject){store.get(key,function(entry){if(!entry||void 0===entry.value)return resolve(entry);resolve(entry.value)},reject)})},
removeEntry=function(store,key){return new Promise(function(resolve,reject){store.remove(key,function(result){resolve(!1!==result)},reject)})},getKnownStores=function(){return knownStores=knownStores||openStore("index")},deleteStore=function(store,storeName){return new Promise(function(resolve,reject){var success=function(){(function(storeName){return getKnownStores().then(function(store){return removeEntry(store,storeName)})})(storeName).then(function(){resolve(!0)}).catch(reject)};isIndexedDB2?store.deleteDatabase(success,reject):store.clear(success,reject)})},indexDbBackend=function(storeName){var innerStore,writePromise,getStore=function(){
return innerStore=innerStore||openStore(storeName).then(function(store){return function(storeName){return getKnownStores().then(function(store){return setEntry(store,storeName,{name:storeName,lastOpen:Date.now()})})}(storeName).then(function(){return Promise.resolve(store)})})},ensureSerie=function(getWritingPromise){return writePromise?new Promise(function(resolve,reject){function runWrite(){var p=getWritingPromise();(writePromise=p).then(resolve).catch(reject)}writePromise.then(runWrite).catch(runWrite)}):writePromise=getWritingPromise()};if(_.isEmpty(storeName)||!_.isString(storeName))throw new TypeError("The store name is required");return{
getItem:function(key){return ensureSerie(function(){return getStore().then(function(store){return getEntry(store,key)})})},setItem:function(key,value){return ensureSerie(function(){return getStore().then(function(store){return setEntry(store,key,value)})})},removeItem:function(key){return ensureSerie(function(){return getStore().then(function(store){return removeEntry(store,key)})})},getItems:function(){return ensureSerie(function(){return getStore().then(function(store){return function(store){return new Promise(function(resolve,reject){store.getAll(function(entries){if(!_.isArray(entries))return resolve({});resolve(_.reduce(entries,function(acc,entry){
return entry.key&&entry.value&&(acc[entry.key]=entry.value),acc},{}))},reject)})}(store)})})},clear:function(){return ensureSerie(function(){return getStore().then(function(store){return new Promise(function(resolve,reject){store.clear(function(){resolve(!0)},reject)})})})},removeStore:function(){return ensureSerie(function(){return getStore().then(function(store){return deleteStore(store,storeName)})})}}};return indexDbBackend.removeAll=function(validate){return _.isFunction(validate)||(validate=null),getKnownStores().then(function(store){return new Promise(function(resolve,reject){store.getAll(function(entries){var all=[];_.forEach(entries,function(entry){
var storeName=entry&&entry.key;storeName&&all.push(openStore(storeName).then(function(storeToRemove){if(!validate||validate(storeName,entry.value))return deleteStore(storeToRemove,storeName)}))}),Promise.all(all).then(resolve).catch(reject)},reject)})})},indexDbBackend.getAll=function(validate){return _.isFunction(validate)||(validate=function(){return!0}),getKnownStores().then(function(store){return new Promise(function(resolve,reject){store.getAll(function(entries){var storeNames=_(entries).filter(function(entry){return entry&&entry.key&&validate(entry.key,entry.value)}).map(function(entry){return entry.key}).value();return resolve(storeNames)},reject)})})
},indexDbBackend.getStoreIdentifier=function(){return openStore("id").then(function(store){return getEntry(store,"id").then(function(id){return _.isEmpty(id)?(id=uuid(),setEntry(store,"id",id).then(function(){return id})):id})})},indexDbBackend}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("lib/uuid")):"function"==typeof define&&define.amd?define("core/store/memory",["lodash","core/promise","lib/uuid"],factory):(global=global||self)["core/store/memory"]=factory(global._,global["core/promise"],global["lib/uuid"])}(this,function(_,Promise,uuid){
"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,uuid=uuid&&uuid.hasOwnProperty("default")?uuid.default:uuid;var idStore,memoryStore={},memoryStorageBackend=function(storeName){if(_.isEmpty(storeName)||!_.isString(storeName))throw new TypeError("The store name is required");return memoryStore[storeName]=memoryStore[storeName]||{},{getItem:function(key){return _.isPlainObject(memoryStore[storeName])?Promise.resolve(memoryStore[storeName][key]):Promise.resolve()},setItem:function(key,value){return _.isPlainObject(memoryStore[storeName])||(memoryStore[storeName]={}),
memoryStore[storeName][key]=value,Promise.resolve(!0)},removeItem:function(key){return memoryStore[storeName]=_.omit(memoryStore[storeName],key),Promise.resolve(void 0===memoryStore[storeName][key])},getItems:function(){return Promise.resolve(memoryStore[storeName])},clear:function(){return memoryStore[storeName]={},Promise.resolve(!0)},removeStore:function(){return memoryStore=_.omit(memoryStore,storeName),Promise.resolve(void 0===memoryStore[storeName])}}};return memoryStorageBackend.removeAll=function(validate){return _.isFunction(validate)||(validate=null),memoryStore=_.omit(memoryStore,function(store,storeName){return!validate||validate(storeName)}),
Promise.resolve(!0)},memoryStorageBackend.getAll=function(validate){var storeNames;return _.isFunction(validate)||(validate=null),storeNames=_(memoryStore).map(function(store,storeName){return storeName}).filter(function(storeName){return!validate||validate(storeName)}).value(),Promise.resolve(storeNames)},memoryStorageBackend.getStoreIdentifier=function(){return _.isEmpty(idStore)&&(idStore=uuid()),Promise.resolve(idStore)},memoryStorageBackend}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("moment"),require("module"),require("core/logger"),require("core/promise"),require(
"core/store/localstorage"),require("core/store/indexeddb"),require("core/store/memory")):"function"==typeof define&&define.amd?define("core/store",["lodash","moment","module","core/logger","core/promise","core/store/localstorage","core/store/indexeddb","core/store/memory"],factory):(global=global||self)["core/store"]=factory(global._,global.moment,global.module,global["core/logger"],global["core/promise"],global["core/store/localstorage"],global["core/store/indexeddb"],global["core/store/memory"])}(this,function(_,moment,module,loggerFactory,Promise,localStorageBackend,indexedDBBackend,memoryBackend){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,
moment=moment&&moment.hasOwnProperty("default")?moment.default:moment,module=module&&module.hasOwnProperty("default")?module.default:module,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory.default:loggerFactory,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,localStorageBackend=localStorageBackend&&localStorageBackend.hasOwnProperty("default")?localStorageBackend.default:localStorageBackend,indexedDBBackend=indexedDBBackend&&indexedDBBackend.hasOwnProperty("default")?indexedDBBackend.default:indexedDBBackend,memoryBackend=memoryBackend&&memoryBackend.hasOwnProperty("default"
)?memoryBackend.default:memoryBackend;var store,supportsIndexedDB=!1,dectectionDone=!1,quotaChecked=!1,backendApi=["removeAll","getAll","getStoreIdentifier"],storeApi=["getItem","setItem","removeItem","getItems","clear","removeStore"],logger=loggerFactory("core/store"),config=_.defaults(module.config()||{},{lowSpaceRatio:80,invalidation:{staled:"P2W",oldster:"P2M"}}),isIndexDBSupported=function(){return dectectionDone?Promise.resolve(supportsIndexedDB):new Promise(function(resolve){var test,indexedDB,done=function(result){return dectectionDone=!0,resolve(supportsIndexedDB=!!result)};try{if(!(
indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB))return done(!1);(test=indexedDB.open("__feature_test",1)).onsuccess=function(){if(test.result)return test.result.close(),done(!0)},test.onerror=function(e){return e.preventDefault(),done(!1),!1}}catch(err){done(!1)}})},loadBackend=function(preselectedBackend){return isIndexDBSupported().then(function(){var backend=preselectedBackend||(supportsIndexedDB?indexedDBBackend:localStorageBackend);return _.isFunction(backend)?function(backend){return _.all(backendApi,function(method){return _.isFunction(backend[method])})}(backend)?(
backend!==memoryBackend&&(!quotaChecked&&"storage"in window.navigator&&window.navigator.storage.estimate&&window.navigator.storage.estimate().then(function(estimate){var usedRatio=0;_.isNumber(estimate.usage)&&_.isNumber(estimate.quota)&&0<estimate.quota&&((usedRatio=estimate.usage/estimate.quota)>config.lowSpaceRatio?(logger.warn("The browser storage is getting low "+usedRatio.toFixed(2)+"% used",estimate),logger.warn("We will attempt to clean oldster databases in persistent backends"),store.cleanUpSpace(config.invalidation.oldster,[],localStorageBackend),store.cleanUpSpace(config.invalidation.oldster,[],indexedDBBackend)):logger.debug(
"Browser storage estimate : "+usedRatio.toFixed(2)+"% used",estimate))}).catch(function(err){logger.warn("Unable to retrieve quotas : "+err.message)}),quotaChecked=!0),backend):Promise.reject(new TypeError("This backend doesn't comply with the store backend API")):Promise.reject(new TypeError("No backend, no storage!"))})};return(store=function(storeName,preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){var storeInstance=backend(storeName);return function(storage){return _.all(storeApi,function(method){return _.isFunction(storage[method])})}(storeInstance)?storeInstance:Promise.reject(new TypeError(
"The store doesn't comply with the Storage interface"))})}).backends={localStorage:localStorageBackend,indexedDB:indexedDBBackend,memory:memoryBackend},store.removeAll=function(validate,preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){return backend.removeAll(validate)})},store.cleanUpSpace=function(since,storeNamePattern,preselectedBackend){var tsThreshold;return tsThreshold=_.isNumber(since)&&0<since?since:(_.isString(since)||(since=config.invalidation.oldster),moment().subtract(moment.duration(since)).valueOf()),logger.info("Trying to remove stores lastly opened before "+tsThreshold+"("+since+")"),store.removeAll(function(
storeName,storeEntry){return!(!storeName||!storeEntry)&&(!(storeNamePattern instanceof RegExp&&!storeNamePattern.test(storeName))&&(_.isNumber(storeEntry.lastOpen)&&_.isNumber(tsThreshold)&&storeEntry.lastOpen<=tsThreshold))},preselectedBackend)},store.getAll=function(validate,preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){return backend.getAll(validate)})},store.getIdentifier=function(preselectedBackend){return loadBackend(preselectedBackend).then(function(backend){return backend.getStoreIdentifier()})},store}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require(
"lodash"),require("core/promise"),require("core/store")):"function"==typeof define&&define.amd?define("core/tokenStore",["lodash","core/promise","core/store"],factory):(global=global||self)["core/tokenStore"]=factory(global._,global["core/promise"],global["core/store"])}(this,function(_,Promise,store){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,store=store&&store.hasOwnProperty("default")?store.default:store;var defaultConfig={maxSize:6,tokenTimeLimit:144e4};return function(options){var config=_.defaults(options||{},defaultConfig),getStore=function(){return store(
"tokenStore.tokens",store.backends.memory)};return{dequeue:function(){var self=this;return self.getIndex().then(function(latestIndex){var key=_.first(latestIndex);return key?getStore().then(function(storage){return storage.getItem(key)}).then(function(token){return self.remove(key).then(function(){return token})}):Promise.resolve()})},enqueue:function(token){var self=this;return _.isString(token)&&(token={value:token,receivedAt:Date.now()}),getStore().then(function(storage){return storage.setItem(token.value,token)}).then(function(updated){return!!updated&&self.enforceMaxSize().then(function(){return!0})})},getIndex:function(){return this.getTokens().then(
function(tokens){return _.chain(tokens).values().sort(function(t1,t2){return t1.receivedAt-t2.receivedAt}).map("value").value()})},has:function(key){return this.getIndex().then(function(latestIndex){return _.contains(latestIndex,key)})},remove:function(key){return this.has(key).then(function(result){return!!result&&getStore().then(function(storage){return storage.removeItem(key)})})},clear:function(){return getStore().then(function(storage){return storage.clear()})},getTokens:function(){return getStore().then(function(storage){return storage.getItems()})},getSize:function(){return this.getIndex().then(function(latestIndex){return latestIndex.length})},
setMaxSize:function(size){_.isNumber(size)&&0<size&&size!==config.maxSize&&(config.maxSize=size,this.enforceMaxSize())},enforceMaxSize:function(){var self=this;return this.getIndex().then(function(latestIndex){var keysToRemove,excess=latestIndex.length-config.maxSize;return!(0<excess)||(keysToRemove=latestIndex.slice(0,excess),Promise.all(_.map(keysToRemove,function(key){return self.remove(key)})))})},checkExpiry:function(token){return!(Date.now()-token.receivedAt>config.tokenTimeLimit)||this.remove(token.value)},expireOldTokens:function(){var self=this;return self.getTokens().then(function(tokens){return _.reduce(tokens,function(previousPromise,nextToken){
return previousPromise.then(function(){return self.checkExpiry(nextToken)})},Promise.resolve()).then(function(){return!0})})}}}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("module"),require("core/tokenStore"),require("core/promise"),require("core/promiseQueue")):"function"==typeof define&&define.amd?define("core/tokenHandler",["lodash","module","core/tokenStore","core/promise","core/promiseQueue"],factory):(global=global||self)["core/tokenHandler"]=factory(global._,global.module,global["core/tokenStore"],global["core/promise"],global["core/promiseQueue"])}(this,function(_,
module,tokenStoreFactory,Promise,promiseQueue){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,module=module&&module.hasOwnProperty("default")?module.default:module,tokenStoreFactory=tokenStoreFactory&&tokenStoreFactory.hasOwnProperty("default")?tokenStoreFactory.default:tokenStoreFactory,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,promiseQueue=promiseQueue&&promiseQueue.hasOwnProperty("default")?promiseQueue.default:promiseQueue;var clientConfigFetched=!1,defaults={maxSize:6,tokenTimeLimit:144e4};return function(options){var tokenStore;return _.isString(options)&&(options={initialToken:options}),options=_.defaults({}
,options,defaults),tokenStore=tokenStoreFactory(options),{getToken:function(){var self=this,initialToken=options.initialToken,getFirstTokenValue=function(){return tokenStore.dequeue().then(function(currentToken){return currentToken?currentToken.value:null})};return initialToken?(options.initialToken=null,Promise.resolve(initialToken)):tokenStore.expireOldTokens().then(function(){return tokenStore.getSize()}).then(function(queueSize){return 0<queueSize?getFirstTokenValue():clientConfigFetched?Promise.reject(new Error("No tokens available. Please refresh the page.")):self.getClientConfigTokens().then(getFirstTokenValue)})},setToken:function(newToken){
return tokenStore.enqueue(newToken)},getClientConfigTokens:function(){var self=this,clientTokens=_.map(module.config().tokens,function(serverToken){return{value:serverToken,receivedAt:Date.now()}});return clientConfigFetched=!0,Promise.resolve(clientTokens).then(function(newTokens){var setTokenQueue=promiseQueue();return _.forEach(newTokens,function(token){setTokenQueue.serie(function(){return self.setToken(token)})}),setTokenQueue.serie(function(){return!0})})},clearStore:function(){return tokenStore.clear()},getQueueLength:function(){return tokenStore.getSize()},setMaxSize:function(size){tokenStore.setMaxSize(size)}}}}),function(global,factory){
"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("jquery"),require("lodash"),require("i18n"),require("module"),require("context"),require("core/promise"),require("core/promiseQueue"),require("core/tokenHandler"),require("core/logger")):"function"==typeof define&&define.amd?define("core/request",["jquery","lodash","i18n","module","context","core/promise","core/promiseQueue","core/tokenHandler","core/logger"],factory):(global=global||self)["core/request"]=factory(global.$,global._,global.__,global.module,global.context,global["core/promise"],global["core/promiseQueue"],global["core/tokenHandler"],global["core/logger"])}(this,
function($,_,__,module,context,Promise,promiseQueue,tokenHandlerFactory,loggerFactory){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$,_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,module=module&&module.hasOwnProperty("default")?module.default:module,context=context&&context.hasOwnProperty("default")?context.default:context,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,promiseQueue=promiseQueue&&promiseQueue.hasOwnProperty("default")?promiseQueue.default:promiseQueue,tokenHandlerFactory=tokenHandlerFactory&&tokenHandlerFactory.hasOwnProperty("default"
)?tokenHandlerFactory.default:tokenHandlerFactory,loggerFactory=loggerFactory&&loggerFactory.hasOwnProperty("default")?loggerFactory.default:loggerFactory;var tokenHandler=tokenHandlerFactory(),queue=promiseQueue(),logger=loggerFactory("core/request"),createError=function(response,fallbackMessage,httpCode,httpSent){var err;return(err=response&&response.errorCode?new Error(response.errorCode+" : "+(response.errorMsg||response.errorMessage||response.error)):new Error(fallbackMessage)).response=response,err.sent=httpSent,httpCode&&(err.code=httpCode),err};return function(options){if(module.config().noToken&&(options.noToken=!0),_.isEmpty(options.url)
)throw new TypeError("At least give a URL...");function runRequest(){var headers,setTokenFromXhr=function(xhr){var token;return _.isFunction(xhr.getResponseHeader)&&(token=xhr.getResponseHeader("X-CSRF-Token"),logger.debug("received %s header %s","X-CSRF-Token",token),token)?tokenHandler.setToken(token):Promise.resolve()};return(headers=_.extend({},options.headers),options.noToken?Promise.resolve(headers):tokenHandler.getToken().then(function(token){return headers["X-CSRF-Token"]=token||"none",headers})).then(function(customHeaders){return new Promise(function(resolve,reject){$.ajax({url:options.url,method:options.method||"GET",headers:customHeaders,
data:options.data,contentType:options.contentType||void 0,dataType:options.dataType||"json",async:!0,timeout:1e3*options.timeout||1e3*context.timeout||0,beforeSend:function(){_.isEmpty(customHeaders)||logger.debug("sending %s header %s","X-CSRF-Token",customHeaders&&customHeaders["X-CSRF-Token"])},global:!options.background}).done(function(response,status,xhr){setTokenFromXhr(xhr).then(function(){return 204===xhr.status||response&&204===response.errorCode||"nocontent"===status?resolve():403===xhr.status||response&&403===response.errorCode?reject(createError(response,xhr.status+" : "+xhr.statusText,xhr.status,0<xhr.readyState)
):200===xhr.status||response&&!0===response.success?resolve(response):void reject(createError(response,__("The server has sent an empty response"),xhr.status,0<xhr.readyState))}).catch(function(error){logger.error(error),reject(createError(response,error,xhr.status,0<xhr.readyState))})}).fail(function(xhr,textStatus,errorThrown){var response;try{response=JSON.parse(xhr.responseText)}catch(parseErr){response=xhr.responseText}response=_.defaults(response,{success:!1,source:"network",cause:options.url,purpose:"proxy",context:this,code:xhr.status,sent:0<xhr.readyState,type:"error",message:errorThrown||__("An error occurred!")}),setTokenFromXhr(xhr).then(
function(){reject(createError(response,xhr.status+" : "+xhr.statusText,xhr.status,0<xhr.readyState))}).catch(function(error){logger.error(error),reject(createError(response,error,xhr.status,0<xhr.readyState))})})})})}return tokenHandler.getQueueLength().then(function(queueLength){return!0===options.noToken?runRequest():options.sequential||1===queueLength?queue.serie(runRequest):runRequest()})}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/request")):"function"==typeof define&&define.amd?define("core/dataProvider/request",["lodash","core/request"],factory):(
global=global||self)["core/dataProvider/request"]=factory(global._,global["core/request"])}(this,function(_,coreRequest){"use strict";return _=_&&_.hasOwnProperty("default")?_.default:_,coreRequest=coreRequest&&coreRequest.hasOwnProperty("default")?coreRequest.default:coreRequest,function(url,data,method,headers,background,noToken){return coreRequest({url:url,data:data,method:method,headers:headers,background:background,noToken:!1!==noToken}).then(function(response){return _.isUndefined(response)?Promise.resolve():response.success?Promise.resolve(response.data):Promise.reject(response)}).catch(function(error){return Promise.reject(error)})}}),function(global
,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash")):"function"==typeof define&&define.amd?define("util/namespace",["lodash"],factory):(global=global||self)["util/namespace"]=factory(global._)}(this,function(_){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_;var reSplit=/\s/g,namespaceHelper={split:function(names,normalize){return!_.isString(names)||_.isEmpty(names)?[]:(normalize&&(names=names.toLowerCase()),_(names.trim().split(reSplit)).compact().uniq().value())},getName:function(namespaced){return!_.isString(namespaced)||_.isEmpty(namespaced)?"":-1<namespaced.indexOf(".")?namespaced.substr(0,
namespaced.indexOf(".")):namespaced},getNamespace:function(namespaced,defaultNs){return!_.isString(namespaced)||_.isEmpty(namespaced)?"":-1<namespaced.indexOf(".")?namespaced.substr(namespaced.indexOf(".")+1):defaultNs||"@"},namespaceAll:function(names,namespace,normalize){var suffix;return _.isArray(names)||(names=namespaceHelper.split(names,normalize)),normalize&&(namespace=namespace.toLowerCase()),suffix=namespace?"."+namespace:"",_(names).map(function(sh){return sh.indexOf(".")<0?sh+suffix:sh}).compact().uniq().value().join(" ")}};return namespaceHelper}),function(global,factory){
"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("jquery"),require("lodash"),require("util/namespace")):"function"==typeof define&&define.amd?define("util/shortcut/registry",["jquery","lodash","util/namespace"],factory):(global=global||self)["util/shortcut/registry"]=factory(global.$,global._,global["util/namespace"])}(this,function($,_,namespaceHelper){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$,_=_&&_.hasOwnProperty("default")?_.default:_,namespaceHelper=namespaceHelper&&namespaceHelper.hasOwnProperty("default")?namespaceHelper.default:namespaceHelper;var modifiers={ctrl:"ctrlKey",alt:"altKey",
option:"altKey",shift:"shiftKey",meta:"metaKey",cmd:"metaKey",win:"metaKey"},translateKeys={escape:"esc",arrowdown:"down",arrowleft:"left",arrowright:"right",arrowup:"up"},specialKeys={8:"backspace",9:"tab",13:"enter",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",91:"meta",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",145:"scrolllock",144:"numlock"};function registerEvent(target,eventName,listener){target.addEventListener?target.addEventListener(eventName,listener,!1
):target.attachEvent?target.attachEvent("on"+eventName,listener):target["on"+eventName]=listener}function unregisterEvent(target,eventName,listener){target.removeEventListener?target.removeEventListener(eventName,listener,!1):target.detachEvent?target.detachEvent("on"+eventName,listener):target["on"+eventName]=null}function normalizeCommand(descriptor){var key=translateKeys[descriptor.key]||descriptor.key,parts=[];return descriptor.ctrlKey&&parts.push("control"),descriptor.altKey&&parts.push("alt"),descriptor.shiftKey&&parts.push("shift"),descriptor.metaKey&&parts.push("meta"),descriptor.scrollDown&&parts.push("scrollDown"),descriptor.scrollUp&&parts.push(
"scrollUp"),descriptor.clickLeft&&parts.push("clickLeft"),descriptor.clickRight&&parts.push("clickRight"),descriptor.clickMiddle&&parts.push("clickMiddle"),descriptor.clickBack&&parts.push("clickBack"),descriptor.clickForward&&parts.push("clickForward"),key&&parts.indexOf(key)<0&&parts.push(key),parts.join("+")}function parseCommand(shortcut){var parts=namespaceHelper.getName(shortcut).split("+"),descriptor={keyboardInvolved:!1,mouseClickInvolved:!1,mouseWheelInvolved:!1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,key:null,scrollUp:null,scrollDown:null,clickLeft:null,clickRight:null,clickMiddle:null,clickBack:null,clickForward:null};return _.forEach(parts,
function(part){if(modifiers[part])descriptor[modifiers[part]]=!0;else if(0<=part.indexOf("mouse")){if(descriptor.keyboardInvolved)throw new Error("A shortcut cannot involve both mouse and regular keys!");0<=part.indexOf("scroll")&&(descriptor.mouseWheelInvolved=!0,descriptor.scrollUp=0<=part.indexOf("up"),descriptor.scrollDown=0<=part.indexOf("down")),0<=part.indexOf("click")&&(descriptor.mouseClickInvolved=!0,descriptor.clickLeft=0<=part.indexOf("left"),descriptor.clickRight=0<=part.indexOf("right"),descriptor.clickMiddle=0<=part.indexOf("middle"),descriptor.clickBack=0<=part.indexOf("back"),descriptor.clickForward=0<=part.indexOf("forward"))}else{if(
descriptor.mouseClickInvolved||descriptor.mouseWheelInvolved)throw new Error("A shortcut cannot involve both mouse and regular keys!");descriptor.keyboardInvolved=!0,descriptor.key=part}}),descriptor}return function(root,defaultOptions){var keyboardIsRegistered=!1,mouseClickIsRegistered=!1,mouseWheelIsRegistered=!1,keyboardCount=0,mouseClickCount=0,mouseWheelCount=0,shortcuts={},handlers={},states={};function getHandlers(command,namespace){return handlers[namespace]=handlers[namespace]||{},handlers[namespace][command]=handlers[namespace][command]||[],handlers[namespace][command]}function getCommandHandlers(command){return _.reduce(handlers,function(acc,
nsHandlers){return nsHandlers[command]&&(acc=acc.concat(nsHandlers[command])),acc},[])}function setOptions(descriptor,options){descriptor.options=_.defaults(_.merge(descriptor.options||{},options),defaultOptions)}function unregisterKeyboard(){--keyboardCount<=0&&(keyboardCount=0,keyboardIsRegistered&&(unregisterEvent(root,"keydown",onKeyboard),keyboardIsRegistered=!1))}function unregisterMouseClick(){--mouseClickCount<=0&&(mouseClickCount=0,mouseClickIsRegistered&&(unregisterEvent(root,"click",onMouseClick),mouseClickIsRegistered=!1))}function unregisterMouseWheel(){--mouseWheelCount<=0&&(mouseWheelCount=0,mouseWheelIsRegistered&&(unregisterEvent(root,
"wheel",onMouseWheel),mouseWheelIsRegistered=!1))}function registerCommand(command,descriptor){(shortcuts[command]=descriptor).keyboardInvolved&&(keyboardIsRegistered||(registerEvent(root,"keydown",onKeyboard),keyboardIsRegistered=!0),keyboardCount++),descriptor.mouseClickInvolved&&(mouseClickIsRegistered||(registerEvent(root,"click",onMouseClick),mouseClickIsRegistered=!0),mouseClickCount++),descriptor.mouseWheelInvolved&&(mouseWheelIsRegistered||(registerEvent(root,"wheel",onMouseWheel),mouseWheelIsRegistered=!0),mouseWheelCount++)}function onKeyboard(event){processShortcut(event,{keyboardInvolved:!0,ctrlKey:event.ctrlKey,altKey:event.altKey,
shiftKey:event.shiftKey,metaKey:event.metaKey,key:function(event){var code=event.which||event.keyCode,character=32<=code?String.fromCharCode(code).toLowerCase():"",key=event.key&&event.key.toLowerCase(),keyName=event.code&&event.code.toLowerCase();return keyName&&(0===keyName.indexOf("key")?(key<"a"||"z"<key)&&"a"<=character&&character<="z"&&(key=character):0===keyName.indexOf("digit")&&(key=keyName.substr(5))),specialKeys[code]||key||character}(event)})}function onMouseClick(event){processShortcut(event,_.merge({mouseClickInvolved:!0,ctrlKey:event.ctrlKey,altKey:event.altKey,shiftKey:event.shiftKey,metaKey:event.metaKey},function(event){var buttons={
clickLeft:!1,clickRight:!1,clickMiddle:!1,clickBack:!1,clickForward:!1};if(event.buttons)buttons.clickLeft=!!(1&event.buttons),buttons.clickRight=!!(2&event.buttons),buttons.clickMiddle=!!(4&event.buttons),buttons.clickBack=!!(8&event.buttons),buttons.clickForward=!!(16&event.buttons);else switch(event.button){case 0:buttons.clickLeft=!0;break;case 1:buttons.clickMiddle=!0;break;case 2:buttons.clickRight=!0;break;case 3:buttons.clickBack=!0;break;case 4:buttons.clickForward=!0}return buttons}(event)))}function onMouseWheel(event){processShortcut(event,_.merge({mouseClickInvolved:!0,ctrlKey:event.ctrlKey,altKey:event.altKey,shiftKey:event.shiftKey,
metaKey:event.metaKey},function(event){return{scrollUp:event.deltaY<0,scrollDown:0<event.deltaY}}(event)))}function processShortcut(event,descriptor){var shortcutHandlers,$target,command=normalizeCommand(descriptor),shortcut=shortcuts[command];if(shortcut&&!states.disabled){if(!0===shortcut.options.avoidInput&&($target=$(event.target)).closest('[type="text"],textarea').length&&(!shortcut.options.allowIn||!$target.closest(shortcut.options.allowIn).length))return;!1===shortcut.options.propagate&&event.stopPropagation(),!0===shortcut.options.prevent&&event.preventDefault(),(shortcutHandlers=getCommandHandlers(command))&&_.forEach(shortcutHandlers,function(
handler){handler(event,command)})}}return root.jquery&&(root=root.get(0)),{set:function(shortcut,options){return _.forEach(namespaceHelper.split(shortcut,!0),function(normalized){var descriptor=parseCommand(normalized),command=normalizeCommand(descriptor);setOptions(descriptor,options),registerCommand(command,descriptor)}),this},add:function(shortcut,handler,options){return _.isFunction(handler)&&_.forEach(namespaceHelper.split(shortcut,!0),function(normalized){var namespace=namespaceHelper.getNamespace(normalized,"*"),descriptor=parseCommand(normalized),command=normalizeCommand(descriptor);setOptions(descriptor,options),registerCommand(command,descriptor),
getHandlers(command,namespace).push(handler)}),this},remove:function(shortcut){return _.forEach(namespaceHelper.split(shortcut,!0),function(normalized){var namespace=namespaceHelper.getNamespace(normalized,"*"),command=normalizeCommand(parseCommand(normalized));!function(command,namespace){namespace&&!command?handlers[namespace]={}:_.forEach(handlers,function(nsHandlers,ns){!nsHandlers[command]||"*"!==namespace&&namespace!==ns||(nsHandlers[command]=[])})}(command,namespace),getCommandHandlers(command).length||function(command){var descriptor=shortcuts[command];shortcuts[command]=null,descriptor&&(descriptor.keyboardInvolved&&unregisterKeyboard(),
descriptor.mouseClickInvolved&&unregisterMouseClick(),descriptor.mouseWheelInvolved&&unregisterMouseWheel())}(command)}),this},exists:function(shortcut){var normalized=String(shortcut).trim().toLowerCase(),namespace=namespaceHelper.getNamespace(normalized,"*"),command=normalizeCommand(parseCommand(normalized)),shortcutExists=!1;return shortcuts[command]?shortcutExists="*"===namespace||!!getHandlers(command,namespace).length:command||(shortcutExists=!_.isEmpty(handlers[namespace])),shortcutExists},clear:function(){return shortcuts={},handlers={},mouseWheelCount=mouseClickCount=keyboardCount=0,unregisterKeyboard(),unregisterMouseClick(),unregisterMouseWheel(),
this},getState:function(name){return!!states[name]},setState:function(name,state){return states[name]=!!state,this},enable:function(){return this.setState("disabled",!1),this},disable:function(){return this.setState("disabled",!0),this}}}}),define("ui/keyNavigation/navigator",["jquery","lodash","core/eventifier","util/shortcut/registry"],function($,_,eventifier,shortcutRegistry){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$,_=_&&_.hasOwnProperty("default")?_.default:_,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier.default:eventifier,shortcutRegistry=shortcutRegistry&&shortcutRegistry.hasOwnProperty("default"
)?shortcutRegistry.default:shortcutRegistry;var _navigationGroups={},_ns=".ui-key-navigator",_defaults={defaultPosition:0,keepState:!1,replace:!1,loop:!1,propagateTab:!0},keyNavigatorFactory=function(config){var id,navigables,keyNavigator,$group,_cursor={position:-1,navigable:null},getCurrentCursor=function(){var isFocused=!1;return document.activeElement&&_.forEach(navigables,function(navigable,index){if(navigable.isVisible()&&navigable.isEnabled()&&(document.activeElement===navigable.getElement().get(0)||(!$(document.activeElement).hasClass("key-navigation-highlight")||$(document.activeElement).data("key-navigatior-id")!==id)&&$.contains(
navigable.getElement().get(0),document.activeElement)))return _cursor.position=index,_cursor.navigable=navigable,!(isFocused=!0)}),isFocused?_cursor:null},getClosestPositionRight=function(fromPosition){var pos;for(pos=fromPosition;pos<navigables.length;pos++)if(navigables[pos]&&navigables[pos].isVisible()&&navigables[pos].isEnabled())return pos;return-1},getClosestPositionLeft=function(fromPosition){var pos;for(pos=fromPosition;0<=pos;pos--)if(navigables[pos]&&navigables[pos].isVisible()&&navigables[pos].isEnabled())return pos;return-1};if(config=_.defaults(config||{},_defaults),id=config.id||_.uniqueId("navigator_"),navigables=config.elements||[],
_navigationGroups[id]){if(!config.replace)throw new TypeError("the navigation group id is already in use : "+id);_navigationGroups[id].destroy()}if(_.each(navigables,function(navigable){navigable.init(),navigable.getElement().data("key-navigatior-id",id)}),config.group){if(!($group=$(config.group)).length)throw new TypeError("group element does not exist");$group.addClass("key-navigation-group").attr("data-navigation-id",id)}return keyNavigator=eventifier({getId:function(){return id},getGroup:function(){return $group},isFocused:function(){return!!getCurrentCursor()},next:function(){var pos,cursor=getCurrentCursor();return cursor?(0<=(
pos=getClosestPositionRight(cursor.position+1))?this.focusPosition(pos):config.loop?this.focusPosition(getClosestPositionRight(0)):this.trigger("upperbound"),this.trigger("next",getCurrentCursor())):this.focusPosition(getClosestPositionRight(0)),this},previous:function(){var pos,cursor=getCurrentCursor();return cursor?(0<=(pos=getClosestPositionLeft(cursor.position-1))?this.focusPosition(pos):config.loop?this.focusPosition(getClosestPositionLeft(navigables.length-1)):this.trigger("lowerbound"),this.trigger("previous",getCurrentCursor())):this.focusPosition(getClosestPositionRight(0)),this},activate:function(target){var cursor=getCurrentCursor()
;return cursor&&this.trigger("activate",cursor,target),this},goto:function(groupId){return _navigationGroups[groupId]?_navigationGroups[groupId].focus():this.trigger("error",new Error("goto an unknown navigation group")),this},focus:function(originNavigator){var pos;return config.keepState&&_cursor&&0<=_cursor.position?pos=_cursor.position:_.isFunction(config.defaultPosition)?(pos=config.defaultPosition(navigables))<0&&(pos=0):pos=config.defaultPosition,this.focusPosition(getClosestPositionRight(pos),originNavigator),this},focusPosition:function(position,originNavigator){return navigables[position]&&(_cursor.navigable&&this.trigger("blur",this.getCursor(),
originNavigator),_cursor.position=position,navigables[_cursor.position].focus(),_cursor.navigable=navigables[_cursor.position],this.trigger("focus",this.getCursor(),originNavigator)),this},first:function(){return this.focusPosition(getClosestPositionRight(0)),this},last:function(){return this.focusPosition(getClosestPositionLeft(navigables.length-1)),this},destroy:function(){return _.each(navigables,function(navigable){navigable.getElement().off(_ns),navigable.destroy(),navigable.shortcuts&&navigable.shortcuts.clear()}),delete _navigationGroups[id],this},blur:function(){var cursor=this.getCursor();return cursor&&cursor.navigable&&cursor.navigable.getElement(
).blur(),this},getCursor:function(){return _.clone(_cursor)},getNavigables:function(){return _.clone(navigables)}}),_.each(navigables,function(navigable){if(!function(navElement){return navElement&&_.isFunction(navElement.init)&&_.isFunction(navElement.destroy)&&_.isFunction(navElement.getElement)&&_.isFunction(navElement.isVisible)&&_.isFunction(navElement.isEnabled)&&_.isFunction(navElement.focus)}(navigable))throw new TypeError("not a valid navigable element");navigable.shortcuts=shortcutRegistry(navigable.getElement()).add("tab shift+tab",function(e,key){keyNavigator.trigger(key,e.target)},{propagate:!!config.propagateTab,prevent:!0}).add("enter",
function(e){$(e.target).is(":text,textarea")||(e.preventDefault(),keyNavigator.activate(e.target))},{propagate:!1}).add("up down left right",function(e,key){var $target=$(e.target);$target.is(":text,textarea")||($target.is("img")||$target.hasClass("key-navigation-scrollable")||e.preventDefault(),keyNavigator.trigger(key,e.target))},{propagate:!1}),navigable.getElement().on("keyup"+_ns,function(e){32===(e.keyCode?e.keyCode:e.charCode)&&(e.target!==this&&$(e.target).is(":input")?e.stopPropagation():(e.preventDefault(),keyNavigator.activate(e.target)))}).on("blur"+_ns,function(){var cursor=keyNavigator.getCursor();cursor&&cursor.navigable&&keyNavigator.trigger(
"blur",cursor)})}),_navigationGroups[id]=keyNavigator};return keyNavigatorFactory.get=function(id){if(_navigationGroups[id])return _navigationGroups[id]},keyNavigatorFactory}),define("ui/keyNavigation/navigableDomElement",["jquery","core/eventifier"],function($,eventifier){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier.default:eventifier;var navigableDomElement=function($element){return $element=$($element),eventifier({init:function(){if(!$element.length)throw new TypeError("dom element does not exist");return $element.attr("tabindex",-1),$element.addClass(
"key-navigation-highlight"),this},destroy:function(){return $element.removeClass("key-navigation-highlight"),this},getElement:function(){return $element},isVisible:function(){return $element.is(":visible")},isEnabled:function(){return!$element.is(":disabled")},focus:function(){return $element.focus(),this}})};return navigableDomElement.createFromDoms=function($elements){var list=[];return $elements.each(function(){list.push(navigableDomElement($(this)))}),list},navigableDomElement}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("jquery"),require("lodash")
):"function"==typeof define&&define.amd?define("core/pluginifier",["jquery","lodash"],factory):(global=global||self)["core/pluginifier"]=factory(global.$,global._)}(this,function($,_){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$,_=_&&_.hasOwnProperty("default")?_.default:_;var basePlugin={options:function(dataNs,ns,options){return this.each(function(){var $elt=$(this),currentOptions=$elt.data(dataNs);currentOptions&&$elt.data(dataNs,_.merge(currentOptions,options))})},disable:function(dataNs,ns){return this.each(function(){var $elt=$(this),options=$elt.data(dataNs);options&&$elt.addClass(options.disableClass||"disabled").trigger("disable."+ns)})
},enable:function(dataNs,ns){return this.each(function(){var $elt=$(this),options=$elt.data(dataNs);options&&$elt.removeClass(options.disableClass||"disabled").trigger("enable."+ns)})}};return{register:function(pluginName,plugin,config){var ns=(config=config||{}).ns||pluginName.toLowerCase(),dataNs=config.dataNs||"ui."+ns,expose=config.expose||[];return _.isFunction($.fn[pluginName])?$.error("A plugin named "+pluginName+" is already registered"):_.isPlainObject(plugin)&&_.isFunction(plugin.init)?(_.assign(plugin,_.transform(basePlugin,function(result,prop,key){_.isFunction(prop)&&(result[key]=_.partial(basePlugin[key],dataNs,ns))})),_.forEach(expose,
function(toExposeName){var privateMethod=toExposeName,publicMethod=toExposeName;/^_/.test(expose)?publicMethod=publicMethod.replace(/^_/,""):privateMethod="_"+privateMethod,_.isFunction(plugin[privateMethod])&&!_.isFunction(plugin[publicMethod])&&(plugin[publicMethod]=function(){var returnValue,args=Array.prototype.slice.call(arguments,0);return this.each(function(){returnValue=plugin[privateMethod].apply(plugin,[$(this)].concat(args))}),returnValue||this})}),void($.fn[pluginName]=function(method){if(plugin[method]){if(!/^_/.test(method))return plugin[method].apply(this,Array.prototype.slice.call(arguments,1));$.error(
"Trying to call a private method `"+method+"`")}else if("object"==typeof method||!method)return plugin.init.apply(this,arguments);$.error("Method "+method+" does not exist on plugin")})):$.error("The object to register as a jQuery plugin must be a plain object with an `init` method.")}}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("jquery"),require("lodash")):"function"==typeof define&&define.amd?define("core/dataattrhandler",["jquery","lodash"],factory):(global=global||self)["core/dataattrhandler"]=factory(global.$,global._)}(this,function($,_){"use strict";$=$&&$.hasOwnProperty("default"
)?$.default:$,_=_&&_.hasOwnProperty("default")?_.default:_;var defaults={container:!1,listenerEvent:"click",useTarget:!0,bubbled:!1},letDefaultOn=[":radio",":checkbox"],shouldPreventDefault=function($elt){return!$elt.is(letDefaultOn.join(","))},DataAttrHandler=function(attrName,options){var self=this;this.options=_.defaults(options,defaults);var selector="[data-"+attrName+"]";if(!_.has(this.options,"namespace")||!_.isString(this.options.namespace))return $.error("The plugin data namespace option is required");this.options.container&&this.options.container.selector&&(selector=this.options.container.selector+" "+selector),this.options.inner&&(
selector+=" "+this.options.inner),$(document).off(this.options.listenerEvent,selector).on(this.options.listenerEvent,selector,function(e){var $target,$outer,$elt=$(e.target);!0!==self.options.bubbled&&!$elt.is(selector)||(void 0===$elt.data(attrName)&&(self.options.inner||self.options.bubbled)&&($elt=($outer=$elt).parents("[data-"+attrName+"]")),$target=!0===self.options.useTarget?DataAttrHandler.getTarget(attrName,$elt):self.options.inner?$outer:void 0,$elt.data(self.options.namespace)||("function"==typeof self.createPlugin&&self.createPlugin($elt,$target),$elt.is(":radio")&&$elt.attr("name")&&$(':radio[name="'+$elt.attr("name")+'"]').not($elt).on(
self.options.listenerEvent,function(e){"function"==typeof self.callPluginMethod&&self.callPluginMethod($elt,$target),shouldPreventDefault($elt)&&e.preventDefault()})),"function"==typeof self.callPluginMethod&&self.callPluginMethod($elt,$target),shouldPreventDefault($elt)&&e.preventDefault())})};return DataAttrHandler.prototype.init=function(cb){return this.createPlugin=cb,this},DataAttrHandler.prototype.trigger=function(cb){return this.callPluginMethod=cb,this},DataAttrHandler.getTarget=function(attrName,$elt){var relativeRegex=/^(\+|>|~|:parent|<)/,$target=[],targetSelector=$elt.attr("data-"+attrName)||$elt.attr("href")||$elt.attr("attrName");if(!_.isEmpty(
targetSelector)){var matches=relativeRegex.exec(targetSelector);if(null!==matches){var selector=targetSelector.replace(relativeRegex,"");$target=":parent"===matches[0]||"<"===matches[0]?$elt.parents(selector):"~"===matches[0]?$elt.siblings(selector):"+"===matches[0]?$elt.next(selector):$(selector,$elt)}else $target=$(targetSelector)}return $target},DataAttrHandler}),define("ui/modal",["jquery","core/pluginifier","core/dataattrhandler"],function($,Pluginifier,DataAttrHandler){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$,Pluginifier=Pluginifier&&Pluginifier.hasOwnProperty("default")?Pluginifier.default:Pluginifier,
DataAttrHandler=DataAttrHandler&&DataAttrHandler.hasOwnProperty("default")?DataAttrHandler.default:DataAttrHandler;var dataNs="ui.modal",defaults={modalCloseClass:"modal-close",modalOverlayClass:"modal-bg",startClosed:!1,disableClosing:!1,width:"responsive",minWidth:0,minHeight:0,vCenter:!0,$context:null,animate:400},modal={init:function(options){return(options=$.extend(!0,{},defaults,options)).animate&&("number"!=typeof options.animate?options.animate=defaults.animate:options.animate=Math.max(100,options.animate)),$(this).each(function(){var $modal=$(this);if(options.modalOverlay="__modal-bg-"+($modal.attr("id")||(new Date).getTime()),$modal.data(dataNs,
options),0===$("#"+options.modalOverlay).length){var $overlay=$("<div/>").attr({id:options.modalOverlay,class:options.modalOverlayClass});options.$context instanceof $&&options.$context.length?($overlay.css("position","absolute"),options.$context.append($overlay)):$modal.after($overlay)}0!==$("."+options.modalCloseClass,$modal).length||options.disableClosing||$('<button id="modal-close-btn" class="'+options.modalCloseClass+'"><span class="icon-close"></span></button>').appendTo($modal),options.startClosed||modal._open($modal),$modal.trigger("create.modal")})},_destroy:function($element){return $element.each(function(){var $modal=$(this),options=$modal.data(
dataNs);$modal.removeData(dataNs),$("#"+options.modalOverlay).remove(),$modal.hide(),$element.trigger("destroyed.modal")})},_bindEvents:function($element){var options=$element.data(dataNs);options&&("responsive"===options.width&&$(window).on("resize.modal",function(e){e.preventDefault(),modal._resize($element)}),options.disableClosing||($("."+options.modalCloseClass,$element).on("click.modal",function(e){e.preventDefault(),closeModal($element,"close")}),$("#"+options.modalOverlay).on("click.modal",function(e){e.preventDefault(),closeModal($element,"overlay")}),options.disableEscape||$(document).on("keydown.modal",function(e){27===e.keyCode&&(
e.preventDefault(),closeModal($element,"escape"))})))},_unBindEvents:function($element){var options=$element.data(dataNs);options&&"responsive"===options.width&&$(window).off("resize.modal"),$element.off("click.modal"),options&&!options.disableClosing&&($("."+options.modalCloseClass,$element).off("click.modal"),$("#"+options.modalOverlay).off("click.modal"),$(document).off("keydown.modal"))},_open:function($element){var topOffset,onOpen,$overlay,to,modalHeight=$element.outerHeight(),windowHeight=$(window).height(),options=$element.data(dataNs);void 0!==options&&(onOpen=function(){$element.addClass("opened"),modal._bindEvents($element),$element.trigger(
"opened.modal")},topOffset=options.top?options.top:options.vCenter||windowHeight<modalHeight?40:(windowHeight-modalHeight)/2,options.top||$element.parent().hasClass("no-scroll-offset")||$element.parents().map(function(){"BODY"!==this.tagName&&"HTML"!==this.tagName&&(topOffset+=parseInt($(this).scrollTop(),10))}),to={opacity:"1",top:topOffset+"px"},modal._resize($element),$overlay=$("#"+options.modalOverlay),$element.show(),options.animate&&$element.is(":visible")?($element.css({top:"-"+modalHeight+"px",display:"block"}),$overlay.fadeIn(options.animate-100),$element.animate(to,options.animate,onOpen)):($overlay.show(),$element.css(to),onOpen()))},
_close:function($element){closeModal($element,"api")},_resize:function($element){var options=$element.data(dataNs),windowWidth=parseInt($(window).width(),10),css={},modalWidth="responsive"===options.width?.7*windowWidth:parseInt(options.width,10);css.width=Math.max(modalWidth,options.minWidth),options.minHeight&&(css.minHeight=parseInt(options.minHeight)+"px"),$element.css(css)}};function closeModal($element,reason){function onClose(){$element.removeClass("opened"),$element.css("display","none"),$element.trigger("closed.modal",reason)}var options=$element.data(dataNs),$overlay=$("#"+options.modalOverlay);modal._unBindEvents($element),
options.animate&&$element.is(":visible")?($overlay.fadeOut(options.animate-100),$element.animate({opacity:"0",top:"-1000px"},options.animate,onClose)):($overlay.hide(),$element.hide(),onClose())}return Pluginifier.register("modal",modal,{expose:["open","close","destroy"]}),function($container){new DataAttrHandler("modal",{container:$container,listenerEvent:"click",namespace:dataNs}).init(function($elt,$target){$target.modal()})}}),define("ui/dialog",["jquery","lodash","i18n","handlebars","lib/dompurify/purify","ui/keyNavigation/navigator","ui/keyNavigation/navigableDomElement","util/shortcut/registry","ui/modal"],function($$1,_,__,Handlebars,DOMPurify,
keyNavigator,navigableDomElement,shortcutRegistry,modal){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(
value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",
function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,keyNavigator=keyNavigator&&keyNavigator.hasOwnProperty("default")?keyNavigator.default:keyNavigator,navigableDomElement=navigableDomElement&&navigableDomElement.hasOwnProperty("default")?navigableDomElement.default:navigableDomElement,
shortcutRegistry=shortcutRegistry&&shortcutRegistry.hasOwnProperty("default")?shortcutRegistry.default:shortcutRegistry,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<div class="preview-modal-feedback modal ',stack1=(helper=helpers.class)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.class)===functionType?helper.call(depth0,{
hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'">\n    <div class="modal-body clearfix">\n        ',!(stack1=helpers.if.call(depth0,depth0&&depth0.heading,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){var stack1,helper,buffer="";return buffer+='\n        <h4 class="strong">',stack1=(helper=helpers.heading)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.heading)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"</h4>\n        "},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='\n\n        <p class="message">',!(stack1=(helper=helpers.message
)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.message)===functionType?helper.call(depth0,{hash:{},data:data}):helper)&&0!==stack1||(buffer+=stack1),buffer+="</p>\n\n        ",!(stack1=helpers.if.call(depth0,depth0&&depth0.content,{hash:{},inverse:this.noop,fn:this.program(3,function(depth0,data){var stack1,helper,buffer="";return buffer+='\n        <div class="content">',!(stack1=(helper=helpers.content)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.content)===functionType?helper.call(depth0,{hash:{},data:data}):helper)&&0!==stack1||(buffer+=stack1),buffer+="</div>\n        "},data),data:data}))&&0!==stack1||(
buffer+=stack1),buffer+='\n\n        <div class="buttons rgt"></div>\n    </div>\n</div>\n'});Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template$1=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this;function program2(depth0,data){var stack1,helper,buffer="";return buffer+='<span class="icon-',stack1=(helper=helpers.icon)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.icon)===functionType?helper.call(
depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'"></span> '}return!(stack1=helpers.each.call(depth0,depth0&&depth0.buttons,{hash:{},inverse:self.noop,fn:self.program(1,function(depth0,data){var stack1,helper,buffer="";return buffer+='\n    <button class="btn-',stack1=(helper=helpers.type)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.type)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+" small ",stack1=(helper=helpers.id)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.id)===functionType?helper.call(depth0,{hash:{},data:data}):helper,
buffer+=escapeExpression(stack1)+'" data-control="',stack1=(helper=helpers.id)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.id)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'" type="button">\n        ',!(stack1=helpers.if.call(depth0,depth0&&depth0.icon,{hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='\n        <span class="label">',stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(
stack1)+"</span>\n    </button>\n"},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n"});var _definedButtons={ok:{id:"ok",type:"info",label:__("Ok"),close:!0},cancel:{id:"cancel",type:"regular",label:__("Cancel"),close:!0},yes:{id:"yes",type:"info",label:__("Yes"),close:!0},no:{id:"no",type:"regular",label:__("No"),close:!0}},_defaults={message:"",content:"",width:500,animate:!1,autoRender:!1,autoDestroy:!1,renderTo:"body",buttons:"cancel,ok"},dialog={init:function(options){var self=this,events={},initOptions=_.omit(options||{},function(value,key){var omit=!1;return 2<key.length&&"on"===key.substr(0,2)&&(events[key.substr(2)]=value,omit=!0),omit})
;return _.defaults(this,initOptions,_defaults),this.$html=$$1(function(data,options){var html=Template(data,options);return html}(this)),this.$buttons=this.$html.find(".buttons"),this.rendered=!1,this.destroyed=!1,this.$buttons.on("click.modal","button",this._onButtonClick.bind(this)),this.setButtons(this.buttons),_.forEach(events,function(callback,eventName){eventName.indexOf(".")<0&&(eventName+=".modal"),self.on(eventName.toLowerCase(),callback)}),this.autoRender&&this.render(),this},destroy:function(){return this.destroyed||(this._destroy(),this.rendered=!1,this.destroyed=!0,this.trigger("destroy.modal"),this.$buttons.off(".modal"),this.$html.off(".modal"
).remove(),this.$html=null,this.$buttons=null),this},setButtons:function(buttons){var self=this;return this.destroyed||(buttons=buttons||_defaults.buttons,_.isArray(buttons)||_.isString(buttons)&&(buttons=buttons.split(",")),this.buttons={},_.forEach(buttons,function(btn){_.isString(btn)&&(btn=btn.trim(),btn=_definedButtons[btn]||{id:btn,type:"info",label:btn}),btn.type||(btn.type="regular"),self.buttons[btn.id]=btn}),this.$buttons.html(function(data,options){var html=Template$1(data,options);return html}(this))),this},render:function(to){return this.destroyed||($$1(to||this.renderTo).append(this.$html),this._install(),this.rendered=!0),this},show:function(
){return this.destroyed||(this.rendered?this._open():this.render()),this},hide:function(){return!this.destroyed&&this.rendered&&(this._close(),this.autoDestroy&&this.destroy()),this},on:function(eventName){var dom=this.$html;return dom&&dom.on.apply(dom,arguments),this},off:function(eventName){var dom=this.$html;return dom&&dom.off.apply(dom,arguments),this},trigger:function(eventName,extraParameters){var dom=this.$html;return dom&&(void 0===extraParameters&&(extraParameters=[]),_.isArray(extraParameters)||(extraParameters=[extraParameters]),(extraParameters=Array.prototype.slice.call(extraParameters)).push(this),dom.trigger(eventName,extraParameters)),this
},getDom:function(){return this.$html},_onButtonClick:function(event){var id=$$1(event.target).closest("button").data("control"),btn=this.buttons[id];btn&&this._execute(btn)},_execute:function(btn){btn.action&&btn.action.apply(this,[btn,this]),this.trigger(btn.id+"btn.modal",[btn]),btn.close&&this.hide()},focus:function(button){var focusPosition=-1;button&&(focusPosition=_.findIndex(this.navigator.getNavigables(),function(navigable){return navigable.getElement().is('[data-control="'+button+'"]')})),0<=focusPosition?this.navigator.focusPosition(focusPosition):this.navigator.focus()},_install:function(){var $buttons,closeButton,self=this;this.destroyed||(
this.$html.modal({width:this.width,animate:this.animate,disableClosing:this.disableClosing,disableEscape:this.disableEscape}).on("closed.modal",function(){self.autoDestroy&&self.destroy()}),$buttons=this.$buttons.find("button"),(closeButton=$$1(".modal").find("#modal-close-btn")[0])&&$buttons.push(closeButton),this.navigator=keyNavigator({elements:navigableDomElement.createFromDoms($buttons)}).on("right down",function(){this.next()}).on("left up",function(){this.previous()}).on("tab",function(){this.getCursor().position===$buttons.length-1?this.first():this.next()}).on("shift+tab",function(){0===this.getCursor().position?this.last():this.previous()}).on(
"activate",function(cursor){cursor.navigable.getElement().click()}),self.navigator.last(),this.globalShortcut=shortcutRegistry($$1("body")).add("tab shift+tab",function(){self.navigator.isFocused()||self.navigator.focus()}),self.trigger("create.dialog"))},_open:function(){this.$html.modal("open")},_close:function(){this.$html.modal("close")},_destroy:function(){this.$html.modal("destroy"),this.navigator&&this.navigator.destroy(),this.globalShortcut&&this.globalShortcut.clear()}};return function(options){var instance=_.clone(dialog,!0);return instance.init(options),instance}}),define("ui/dialog/confirm",["lodash","i18n","ui/dialog"],function(_,__,dialog){
"use strict";return _=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,dialog=dialog&&dialog.hasOwnProperty("default")?dialog.default:dialog,function(message,accept,refuse,options){var dialogOptions,dlg,accepted=!1,_options={buttons:{labels:{ok:__("Ok"),cancel:__("Cancel")}}};return dialogOptions={message:message,autoRender:!0,autoDestroy:!0,onOkBtn:function(){accepted=!0,_.isFunction(accept)&&accept.call(this)},buttons:{ok:{id:"ok",type:"info",label:(options=_.defaults(options||{},_options)).buttons.labels.ok||__("Ok"),close:!0},cancel:{id:"cancel",type:"regular",label:options.buttons.labels.cancel||__("Cancel"),
close:!0}}},dlg=dialog(dialogOptions),_.isFunction(refuse)&&dlg.on("closed.modal",function(){accepted||refuse.call(this)}),dlg}}),define("ui/hider",["jquery","core/eventifier"],function($,eventifier){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$;function jqWrap(element){return element instanceof $?element:$(element)}return{show:function(element){return jqWrap(element).removeClass("hidden")},hide:function(element){return jqWrap(element).addClass("hidden")},toggle:function(element,state){return void 0!==state&&(state=!state),jqWrap(element).toggleClass("hidden",state)},isHidden:function(element,real){var $elt=jqWrap(element)
;return real?$elt.hasClass("hidden")||"none"===$elt.css("display")||"hidden"===$elt.css("visibility"):$elt.hasClass("hidden")}}}),define("css!ui/class/css/selector",[],function(){}),define("ui/class/selector",["jquery","lodash","i18n","ui/component","handlebars","lib/dompurify/purify","css!ui/class/css/selector.css"],function($$1,_,__,component,Handlebars,DOMPurify,selector_css){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[]
;return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),
increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,component=component&&component.hasOwnProperty("default"
)?component.default:component,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<div class="class-selector">\n    ',!(stack1=helpers.if.call(depth0,depth0&&depth0.classUri,{hash:{},
inverse:this.program(3,function(depth0,data){var stack1,helper,buffer="";return buffer+='\n    <a href="#" class="selected truncate empty">',stack1=(helper=helpers.placeholder)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.placeholder)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"</a>\n    "},data),fn:this.program(1,function(depth0,data){var stack1,helper,buffer="";return buffer+='\n    <a href="#" class="selected truncate" data-uri="',stack1=(helper=helpers.classUri)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.classUri)===functionType?helper.call(depth0,{
hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'" title="',stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'">',stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"</a>\n    "},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='\n    <div class="options folded">\n        <ul>',!(stack1=(helper=helpers.tree)?helper.call(depth0,{hash:{},
data:data}):typeof(helper=depth0&&depth0.tree)===functionType?helper.call(depth0,{hash:{},data:data}):helper)&&0!==stack1||(buffer+=stack1),buffer+="</ul>\n    </div>\n</div>\n"});function selectorTpl(data,options,asString){var html=Template(data,options);return html}Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template$1=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<li>\n    <a href="#" data-uri="',
buffer+=escapeExpression(stack1=(helper=helpers.uri)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.uri)===functionType?helper.call(depth0,{hash:{},data:data}):helper)+'" title="',buffer+=escapeExpression(stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper)+'">',buffer+=escapeExpression(stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper)+"</a>\n    ",!(stack1=helpers.if.call(depth0,depth0&&depth0.childList,{
hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){var stack1,helper,buffer="";return buffer+="\n        <ul>\n            ",!(stack1=(helper=helpers.childList)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.childList)===functionType?helper.call(depth0,{hash:{},data:data}):helper)&&0!==stack1||(buffer+=stack1),buffer+="\n        </ul>\n    "},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n</li>\n\n"});var defaultConfig={classes:[],placeholder:__("Select a class")};return function($container,config){var $selected,$options,classList={},buildTree=function(classes){return _.reduce(classes,function nodeToListItem(
acc,node){var item;return node.uri&&node.label&&(item=_.clone(node),classList[item.uri]=item,node.children&&node.children.length&&(item.childList=_.reduce(node.children,nodeToListItem,"")),acc+=function(data,options){var html=Template$1(data,options);return html}(item)),acc},"")},classSelector=component({setValue:function(uri){return this.config.classUri===uri||_.isUndefined(classList[uri])||(this.config.classUri=uri,this.is("rendered")&&$selected.length&&($selected.text(classList[uri].label).attr({title:classList[uri].label,"data-uri":uri}).data("uri",uri).removeClass("empty"),this.trigger("change",uri,classList[uri]))),this},getValue:function(){
return this.config.classUri},getClassNode:function(){var node=null;return this.config.classUri&&classList[this.config.classUri]&&(node=classList[this.config.classUri]),node},empty:function(){return this.is("rendered")&&$selected.length&&this.config.classUri&&(this.config=_.omit(this.config,"classUri"),$selected.text(this.config.placeholder).removeAttr("title").data("uri",null).removeAttr("data-uri").addClass("empty"),this.trigger("change")),this},hasNode:function(node){var uri;return!(!node||!classList)&&(uri=_.isString(node)?node:node.uri,_.has(classList,uri))},removeNode:function(node){var uri;return!!this.hasNode(node)&&((uri=_.isString(node
)?node:node.uri)===this.config.classUri&&this.empty(),classList=_.omit(classList,uri),this.is("rendered")&&$$1('[data-uri="'+uri+'"]',this.getElement()).parent("li").remove(),!this.hasNode(node))},addNode:function(node,parentUri){var subTree,$parentNode;return this.is("rendered")&&node&&!this.hasNode(node)&&(subTree=buildTree([node]),parentUri&&($parentNode=$$1('[data-uri="'+parentUri+'"]',$options)),$parentNode&&$parentNode.length||($parentNode=$$1("[data-uri]:first-child",$options)),$parentNode.parent("li").children("ul").length?$parentNode.parent("li").children("ul").append(subTree):$parentNode.parent("li").append("<ul>"+subTree+"</ul>")),this},
updateNode:function(node){return node&&node.uri&&this.hasNode(node)&&classList[node.uri].label!==node.label&&(classList[node.uri].label=node.label,this.is("rendered")&&$$1('[data-uri="'+node.uri+'"]',this.getElement()).attr("title",node.label).text(node.label)),this},updateNodes:function(nodes){var self=this;return _.forEach(nodes,function(node){node.children&&self.updateNodes(node.children),self.updateNode(node)}),this}},defaultConfig).setTemplate(selectorTpl).on("init",function(){this.config.tree=buildTree(this.config.classes),this.config.classUri&&classList[this.config.classUri]&&(this.config.label=classList[this.config.classUri].label),this.render(
$container)}).on("render",function(){var self=this,$component=this.getElement();$selected=$$1(".selected",$component),$options=$$1(".options",$component),$selected.on("click",function(e){e.preventDefault(),$options.toggleClass("folded")}),$options.on("click","a",function(e){e.preventDefault(),self.setValue($$1(this).data("uri")),$options.toggleClass("folded")})}).on("destroy",function(){classList={}});return _.defer(function(){classSelector.init(config)}),classSelector}}),define("ui/resource/selectable",["jquery","lodash"],function($,_){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$,_=_&&_.hasOwnProperty("default")?_.default:_;return function(
component,config){var selection={},nodes={},isAComponent=_.all(["on","trigger","init","render","is","getElement"],function(method){return _.isFunction(component[method])});if(!_.isObject(component)||!isAComponent)throw new TypeError("Selectable expects a component");return _.assign(component,{getNodes:function(){return nodes},getNode:function(uri){return!(!uri||!_.isPlainObject(nodes[uri]))&&nodes[uri]},setNodes:function(newNodes){_.isArray(newNodes)?nodes=_.reduce(newNodes,function(acc,node){return node.uri&&(acc[node.uri]=node),acc},{}):_.isObject(newNodes)&&(nodes=newNodes)},addNode:function(uri,node){return!!_.isPlainObject(node)&&(nodes[uri]=node,
this.trigger("add",uri,node),!0)},removeNode:function(uri){return!!this.hasNode(uri)&&(selection[uri]&&this.unselect(uri),nodes=_.omit(nodes,uri),this.trigger("remove",uri),!0)},hasNode:function(uri){return void 0!==nodes[uri]},getSelection:function(){return selection},clearSelection:function(){return 0<_.size(selection)&&(selection={}),this.is("rendered")&&($(".selected",this.getElement()).removeClass("selected"),this.trigger("change",selection)),this},select:function(uris,only,onlyVisible,withChildren){var $component,self=this,currentConfig=_.defaults(component.getConfig()||{},config||{});return this.is("rendered")&&($component=this.getElement(),only&&(
selection={},$(".selected",this.getElement()).removeClass("selected")),_.isArray(uris)||(uris=[uris]),_(uris).reject(function(uri){return void 0!==selection[uri]||!nodes[uri]}).forEach(function(uri){var $node=$('[data-uri="'+uri+'"]',$component),selectNode=$node.length;selectNode&&currentConfig&&_.isFunction(currentConfig.preventSelection)&&currentConfig.preventSelection(uri,nodes[uri],$node)&&(selectNode=!1),selectNode&&($node.addClass("selected"),selection[uri]=nodes[uri]),withChildren&&self.is("multiple")&&$node.find("[data-uri]").each(function(i,child){$(child).addClass("selected")}).map(function(){return $(this).data("uri")}).each(function(i,childUri){
selection[childUri]=nodes[childUri]})}),this.trigger("change",selection,onlyVisible)),this},selectVisible:function(){var $elements=this.getElement().find("[data-uri]").filter(function(){return 0===$(this).parents(".closed").length});this.select(_.map($elements,function(element){return $(element).data("uri")}),!1,!0)},unselect:function(uris){var $component;return this.is("rendered")&&($component=this.getElement(),_.isArray(uris)||(uris=[uris]),_(uris).filter(function(uri){return void 0!==selection[uri]||!nodes[uri]}).forEach(function(uri){var $node=$('[data-uri="'+uri+'"]',$component);$node.length&&($node.removeClass("selected"),selection=_.omit(selection,uri
)),$node.find("[data-uri]").each(function(i,child){$(child).removeClass("selected")}).map(function(){return $(this).data("uri")}).each(function(i,childUri){selection=_.omit(selection,childUri)})}),this.trigger("change",selection)),this},selectAll:function(){return this.select(_.keys(nodes))}})}}),define("ui/resource/tree",["jquery","lodash","ui/component","ui/resource/selectable","ui/hider","handlebars","i18n","lib/dompurify/purify"],function($$1,_,component,selectable,hider,Handlebars,__,DOMPurify){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){
return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",
function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,
component=component&&component.hasOwnProperty("default")?component.default:component,selectable=selectable&&selectable.hasOwnProperty("default")?selectable.default:selectable,hider=hider&&hider.hasOwnProperty("default")?hider.default:hider,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,__=__&&__.hasOwnProperty("default")?__.default:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],
helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="";return buffer+='<div class="resource-tree ',!(stack1=helpers.if.call(depth0,depth0&&depth0.multiple,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){return"multiple"},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='">\n    <ul></ul>\n</div>\n\n'});function treeTpl(data,options,asString){var html=Template(data,options);return html}Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template$1=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,
Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing;function program2(depth0,data){return" selectable"}function program4(depth0,data){var stack1,helper,buffer="";return buffer+='data-access="',stack1=(helper=helpers.accessMode)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.accessMode)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'"'}function program6(depth0,data){var stack1,helper,buffer="";return buffer+="\n        ",!(stack1=(helper=helpers.childList
)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.childList)===functionType?helper.call(depth0,{hash:{},data:data}):helper)&&0!==stack1||(buffer+=stack1),buffer+="\n    "}return helper=helpers.equal||depth0&&depth0.equal,options={hash:{},inverse:self.noop,fn:self.program(1,function(depth0,data){var stack1,helper,options,buffer="";return buffer+='\n<li data-uri="',stack1=(helper=helpers.uri)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.uri)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'" class="class',!(stack1=helpers.if.call(depth0,depth0&&depth0.selectable,{
hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+=" ",stack1=(helper=helpers.state)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.state)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'" data-count="',stack1=(helper=helpers.count)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.count)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'" ',!(stack1=helpers.if.call(depth0,depth0&&depth0.accessMode,{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}
))&&0!==stack1||(buffer+=stack1),buffer+='>\n    <a href="#" title="',stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'">\n        <span class="class-toggler clickable" tabindex="0"></span>\n        <span class="icon-folder"></span>\n        ',stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1
)+'\n        <span class="selector clickable" tabindex="0"></span>\n    </a>\n    <ul>\n    ',!(stack1=helpers.if.call(depth0,depth0&&depth0.childList,{hash:{},inverse:self.noop,fn:self.program(6,program6,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='\n    </ul>\n    <div class="more hidden">\n        <a href="#" class="btn-info small"><span class="icon-download"></span> '+escapeExpression((options={hash:{},data:data},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Load more",options):helperMissing.call(depth0,"__","Load more",options)))+"</a>\n    </div>\n</li>\n"},data),data:data},!(stack1=helper?helper.call(depth0,
depth0&&depth0.type,"class",options):helperMissing.call(depth0,"equal",depth0&&depth0.type,"class",options))&&0!==stack1||(buffer+=stack1),buffer+="\n\n",helper=helpers.equal||depth0&&depth0.equal,options={hash:{},inverse:self.noop,fn:self.program(8,function(depth0,data){var stack1,helper,buffer="";return buffer+='\n<li data-uri="',stack1=(helper=helpers.uri)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.uri)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'" class="instance',!(stack1=helpers.if.call(depth0,depth0&&depth0.selectable,{hash:{},inverse:self.noop,fn:self.program(2,program2,
data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+=" ",stack1=(helper=helpers.state)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.state)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'"  ',!(stack1=helpers.if.call(depth0,depth0&&depth0.accessMode,{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='>\n    <a href="#" title="',stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1
)+'">\n        <span class="icon-',stack1=(helper=helpers.icon)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.icon)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'"></span>\n        ',stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'\n        <span class="selector clickable" tabindex="0"></span>\n    </a>\n</li>\n'},data),data:data},!(stack1=helper?helper.call(depth0,depth0&&depth0.type,"instance",options):helperMissing.call(depth0,
"equal",depth0&&depth0.type,"instance",options))&&0!==stack1||(buffer+=stack1),buffer+="\n\n\n"});var defaultConfig={multiple:!0},updateCount=function($classNode,update){var count=0;$classNode&&$classNode.length&&$classNode.hasClass("class")&&(count=$classNode.data("count"),(count+=update)<0&&(count=0),$classNode.attr("data-count",count).data("count",count))};return function($container,config){var resourceTree=selectable(component({query:function(params){return this.is("loading")||this.trigger("query",_.defaults(params||{},{classUri:this.classUri})),this},update:function(nodes,params){var $root,$component,self=this;function reduceNode(acc,node){
return node.selectable=!1,self.hasNode(node.uri)||params&&0<params.offset&&"class"===node.type||"class"===node.type&&!node.state&&!self.config.selectClass?acc:("class"===node.type&&self.config.selectClass&&(node.classUri=node.uri,node.selectable=!0,node.state||(node.state="empty"),self.addNode(node.uri,_.omit(node,["count","children"]))),"instance"===node.type&&(node.selectable=!0,self.addNode(node.uri,_.omit(node,["count","children"])),node.icon=config.icon),node.children&&node.children.length&&(node.childList=reduceNodes(node.children)),acc+=function(data,options){var html=Template$1(data,options);return html}(node))}function reduceNodes(nodeList){
return _.sortBy(nodeList,function(a,b){return b.label-a.label}).reduce(reduceNode,"")}return this.is("rendered")&&($component=this.getElement(),params&&params.classUri&&($root=$$1('.class[data-uri="'+params.classUri+'"]',$component)),$root&&$root.length||($root=$component),nodes[0].uri===$root.data("uri")&&(nodes=nodes[0].children||[]),$root.children("ul").append(reduceNodes(nodes)),params&&_.isNumber(params.updateCount)&&updateCount($root,params.updateCount),function needMore($node){var $more=$node.children(".more"),totalCount=$node.data("count"),instancesCount=$node.children("ul").children(".instance").length
;0<totalCount&&0<instancesCount&&instancesCount<totalCount?hider.show($more):hider.hide($more),$node.children("ul").find(".class").each(function(){needMore($$1(this))})}($root),function indentChildren($list,level){var indent;$list.length&&(indent=15*level,level++,$list.children("li").each(function(){var $target=$$1(this);$target.children("a").css("padding-left",indent+"px"),indentChildren($target.children("ul"),level)}),$list.siblings(".more").css("padding-left",indent+"px"))}($component.children("ul"),0),$root.removeClass("closed").toggleClass("empty",!$root.children("ul").children("li").length),this.trigger("update")),this}},defaultConfig))
;return resourceTree.setTemplate(treeTpl).on("init",function(){this.classUri=this.config.classUri,this.setState("multiple",!!this.config.multiple),this.render($container)}).on("render",function(){var self=this,$component=this.getElement(),toggleClass=function($class){$class.hasClass("closed")?function($class){var node=self.getNode($class.data("uri"));$class.children("ul").children("li").length||self.query({classUri:$class.data("uri")}),node&&(node.state="open"),$class.addClass("open").removeClass("closed")}($class):function($class){var node=self.getNode($class.data("uri"));node&&(node.state="closed"),$class.removeClass("open").addClass("closed")}($class)}
;self.config.selectClass?$component.on("click",".class",function(e){var $class=$$1(e.currentTarget);e.preventDefault(),e.stopPropagation(),$$1(e.target).hasClass("class-toggler")?$class.hasClass("empty")||toggleClass($class):$class.hasClass("selected")?self.unselect($class.data("uri")):"denied"!==$class.data("access")&&self.select($class.data("uri"),!self.is("multiple"),!1,!0)}):$component.on("click",".class:not(.empty)",function(e){var $class=$$1(e.currentTarget);e.preventDefault(),e.stopPropagation(),toggleClass($class)}),$component.on("click",".instance:not([data-access=denied])",function(e){var $instance=$$1(e.currentTarget);e.preventDefault(),
e.stopPropagation(),$instance.hasClass("selected")?self.unselect($instance.data("uri")):self.select($instance.data("uri"),!self.is("multiple"))}),$component.on("click",".more",function(e){var $root=$$1(e.currentTarget).parent(".class");e.preventDefault(),e.stopPropagation(),self.query({classUri:$root.data("uri"),offset:$root.children("ul").children(".instance").length})}),this.config.nodes?this.update(this.config.nodes):this.query()}).on("query",function(){this.setState("loading",!0)}).on("update",function(){this.setState("loading",!1)}).on("remove",function(uri){var $node,$parents,$parent;this.is("rendered")&&uri&&($parents=($node=$$1('[data-uri="'+uri+'"]'
,this.getElement())).parents(".class"),$node.hasClass("instance")&&updateCount($parents,-1),1===($parent=$parents.first()).children("ul").children("li").length&&$parent.removeClass("closed").addClass("empty"),$node.remove())}),_.defer(function(){resourceTree.init(config)}),resourceTree}}),define("ui/resource/list",["jquery","lodash","ui/component","ui/resource/selectable","ui/hider","handlebars","i18n","lib/dompurify/purify"],function($$1,_,component,selectable,hider,Handlebars,__,DOMPurify){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(
context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex
,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,
component=component&&component.hasOwnProperty("default")?component.default:component,selectable=selectable&&selectable.hasOwnProperty("default")?selectable.default:selectable,hider=hider&&hider.hasOwnProperty("default")?hider.default:hider,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,__=__&&__.hasOwnProperty("default")?__.default:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],
helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",helperMissing=helpers.helperMissing,escapeExpression=this.escapeExpression;return buffer+='<div class="resource-list ',!(stack1=helpers.if.call(depth0,depth0&&depth0.multiple,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){return"multiple"},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='">\n    <ul></ul>\n    <div class="more hidden">\n        <a href="#" class="btn-info small"><span class="icon-download"></span> '+escapeExpression((options={hash:{},data:data},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Load more",
options):helperMissing.call(depth0,"__","Load more",options)))+"</a>\n    </div>\n</div>\n\n"});function listTpl(data,options,asString){var html=Template(data,options);return html}Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template$1=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<li data-uri="',stack1=(helper=helpers.uri)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.uri
)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'" ',!(stack1=helpers.if.call(depth0,depth0&&depth0.selected,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){return'class="selected"'},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+=' class="',stack1=(helper=helpers.state)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.state)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'" ',!(stack1=helpers.if.call(depth0,depth0&&depth0.accessMode,{hash:{},inverse:this.noop,fn:this.program(3,function(depth0,data){var stack1,
helper,buffer="";return buffer+='data-access="',stack1=(helper=helpers.accessMode)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.accessMode)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'"'},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='>\n    <a href="#" title="',stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'"><span class="icon-',stack1=(helper=helpers.icon)?helper.call(depth0,{hash:{},data:data}):typeof(
helper=depth0&&depth0.icon)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'"></span>',stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"</a>\n</li>\n\n"});var defaultConfig={multiple:!0};return function($container,config){var $list,$loadMore,resourceList=selectable(component({query:function(params){this.is("loading")||this.trigger("query",_.defaults(params||{},{classUri:this.classUri}))},update:function(resources){var self=this;this.is("rendered")&&(
$list.append(_.reduce(resources.nodes,function(acc,node){return node.icon=self.config.icon,acc+=function(data,options){var html=Template$1(data,options);return html}(node)},"")),_.forEach(resources.nodes,function(node){self.addNode(node.uri,node)}),resources.total>_.size(self.getNodes())?hider.show($loadMore):hider.hide($loadMore),this.trigger("update"))}},defaultConfig));return resourceList.setTemplate(listTpl).on("init",function(){this.classUri=this.config.classUri,this.setState("multiple",!!this.config.multiple),this.render($container)}).on("render",function(){var self=this,$component=this.getElement();$list=$component.children("ul"),$loadMore=$$1(".more"
,$component),$component.on("click","li",function(e){var $instance=$$1(e.currentTarget);e.preventDefault(),e.stopPropagation(),$instance.hasClass("selected")?self.unselect($instance.data("uri")):self.select($instance.data("uri"),!self.is("multiple"))}),$loadMore.on("click",function(e){e.preventDefault(),self.query({offset:_.size(self.getNodes())})}),this.config.nodes?this.update(this.config.nodes):this.query()}).on("query",function(){this.setState("loading",!0)}).on("update",function(){this.setState("loading",!1)}).on("remove",function(uri){this.is("rendered")&&$$1('[data-uri="'+uri+'"]',this.getElement()).remove()}),_.defer(function(){resourceList.init(
config)}),resourceList}}),define("css!ui/generis/validator/css/validator",[],function(){}),define("ui/generis/validator/validator",["jquery","lodash","ui/component","handlebars","i18n","lib/dompurify/purify","css!ui/generis/validator/css/validator.css"],function($$1,_,componentFactory,Handlebars,__,DOMPurify,validator_css){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,
fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment
)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,componentFactory=componentFactory&&componentFactory.hasOwnProperty("default")?componentFactory.default:componentFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default"
)?Handlebars.default:Handlebars,__=__&&__.hasOwnProperty("default")?__.default:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),'<div class="ui-generis-validator"></div>'});function tpl(data,options,asString){var html=Template(data,options);return html}return function(options){var validator;return options=options||{},(validator=componentFactory({run:function(value){
return this.errors=_(this.validations).reject(function(validation){return validation.predicate instanceof RegExp?validation.predicate.test(value):"function"==typeof validation.predicate?validation.predicate(value):void 0},this).sortBy("precedence").map(function(validation){return validation.message}).value(),this},clear:function(){return this.errors=[],this.is("rendered")&&this.getElement().empty(),this},display:function(){var $this=this.getElement();return this.is("rendered")&&($this.empty(),_.each(this.errors,function(error){$this.append($$1("<div>",{class:"validation-error"}).text(error))})),this},addValidation:function(validation){
return this.validations.push(validation),this},removeValidations:function(){return this.validations=[],this}}).setTemplate(tpl).init()).errors=[],validator.validations=options.validations||[],validator}}),define("css!ui/generis/widget/css/widget",[],function(){}),define("ui/generis/widget/widget",["lodash","i18n","ui/component","ui/generis/validator/validator","handlebars","lib/dompurify/purify","css!ui/generis/widget/css/widget.css"],function(_,__,componentFactory,generisValidatorFactory,Handlebars,DOMPurify,widget_css){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){
return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",
function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,
componentFactory=componentFactory&&componentFactory.hasOwnProperty("default")?componentFactory.default:componentFactory,generisValidatorFactory=generisValidatorFactory&&generisValidatorFactory.hasOwnProperty("default")?generisValidatorFactory.default:generisValidatorFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],data=data||{};var stack1,
helper,buffer="",helperMissing=(helpers=this.merge(helpers,Handlebars.helpers)).helperMissing,escapeExpression=this.escapeExpression;return buffer+='<label for="',stack1=(helper=helpers.uri)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.uri)?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'">\n    ',stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.label)?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"\n    ",!(stack1=helpers.if.call(depth0,depth0&&depth0.required,{hash:{},inverse:this.noop,
fn:this.program(1,function(depth0,data){var helper,options,buffer="";return buffer+='\n    <abbr title="'+escapeExpression((options={hash:{},data:data},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"This field is required",options):helperMissing.call(depth0,"__","This field is required",options)))+'">*</abbr>\n    '},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n</label>"});return Handlebars.registerPartial("ui-generis-widget-label",function(data,options,asString){var html=Template(data,options);return html}),function(options,spec){var widget;return options=options||{},(widget=componentFactory(_.assign({get:function(){
var ret=this.config.value||"";return this.is("rendered")&&(ret=this.getElement().find('[name="'+this.config.uri+'"]').val()),ret},set:function(value){return this.config.value=value,this.is("rendered")&&this.getElement().find('[name="'+this.config.uri+'"]').val(value),this.config.value},setValidator:function(validator){return"function"==typeof(validator=validator||[]).is?this.validator=validator:this.validator=generisValidatorFactory({validations:validator}),this.is("rendered")?this.validator.render(this.getElement()):this.on("render.setValidator",function(){this.validator.render(this.getElement()),this.off("render.setValidator")}),this},validate:function(){
var input;return this.validator&&(this.validator.run(this.get()),this.validator.display(),this.is("rendered")&&(input=this.getElement().find(".right > :input, .right > .check-box-input"),this.validator.errors.length?input.addClass("error"):input.removeClass("error"))),this},serialize:function(){return{name:this.config.uri,value:this.get()}}},spec),{label:__("Label"),required:!1}).on("render",function(){var $input=this.getElement().find(".right :input"),self=this;$input.on("change blur",function(){self.trigger("change",self.serialize())})})).setValidator(options.validator),widget}}),define("ui/generis/widget/checkBox/checkBox",["jquery","lodash","i18n",
"ui/generis/widget/widget","handlebars","lib/dompurify/purify"],function($$1,_,__,widgetFactory,Handlebars,DOMPurify){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment=""
;null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this
):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,widgetFactory=widgetFactory&&widgetFactory.hasOwnProperty("default")?widgetFactory.default:widgetFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,
Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing;function program2(depth0,data){return'\n                        checked="true" '}return buffer+='<div class="ui-generis-widget check-box">\n    <div class="left">\n        ',!(stack1=self.invokePartial(
partials["ui-generis-widget-label"],"ui-generis-widget-label",depth0,helpers,partials,data))&&0!==stack1||(buffer+=stack1),buffer+='\n    </div>\n    <div class="right">\n        <div class="check-box-input">\n            ',!(stack1=helpers.each.call(depth0,depth0&&depth0.range,{hash:{},inverse:self.noop,fn:self.programWithDepth(1,function(depth0,data,depth1){var stack1,helper,options,buffer="";return buffer+='\n            <div class="option">\n                <label>\n                    <input type="checkbox" name="'+escapeExpression(typeof(stack1=depth0&&depth0.uri)===functionType?stack1.apply(depth0):stack1)+'" value="'+escapeExpression(typeof(
stack1=depth0&&depth0.uri)===functionType?stack1.apply(depth0):stack1)+'" ',helper=helpers.includes||depth1&&depth1.includes,options={hash:{},inverse:self.noop,fn:self.program(2,program2,data),data:data},!(stack1=helper?helper.call(depth0,depth1&&depth1.values,depth0&&depth0.uri,options):helperMissing.call(depth0,"includes",depth1&&depth1.values,depth0&&depth0.uri,options))&&0!==stack1||(buffer+=stack1),buffer+='>\n                    <span class="icon-checkbox"></span>\n                    '+escapeExpression(typeof(stack1=depth0&&depth0.label)===functionType?stack1.apply(depth0):stack1)+"\n                </label>\n            </div>\n            "},data,
depth0),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n        </div>\n    </div>\n</div>"});function tpl(data,options,asString){var html=Template(data,options);return html}return function(options,config){var widget,validator=options.validator||[];return(widget=widgetFactory({validator:validator},{get:function(){var ret=this.config.values||[];return this.is("rendered")&&(ret=[],this.getElement().find(".option input:checked").map(function(){ret.push($$1(this).val())})),ret},set:function(values){return Array.isArray(values)?this.config.values=values:this.config.values.push(values),this.is("rendered")&&_.each(this.config.values,function(value){
this.getElement().find("input[name="+value+"]").prop("checked",!0)}),this.config.values}}).setTemplate(tpl).init({label:config.label,range:config.range||[],required:config.required||!1,uri:config.uri,values:config.values||[]})).config.required&&widget.validator.addValidation({message:__("This field is required"),predicate:function(value){return 0<value.length},precedence:1}),widget}}),define("ui/generis/widget/comboBox/comboBox",["lodash","i18n","ui/generis/widget/widget","handlebars","lib/dompurify/purify"],function(_,__,widgetFactory,Handlebars,DOMPurify){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),
hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),
fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}_=_&&_.hasOwnProperty("default")?_.default:_,
__=__&&__.hasOwnProperty("default")?__.default:__,widgetFactory=widgetFactory&&widgetFactory.hasOwnProperty("default")?widgetFactory.default:widgetFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,options,buffer="",
functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return buffer+='<div class="ui-generis-widget combo-box">\n    <div class="left">\n        ',!(stack1=this.invokePartial(partials["ui-generis-widget-label"],"ui-generis-widget-label",depth0,helpers,partials,data))&&0!==stack1||(buffer+=stack1),buffer+='\n    </div>\n    <div class="right">\n        <select name="',stack1=(helper=helpers.uri)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.uri)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'">\n            <option value="">'+escapeExpression((
options={hash:{},data:data},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Choose a value...",options):helperMissing.call(depth0,"__","Choose a value...",options)))+"</option>\n            ",!(stack1=helpers.each.call(depth0,depth0&&depth0.range,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){var stack1,buffer="";return buffer+='\n            <option value="'+escapeExpression(typeof(stack1=depth0&&depth0.uri)===functionType?stack1.apply(depth0):stack1)+'">'+escapeExpression(typeof(stack1=depth0&&depth0.label)===functionType?stack1.apply(depth0):stack1)+"</option>\n            "},data),data:data}))&&0!==stack1||(buffer+=stack1),
buffer+="\n        </select>\n    </div>\n</div>"});function tpl(data,options,asString){var html=Template(data,options);return html}return function(options,config){var widget,validator=options.validator||[];return(widget=widgetFactory({validator:validator},{}).setTemplate(tpl).init({label:config.label,range:config.range||[],required:config.required||!1,uri:config.uri,value:config.value||""})).config.required&&widget.validator.addValidation({message:__("This field is required"),predicate:/\S+/,precedence:1}),widget}}),define("ui/generis/widget/hiddenBox/hiddenBox",["lodash","i18n","ui/generis/widget/widget","handlebars","lib/dompurify/purify"],function(_,__,
widgetFactory,Handlebars,DOMPurify){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")
):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(
haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,widgetFactory=widgetFactory&&widgetFactory.hasOwnProperty("default")?widgetFactory.default:widgetFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(
helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",escapeExpression=this.escapeExpression;return buffer+='<div class="ui-generis-widget hidden-box">\n    <div class="left">\n        ',!(stack1=this.invokePartial(partials["ui-generis-widget-label"],"ui-generis-widget-label",depth0,helpers,partials,data))&&0!==stack1||(buffer+=stack1),buffer+='\n    </div>\n    <div class="right">\n        <input name="',buffer+=escapeExpression(stack1=(helper=helpers.uri)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.uri)?helper.call(depth0,{hash:{},data:data}):helper
)+'" type="password">\n    </div>\n</div>\n\n<div class="ui-generis-widget hidden-box confirmation">\n    <div class="left">\n        ',!(stack1=this.invokePartial(partials["ui-generis-widget-label"],"ui-generis-widget-label",depth0&&depth0.confirmation,helpers,partials,data))&&0!==stack1||(buffer+=stack1),buffer+='\n    </div>\n    <div class="right">\n        <input name="'+escapeExpression("function"==typeof(stack1=null==(stack1=depth0&&depth0.confirmation)||!1===stack1?stack1:stack1.uri)?stack1.apply(depth0):stack1)+'" type="password">\n    </div>\n</div>'});function tpl(data,options,asString){var html=Template(data,options);return html}return function(
options,config){var widget,validator=options.validator||[];return(widget=widgetFactory({validator:validator},{get:function(){var $el,ret={value:this.config.value,confirmation:this.config.confirmation.value};return this.is("rendered")&&($el=this.getElement(),ret.value=$el.find('[name="'+this.config.uri+'"]').val(),ret.confirmation=$el.find('[name="'+this.config.confirmation.uri+'"]').val()),ret},set:function(value){var $el;return this.config.value=this.config.confirmation.value=value,this.is("rendered")&&(($el=this.getElement()).find('[name="'+this.config.uri+'"]').val(value),$el.find('[name="'+this.config.confirmation.uri+'"]').val(value)),{
value:this.config.value,confirmation:this.config.confirmation.value}},serialize:function(){return{name:this.config.uri,value:this.get().value}}}).setTemplate(tpl).init({confirmation:{label:__("%s Confirmation",config.label),uri:config.uri+"_confirmation",value:config.value||""},label:config.label,required:config.required||!1,uri:config.uri,value:config.value||""})).config.required&&widget.validator.addValidation({message:__("This field is required"),predicate:function(value){return/\S+/.test(value.value)},precedence:1}),widget.validator.addValidation({message:__("Fields must match"),predicate:function(value){return value.value===value.confirmation},
precedence:2}),widget}}),define("ui/generis/widget/textBox/textBox",["lodash","i18n","ui/generis/widget/widget","handlebars","lib/dompurify/purify"],function(_,__,widgetFactory,Handlebars,DOMPurify){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,
key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){
return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,widgetFactory=widgetFactory&&widgetFactory.hasOwnProperty("default")?widgetFactory.default:widgetFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(
Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),partials=this.merge(partials,Handlebars.partials),data=data||{};var stack1,helper,buffer="",escapeExpression=this.escapeExpression;return buffer+='<div class="ui-generis-widget text-box">\n    <div class="left">\n        ',!(stack1=this.invokePartial(partials["ui-generis-widget-label"],"ui-generis-widget-label",depth0,helpers,partials,data))&&0!==stack1||(buffer+=stack1),buffer+='\n    </div>\n    <div class="right">\n        <input name="',
buffer+=escapeExpression(stack1=(helper=helpers.uri)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.uri)?helper.call(depth0,{hash:{},data:data}):helper)+'" value="',buffer+=escapeExpression(stack1=(helper=helpers.value)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.value)?helper.call(depth0,{hash:{},data:data}):helper)+'">\n    </div>\n</div>'});function tpl(data,options,asString){var html=Template(data,options);return html}return function(options,config){var widget,validator=options.validator||[];return(widget=widgetFactory({validator:validator},{}).setTemplate(tpl).init({
label:config.label,required:config.required||!1,uri:config.uri,value:config.value||""})).config.required&&widget.validator.addValidation({message:__("This field is required"),predicate:/\S+/,precedence:1}),widget}}),define("ui/generis/widget/loader",["lodash","ui/generis/widget/checkBox/checkBox","ui/generis/widget/comboBox/comboBox","ui/generis/widget/hiddenBox/hiddenBox","ui/generis/widget/textBox/textBox"],function(_,checkBoxFactory,comboBoxFactory,hiddenBoxFactory,textBoxFactory){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,checkBoxFactory=checkBoxFactory&&checkBoxFactory.hasOwnProperty("default")?checkBoxFactory.default:checkBoxFactory,
comboBoxFactory=comboBoxFactory&&comboBoxFactory.hasOwnProperty("default")?comboBoxFactory.default:comboBoxFactory,hiddenBoxFactory=hiddenBoxFactory&&hiddenBoxFactory.hasOwnProperty("default")?hiddenBoxFactory.default:hiddenBoxFactory,textBoxFactory=textBoxFactory&&textBoxFactory.hasOwnProperty("default")?textBoxFactory.default:textBoxFactory;var _widgetFactories={"http://www.tao.lu/datatypes/WidgetDefinitions.rdf#CheckBox":checkBoxFactory,"http://www.tao.lu/datatypes/WidgetDefinitions.rdf#ComboBox":comboBoxFactory,"http://www.tao.lu/datatypes/WidgetDefinitions.rdf#StateWidget":comboBoxFactory,
"http://www.tao.lu/datatypes/WidgetDefinitions.rdf#HiddenBox":hiddenBoxFactory,"http://www.tao.lu/datatypes/WidgetDefinitions.rdf#TextBox":textBoxFactory};return function(uri){return uri&&_.contains(Object.keys(_widgetFactories),uri)?_widgetFactories[uri]:_widgetFactories["http://www.tao.lu/datatypes/WidgetDefinitions.rdf#TextBox"]}}),define("css!ui/generis/form/css/form",[],function(){}),define("ui/generis/form/form",["lodash","i18n","ui/component","ui/generis/widget/loader","ui/generis/widget/checkBox/checkBox","ui/generis/widget/comboBox/comboBox","ui/generis/widget/hiddenBox/hiddenBox","ui/generis/widget/textBox/textBox","handlebars",
"lib/dompurify/purify","css!ui/generis/form/css/form.css"],function(_,__,componentFactory,widgetLoader,checkBox,comboBox,hiddenBox,textBox,Handlebars,DOMPurify,form_css){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment=""
;null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this
):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,componentFactory=componentFactory&&componentFactory.hasOwnProperty("default")?componentFactory.default:componentFactory,widgetLoader=widgetLoader&&widgetLoader.hasOwnProperty("default")?widgetLoader.default:widgetLoader,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,
DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression;return buffer+='<div class="ui-generis-form">\n    <h2>',stack1=(helper=helpers.title)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.title)===functionType?helper.call(depth0,{hash:{},data:data}):helper,
buffer+=escapeExpression(stack1)+'</h2>\n    <form action="',stack1=(helper=helpers.formAction)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.formAction)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'" method="',stack1=(helper=helpers.formMethod)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.formMethod)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'">\n        <fieldset></fieldset>\n        <div class="toolbar">\n            ',!(stack1=helpers.if.call(depth0,depth0&&depth0.reset,{hash:{},inverse:this.noop,
fn:this.program(1,function(depth0,data){var stack1,helper,buffer="";return buffer+='\n            <button type="reset" class="btn-neutral small">\n                <span class="icon-reset"/> ',stack1=(helper=helpers.resetText)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.resetText)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"\n            </button>\n            "},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='\n            <button type="submit" class="btn-info small">\n                <span class="icon-save"/> ',stack1=(helper=helpers.submitText)?helper.call(depth0,{
hash:{},data:data}):typeof(helper=depth0&&depth0.submitText)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"\n            </button>\n        </div>\n    </form>\n</div>\n"});function tpl(data,options,asString){var html=Template(data,options);return html}return function(options,config){var form;return options=options||{},(config=config||{}).form=config.form||{},config.submit=config.submit||{},(form=componentFactory({addWidget:function(widgetOptions){var widget=widgetLoader(widgetOptions.widget)({},widgetOptions);return this.widgets.push(widget),this.is("rendered")?widget.render(this.getElement().find(
"form > fieldset")):this.on("render."+widget.config.uri,function(){widget.render(this.getElement().find("form > fieldset")),this.off("render."+this.config.uri)}),this},getWidget:function(uri){return _.find(this.widgets,function(widget){return widget.config.uri===uri})},removeWidget:function(uri){return _.remove(this.widgets,function(widget){if(widget.config.uri===uri)return widget.destroy(),!0}),this},validate:function(){return this.errors=_(this.widgets).map(function(widget){return widget.validate(),{uri:widget.config.uri,errors:widget.validator.errors}}).reject(function(data){return!data.errors||0===data.errors.length}).value(),this},
serializeArray:function(){return _.map(this.widgets,function(widget){return widget.serialize()})},getValues:function(){return _.reduce(this.serializeArray(),function(acc,field){return(_.isString(field.name)&&!_.isEmpty(field.name)&&_.isString(field.value)&&!_.isEmpty(field.value)||_.isArray(field.value)&&0<field.value.length)&&(acc[field.name]=field.value),acc},{})},toggleLoading:function(isLoading){return void 0===isLoading&&(isLoading=!this.is("loading")),isLoading?(this.trigger("loading"),this.disable()):(this.trigger("loaded"),this.enable()),this.setState("loading",isLoading),this}},{formAction:"#",formMethod:"get",submitText:__("Save"),title:__(
"Generis Form"),reset:!0,resetText:__("Reset")}).setTemplate(tpl).init(config).on("render",function(){var $form=this.getElement().find("form"),self=this;$form.on("submit",function(e){return e.preventDefault(),self.trigger("submit",self.serializeArray()),!1}),$form.on("reset",function(){self.trigger("reset",self.serializeArray())})})).data=options,form.errors=[],form.widgets=[],_.each(options.properties||[],function(property){property.range&&"string"==typeof property.range&&(property.range=options.values[property.range]),form.addWidget(property)}),form}}),define("ui/resource/filters",["lodash","i18n","ui/component","ui/generis/form/form","handlebars",
"lib/dompurify/purify"],function(_,__,component,generisFormFactory,Handlebars,DOMPurify){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment=""
;null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this
):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,component=component&&component.hasOwnProperty("default")?component.default:component,generisFormFactory=generisFormFactory&&generisFormFactory.hasOwnProperty("default")?generisFormFactory.default:generisFormFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,
DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){return this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),'<div class="filters">\n</div>\n'});function filtersTpl(data,options,asString){var html=Template(data,options);return html}var supportedWidgets=["http://www.tao.lu/datatypes/WidgetDefinitions.rdf#TextBox","http://www.tao.lu/datatypes/WidgetDefinitions.rdf#CheckBox","http://www.tao.lu/datatypes/WidgetDefinitions.rdf#ComboBox",
"http://www.tao.lu/datatypes/WidgetDefinitions.rdf#TextArea","http://www.tao.lu/datatypes/WidgetDefinitions.rdf#StateWidget"],defaultConfig={title:__("Search by properties"),applyLabel:__("Apply")};return function($container,config){var filters=component({getValues:function(){return this.is("rendered")&&this.form?this.form.getValues():null},setValue:function(uri,value){var widget;return this.is("rendered")&&this.form&&(widget=this.form.getWidget(uri))&&widget.set(value),this},reset:function(){return this.update(this.config.data)},update:function(data){var properties,self=this;return this.is("rendered")&&(this.getElement().empty(),properties=_.filter(
data.properties,function(property){return _.contains(supportedWidgets,property.widget)}),this.form=generisFormFactory({properties:properties,values:data.ranges},{submitText:this.config.applyLabel,title:this.config.title}).on("submit reset",function(){self.trigger("change",this.getValues())}).render(this.getElement())),this},getTextualQuery:function(){var result,self=this;return this.is("rendered")&&(result=_.reduce(this.form.getValues(),function(acc,value,uri){var displayValue,widget=self.form.getWidget(uri);return widget&&(_.isEmpty(acc)||(acc+=__(" AND ")),acc+=widget.config.label+__(" is "),displayValue=widget.config.range?_.map(_.isArray(value)?value:[
value],function(val){var selectedValue=_.find(widget.config.range,{uri:val});return selectedValue&&selectedValue.label}):value,_.isString(displayValue)&&(acc+=displayValue),_.isArray(displayValue)&&(acc+=displayValue.join(", "))),acc},"")),result}},defaultConfig);return filters.setTemplate(filtersTpl).on("init",function(){this.render($container)}).on("render",function(){this.config.data&&this.update(this.config.data)}),_.defer(function(){filters.init(config)}),filters}}),define("css!ui/resource/css/selector",[],function(){}),define("ui/resource/selector",["jquery","lodash","i18n","ui/component","ui/hider","ui/class/selector","ui/resource/tree",
"ui/resource/list","ui/resource/filters","handlebars","lib/dompurify/purify","css!ui/resource/css/selector.css"],function($$1,_,__,component,hider,classesSelectorFactory,treeFactory,listFactory,filtersFactory,Handlebars,DOMPurify,selector_css){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",
wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),
hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,component=component&&component.hasOwnProperty("default")?component.default:component,hider=hider&&hider.hasOwnProperty("default")?hider.default:hider,
classesSelectorFactory=classesSelectorFactory&&classesSelectorFactory.hasOwnProperty("default")?classesSelectorFactory.default:classesSelectorFactory,treeFactory=treeFactory&&treeFactory.hasOwnProperty("default")?treeFactory.default:treeFactory,listFactory=listFactory&&listFactory.hasOwnProperty("default")?listFactory.default:listFactory,filtersFactory=filtersFactory&&filtersFactory.hasOwnProperty("default")?filtersFactory.default:filtersFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(
Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",functionType="function",escapeExpression=this.escapeExpression,self=this,helperMissing=helpers.helperMissing;function program4(depth0,data){var stack1,helper,buffer="";return buffer+='\n        <a href="#" data-view-format="'+escapeExpression(typeof(stack1=null==data||!1===data?data:data.key)===functionType?stack1.apply(depth0):stack1)+'" ',!(stack1=helpers.if.call(depth0,depth0&&depth0.active,{hash:{},
inverse:self.noop,fn:self.program(5,program5,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+=" ",!(stack1=helpers.if.call(depth0,depth0&&depth0.title,{hash:{},inverse:self.noop,fn:self.program(7,program7,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='><span class="',stack1=(helper=helpers.icon)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.icon)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'"></span></a>\n        '}function program5(depth0,data){return'class="active"'}function program7(depth0,data){var stack1,helper,buffer="";return buffer+='title="',stack1=(
helper=helpers.title)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.title)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'"'}function program10(depth0,data){var helper,options,buffer="";return buffer+='\n            <a href="#" class="filters-opener" title="'+escapeExpression((options={hash:{},data:data},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Advanced search, add filters",options):helperMissing.call(depth0,"__","Advanced search, add filters",options)))+'"><span class="icon-add"></span></a>\n            '}function program12(depth0,data){return"hidden"}
function program14(depth0,data){return'\n        <div class="filters-container folded"></div>\n        '}return buffer+='<div class="resource-selector ',!(stack1=helpers.if.call(depth0,depth0&&depth0.multiple,{hash:{},inverse:self.noop,fn:self.program(1,function(depth0,data){return"multiple"},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='">\n\n    ',!(stack1=helpers.if.call(depth0,depth0&&depth0.showContext,{hash:{},inverse:self.noop,fn:self.program(3,function(depth0,data){var stack1,buffer="";return buffer+='\n    <nav class="context">\n        <div class="class-context"></div>\n        ',!(stack1=helpers.each.call(depth0,depth0&&depth0.formats,
{hash:{},inverse:self.noop,fn:self.program(4,program4,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n    </nav>\n    "},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n\n    ",!(stack1=helpers.if.call(depth0,depth0&&depth0.showSelection,{hash:{},inverse:self.noop,fn:self.program(9,function(depth0,data){var stack1,helper,options,buffer="";return buffer+='\n    <nav class="selection">\n        <div class="search">\n            <input type="text" placeholder="',stack1=(helper=helpers.searchPlaceholder)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.searchPlaceholder)===functionType?helper.call(depth0,{hash:{},
data:data}):helper,buffer+=escapeExpression(stack1)+'" />\n            ',!(stack1=helpers.if.call(depth0,depth0&&depth0.filters,{hash:{},inverse:self.noop,fn:self.program(10,program10,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='\n        </div>\n        <div class="selection-control">\n            <a href="#" class="selection-toggle ',!(stack1=helpers.unless.call(depth0,depth0&&depth0.switchMode,{hash:{},inverse:self.noop,fn:self.program(12,program12,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='" title="'+escapeExpression((options={hash:{},data:data},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,
"Toggle multiple/single selection",options):helperMissing.call(depth0,"__","Toggle multiple/single selection",options)))+'">\n                <span class="icon-multi-select"></span>\n            </a>\n            <label class="selection-indicator ',!(stack1=helpers.unless.call(depth0,depth0&&depth0.multiple,{hash:{},inverse:self.noop,fn:self.program(12,program12,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='">\n                <input type="checkbox">\n                <span class="icon-checkbox"></span>\n            </label>\n        </div>\n        ',!(stack1=helpers.if.call(depth0,depth0&&depth0.filters,{hash:{},inverse:self.noop,
fn:self.program(14,program14,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n    </nav>\n    "},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='\n\n    <main>\n        <span class="hidden no-results">',stack1=(helper=helpers.noResultsText)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.noResultsText)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"</span>\n    </main>\n\n    ",!(stack1=helpers.if.call(depth0,depth0&&depth0.multiple,{hash:{},inverse:self.noop,fn:self.program(16,function(depth0,data){var stack1,helper,options,buffer=""
;return buffer+='\n    <footer>\n        <div class="get-selection">\n           <span>'+escapeExpression((options={hash:{},data:data},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Selected",options):helperMissing.call(depth0,"__","Selected",options)))+" ",stack1=(helper=helpers.type)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.type)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+' : </span><span class="selected-num">0</span>\n        </div>\n    </footer>\n    '},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n</div>\n"});function selectorTpl(data,options,
asString){var html=Template(data,options);return html}var labelUri="http://www.w3.org/2000/01/rdf-schema#label",nodeTypes={instance:"instance",class:"class"},selectionModes={single:"single",multiple:"multiple",both:"both"},selectAllPolicies={all:"all",loaded:"loaded",visible:"visible"},defaultConfig={type:__("resources"),noResultsText:_("No resources found"),searchPlaceholder:__("Search"),icon:"item",selectionMode:selectionModes.single,selectClass:!1,selectAllPolicy:selectAllPolicies.loaded,filters:!1,showContext:!0,showSelection:!0,formats:{list:{icon:"icon-ul",title:__("View resources as a list"),componentFactory:listFactory},tree:{icon:"icon-tree",
title:__("View resources as a tree"),componentFactory:treeFactory,active:!0}},limit:30},resourceSelectorFactory=function($container,config){var $classContainer,$resultArea,$noResults,$searchField,$viewFormats,$selectNum,$selectCtrl,$selectCtrlLabel,$filterToggle,$filterContainer,$selectionToggle,resourceSelector=component({empty:function(){return this.is("rendered")&&this.selectionComponent&&(this.selectionComponent.destroy(),this.selectionComponent=null),this.trigger("empty")},reset:function(){return this.is("rendered")&&(this.empty(),this.searchQuery={},this.config.filters&&(this.filtersComponent&&this.filtersComponent.reset(),$searchField.val("").attr(
"title",null).attr("placeholder",this.config.searchPlaceholder))),this.trigger("reset")},getSelection:function(){return this.selectionComponent?this.selectionComponent.getSelection():null},clearSelection:function(){return this.selectionComponent&&this.selectionComponent.clearSelection(),this},setSearchQuery:function(query){return this.searchQuery={},this.searchQuery[labelUri]="",_.isString(query)&&!_.isEmpty(query)&&(this.searchQuery[labelUri]=query),_.isPlainObject(query)&&(this.searchQuery=query),this},getSearchQuery:function(){return 0===_.size(this.searchQuery)&&(this.searchQuery[labelUri]=""),this.searchQuery},query:function(params){var defaultParams,
search;return this.is("rendered")&&!this.is("loading")&&(this.setState("loading",!0),params=params||{},search=this.getSearchQuery(),defaultParams={classUri:this.classUri,format:this.format,limit:this.config.limit,search:_.isObject(search)?JSON.stringify(search):""},this.trigger("query",_.defaults(params,defaultParams))),this},changeFormat:function(format){var $viewFormat;return this.is("rendered")&&this.format!==format&&(1!==($viewFormat=$viewFormats.filter('[data-view-format="'+format+'"]')).length||$viewFormat.hasClass("active")||($viewFormats.removeClass("active"),$viewFormat.addClass("active"),this.empty(),this.format=format,this.trigger("formatchange",
format))),this},changeSelectionMode:function(newMode){return this.is("rendered")&&this.config.selectionMode!==newMode&&selectionModes[newMode]&&(this.config.multiple&&this.clearSelection(),this.config.multiple=newMode===selectionModes.multiple,this.selectionComponent.setState("multiple",this.config.multiple),this.setState("multiple",this.config.multiple),this.config.multiple?hider.show($selectCtrlLabel):hider.hide($selectCtrlLabel),this.trigger("selectionmodechange",newMode)),this},update:function(resources,params){var componentFactory,self=this;if(this.is("rendered")&&this.format){if(
componentFactory=this.config.formats[this.format]&&this.config.formats[this.format].componentFactory,!_.isFunction(componentFactory))return this.trigger("error",new TypeError("Unable to load the component for the format "+this.format));hider.hide($noResults),params.updateClasses&&this.classSelector&&this.classSelector.updateNodes(function filterClasses(resources){return _(resources).filter({type:nodeTypes.class}).map(function(resource){var classNode=_.pick(resource,["uri","label","state"]);return resource.children&&(classNode.children=filterClasses(resource.children)),classNode}).value()}(resources)),this.selectionComponent?this.selectionComponent.update(
resources,params):this.selectionComponent=componentFactory($resultArea,_.defaults({classUri:this.classUri,nodes:resources},this.config)).on("query",function(queryParams){self.query(queryParams)}).on("update",function(){0===_.size(this.getNodes())&&0===$$1("li",$resultArea).length&&hider.show($noResults),self.trigger("update")}).on("change",function(selected,onlyVisible){self.trigger("change",selected,onlyVisible)}).on("error",function(err){self.trigger("error",err)}),this.setState("loading",!1)}return this},updateFilters:function(filterConfig){return this.is("rendered")&&!1!==filterConfig&&this.filtersComponent&&this.filtersComponent.update(filterConfig),
this},removeNode:function(node){var uri=_.isString(node)?node:node.uri;return this.hasNode(uri)&&(this.getNodeType(node)===nodeTypes.class&&this.classSelector&&this.classSelector.removeNode(node),this.selectionComponent.removeNode(uri)),this},addNode:function(node,parentUri){return this.is("rendered")&&node&&node.uri&&this.selectionComponent&&(this.selectionComponent.hasNode(node.uri)||(node.type||(node.type=nodeTypes.instance),this.selectionComponent.update([node],{classUri:parentUri||this.classUri,format:this.format,limit:this.config.limit,updateCount:node.type===nodeTypes.instance&&1}),this.getNodeType(node
)===nodeTypes.class&&this.classSelector&&this.classSelector.addNode(node,parentUri))),this},hasNode:function(node){var uri;return!!(node&&this.is("rendered")&&this.selectionComponent)&&(uri=_.isString(node)?node:node.uri,this.selectionComponent.hasNode(uri))},getNodeType:function(node){var uri,foundNode;return!!(node&&this.is("rendered")&&this.selectionComponent)&&(uri=_.isString(node)?node:node.uri,(foundNode=this.selectionComponent.getNode(uri))&&foundNode.type)},select:function(node){var uri=_.isString(node)?node:node.uri;return this.hasNode(uri)&&(this.is("multiple")||this.selectionComponent.clearSelection(),this.selectionComponent.select(uri),$$1(
'[data-uri="'+uri+'"]',$resultArea)[0].scrollIntoView({behavior:"smooth"})),this},selectDefaultNode:function(node,fallback){var $resource;return this.is("rendered")&&(this.hasNode(node)?this.select(node):!1!==fallback&&(($resource=this.getElement().find("."+nodeTypes.instance)).length||($resource=this.getElement().find("."+nodeTypes.class)),$resource.length&&this.select($resource.first().data("uri")))),this},refresh:function(node){var queryParams={updateClasses:!0};return this.is("rendered")&&(this.on("update.refresh",function(){this.off("update.refresh"),this.selectDefaultNode(node)}),node&&node.uri&&(queryParams.selectedUri=node.uri),this.reset().query(
queryParams)),this}},defaultConfig).setTemplate(selectorTpl).on("init",function(){this.searchQuery={},this.classUri=this.config.classUri,this.format=this.config.format||_.findKey(this.config.formats,{active:!0}),this.config.switchMode=this.config.selectionMode===selectionModes.both,this.config.multiple=this.config.selectionMode===selectionModes.multiple,this.setState("multiple",this.config.multiple),this.render($container)}).on("render",function(){var self=this;return new Promise(function(resolve){var $component=self.getElement();$classContainer=$$1(".class-context",$component),$resultArea=$$1("main",$component),$noResults=$$1(".no-results",$resultArea),
$searchField=$$1(".search input",$component),$filterToggle=$$1(".filters-opener",$component),$filterContainer=$$1(".filters-container",$component),$viewFormats=$$1(".context > a",$component),$selectNum=$$1(".selected-num",$component),$selectCtrl=$$1(".selection-control input",$component),$selectCtrlLabel=$$1(".selection-control label",$component),$selectionToggle=$$1(".selection-toggle",$component),$searchField.on("keyup",_.debounce(function(e){var value=$$1(this).val().trim();(2<value.length||0===value.length||13===e.which)&&(self.config.filters&&$$1(this).attr("title",null).attr("placeholder",self.config.searchPlaceholder),self.empty().changeFormat("list"
).setSearchQuery(value).query())},300)),$viewFormats.on("click",function(e){var format=$$1(this).data("view-format");e.preventDefault(),self.reset().changeFormat(format).query()}),self.config.selectionMode===selectionModes.both&&($selectionToggle.on("click",function(e){e.preventDefault(),self.changeSelectionMode(self.config.multiple?selectionModes.single:selectionModes.multiple)}),$resultArea.on("mousedown",function(e){e.ctrlKey&&!self.config.multiple&&self.changeSelectionMode(selectionModes.multiple)}),$resultArea.on("click",function(){self.changeSelectionMode(selectionModes.single)})),$selectCtrl.on("change",function(){!1===$$1(this).prop("checked"
)?self.selectionComponent.clearSelection():self.config.selectAllPolicy===selectAllPolicies.visible?self.selectionComponent.selectVisible():self.config.selectAllPolicy===selectAllPolicies.loaded&&self.selectionComponent.selectAll()}),!1!==self.config.filters&&(self.filtersComponent=filtersFactory($filterContainer,{classUri:self.classUri,data:self.config.filters}).on("change",function(values){var textualQuery=this.getTextualQuery();$searchField.val("").attr("title",textualQuery).attr("placeholder",textualQuery),self.empty().changeFormat("list").setSearchQuery(values).query(),$filterContainer.addClass("folded")}),$filterToggle.on("click",function(e){
var searchVal;e.preventDefault(),$filterContainer.hasClass("folded")?(searchVal=$searchField.val().trim(),_.isEmpty(searchVal)||self.filtersComponent.setValue(labelUri,searchVal),$filterContainer.removeClass("folded")):$filterContainer.addClass("folded")})),self.classSelector=classesSelectorFactory($classContainer,self.config),self.classSelector.on("render",resolve).on("change",function(uri){uri&&uri!==self.classUri&&(self.classUri=uri,$filterContainer.length&&$filterContainer.addClass("folded"),self.trigger("classchange",uri),self.reset().query())}),self.query()})}).on("change",function(selected,onlyVisible){var selectedCount=_.size(selected),
nodesCount=onlyVisible?selectedCount:_.size(this.selectionComponent.getNodes());$selectNum.text(selectedCount),0===selectedCount?($selectCtrlLabel.attr("title",__("Select loaded %s",this.config.type)),$selectCtrl.prop("checked",!1).prop("indeterminate",!1)):nodesCount<=selectedCount?($selectCtrlLabel.attr("title",__("Clear selection")),$selectCtrl.prop("checked",!0).prop("indeterminate",!1)):($selectCtrlLabel.attr("title",__("Select loaded %s",this.config.type)),$selectCtrl.prop("checked",!1).prop("indeterminate",!0))});return _.defer(function(){resourceSelector.init(config)}),resourceSelector};return resourceSelectorFactory.selectionModes=selectionModes,
resourceSelectorFactory.selectAllPolicies=selectAllPolicies,resourceSelectorFactory.nodeTypes=nodeTypes,resourceSelectorFactory}),define("css!ui/loadingButton/css/button",[],function(){}),define("ui/loadingButton/loadingButton",["lodash","ui/component","handlebars","i18n","lib/dompurify/purify","css!ui/loadingButton/css/button.css"],function(_,component,Handlebars,__,DOMPurify,button_css){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[]
;return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),
increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}_=_&&_.hasOwnProperty("default")?_.default:_,component=component&&component.hasOwnProperty("default")?component.default:component,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,
__=__&&__.hasOwnProperty("default")?__.default:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var helper,buffer="",escapeExpression=this.escapeExpression;return buffer+='<button class="loading-button btn-',buffer+=escapeExpression((helper=helpers.type)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.type)?helper.call(depth0,{hash:{},
data:data}):helper)+' small" type="button" title="',buffer+=escapeExpression((helper=helpers.title)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.title)?helper.call(depth0,{hash:{},data:data}):helper)+'">\n    <span class="spinner-icon icon-loop spinning"></span>\n    <span class="start-icon icon-',buffer+=escapeExpression((helper=helpers.icon)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.icon)?helper.call(depth0,{hash:{},data:data}):helper)+'"></span>\n    <span class="action-label">',buffer+=escapeExpression((helper=helpers.label)?helper.call(depth0,{hash:{},data:data}
):"function"==typeof(helper=depth0&&depth0.label)?helper.call(depth0,{hash:{},data:data}):helper)+'</span>\n    <span class="terminated-label">',buffer+=escapeExpression((helper=helpers.terminatedLabel)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.terminatedLabel)?helper.call(depth0,{hash:{},data:data}):helper)+"</span>\n</button>"});function buttonTpl(data,options,asString){var html=Template(data,options);return html}var _defaults={type:"info",icon:"property-advanced",title:"",label:"OK",terminatedLabel:"FINISHED"},buttonApi={start:function(){this.setState("started",!0),this.trigger("started")},terminate:function(){
return this.is("started")&&(this.setState("started",!1),this.setState("terminated",!0),this.disable(),this.trigger("terminated")),this},reset:function(){return this.is("terminated")&&(this.setState("terminated",!1),this.enable(),this.trigger("reset")),this}};return function(config){var initConfig=_.defaults(config||{},_defaults);return component(buttonApi).setTemplate(buttonTpl).on("enable",function(){this.getElement().removeProp("disabled")}).on("disable",function(){this.getElement().prop("disabled",!0)}).on("render",function(){var self=this;this.getElement().on("click",function(e){e.preventDefault(),self.is("disabled")||self.is("started")||self.is(
"terminated")||self.start()})}).init(initConfig)}}),define("ui/report",["jquery","lodash","ui/component","handlebars","i18n","lib/dompurify/purify"],function($$1,_,component,Handlebars,__,DOMPurify){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,
key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){
return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,component=component&&component.hasOwnProperty("default")?component.default:component,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,__=__&&__.hasOwnProperty("default")?__.default:__,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default"
)?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],data=data||{};var stack1,helper,buffer="",helperMissing=(helpers=this.merge(helpers,Handlebars.helpers)).helperMissing,escapeExpression=this.escapeExpression;return buffer+='<div class="component-report',!(stack1=helpers.if.call(depth0,depth0&&depth0.noBorder,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){return" no-border"},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='">\n    ',!(stack1=helpers.if.call(depth0,
depth0&&depth0.detailsButtonVisible,{hash:{},inverse:this.noop,fn:this.program(3,function(depth0,data){var helper,options,buffer="";return buffer+='\n    <label class="fold pseudo-label-box">\n        <span class="check-txt hide">'+escapeExpression((options={hash:{},data:data},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Hide detailed report",options):helperMissing.call(depth0,"__","Hide detailed report",options)))+'</span>\n        <span class="check-txt show">'+escapeExpression((options={hash:{},data:data},(helper=helpers.__||depth0&&depth0.__)?helper.call(depth0,"Show detailed report",options):helperMissing.call(depth0,"__",
"Show detailed report",options)))+'</span>\n        <input type="checkbox"/>\n        <span class="icon-checkbox"></span>\n    </label>\n    '},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='\n    <div class="content">',stack1=(helper=helpers.content)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.content)?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"</div>\n</div>"});function layoutTpl(data,options,asString){var html=Template(data,options);return html}Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template$1=Handlebars.template(function(Handlebars,
depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,options,buffer="",functionType="function",escapeExpression=this.escapeExpression,helperMissing=helpers.helperMissing;return buffer+='<div class="feedback-',stack1=(helper=helpers.type)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.type)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+" ",!(stack1=helpers.if.call(depth0,depth0&&depth0.hasChildren,{hash:{},inverse:this.program(3,function(depth0,data){return"leaf"},data),fn:this.program(1,function(
depth0,data){return"hierarchical"},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='">\n    <span class="icon-',stack1=(helper=helpers.type)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.type)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1),!(stack1=helpers.if.call(depth0,depth0&&depth0.hasChildren,{hash:{},inverse:this.noop,fn:this.program(5,function(depth0,data){return" hierarchical-icon"},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='"></span>\n    <div class="message">',options={hash:{},data:data},!(stack1=(helper=helpers.dompurify||depth0&&depth0.dompurify
)?helper.call(depth0,depth0&&depth0.message,options):helperMissing.call(depth0,"dompurify",depth0&&depth0.message,options))&&0!==stack1||(buffer+=stack1),buffer+="</div>\n    ",!(stack1=helpers.each.call(depth0,depth0&&depth0.children,{hash:{},inverse:this.noop,fn:this.program(7,function(depth0,data){var stack1,buffer="";return buffer+="\n        ",!(stack1=typeof depth0===functionType?depth0.apply(depth0):depth0)&&0!==stack1||(buffer+=stack1),buffer+="\n    "},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='\n    <div class="actions">\n        ',!(stack1=helpers.each.call(depth0,depth0&&depth0.actions,{hash:{},inverse:this.noop,fn:this.program(9,
function(depth0,data){var stack1,helper,buffer="";return buffer+='\n        <button data-trigger="',stack1=(helper=helpers.id)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.id)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'" class="action btn-info" title="',stack1=(helper=helpers.title)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.title)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'"><span class="icon-',stack1=(helper=helpers.icon)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.icon
)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+'"></span>',stack1=(helper=helpers.label)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.label)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"</button>\n        "},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n    </div>\n</div>"});function _renderFeebacks(data,actions){var children=[];if(!data.type||-1===authorizedTypes.indexOf(data.type))throw new TypeError("Unkown report type: "+data.type);return _.isArray(data.children)&&data.children.length&&_.each(data.children,function(
child){children.push(_renderFeebacks(child))}),data.hasChildren=0<children.length,data.children=children,data.actions=actions,function(data,options){var html=Template$1(data,options);return html}(data)}var _defaults={showDetailsButton:!0,actions:[]},authorizedTypes=["success","info","warning","error"],report={isDetailed:function(){return this.is("detailed")},showDetails:function(){return this.is("rendered")&&(this.setState("detailed",!0),this.getElement().find(".fold input").prop("checked",!0),this.trigger("showDetails")),this},hideDetails:function(){return this.is("rendered")&&(this.setState("detailed"),this.getElement().find(".fold input").prop("checked",
!1),this.trigger("hideDetails")),this}};return function(config,data){var initConfig=_.defaults(config||{},_defaults);return data&&_.isArray(data.children)&&data.children.length&&(initConfig.detailsButtonVisible=initConfig.showDetailsButton),component(report).setTemplate(layoutTpl).on("render",function(){var self=this,$content=this.getElement().find(".content"),$checkbox=this.getElement().find(".fold input");$content.append(_renderFeebacks(_.cloneDeep(data),this.config.actions)),$content.on("click",".action",function(){var actionId=$$1(this).data("trigger");self.trigger("action-"+actionId),self.trigger("action",actionId)}),$checkbox.on("change",_.throttle(
function(){self.isDetailed()?self.hideDetails():self.showDetails()},100))}).init(initConfig)}}),define("css!ui/taskQueueButton/css/taskable",[],function(){}),define("ui/taskQueueButton/taskable",["jquery","lodash","i18n","ui/report","ui/feedback","layout/loading-bar","handlebars","lib/dompurify/purify","css!ui/taskQueueButton/css/taskable.css"],function($$1,_,__,reportFactory,feedback,loadingBar,Handlebars,DOMPurify,taskable_css){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,
fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex)
,stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle))return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,
reportFactory=reportFactory&&reportFactory.hasOwnProperty("default")?reportFactory.default:reportFactory,feedback=feedback&&feedback.hasOwnProperty("default")?feedback.default:feedback,loadingBar=loadingBar&&loadingBar.hasOwnProperty("default")?loadingBar.default:loadingBar,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,
Handlebars.helpers),data=data||{};var helper,buffer="";return buffer+='<div class="task-report-container">\n    <div class="section-header flex-container-full">\n        <h2>',buffer+=(0,this.escapeExpression)((helper=helpers.title)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.title)?helper.call(depth0,{hash:{},data:data}):helper)+'</h2>\n    </div>\n    <div class="main-container flex-container-full report"></div>\n</div>'});var defaultConfig={},taskableComponent={setTaskConfig:function(config){return _.assign(this.config,config),this},createTask:function(){var taskQueue,requestUrl,self=this,requestData={}
;return _.isFunction(this.config.taskCreationData)?requestData=this.config.taskCreationData.call(this):_.isPlainObject(this.config.taskCreationData)&&(requestData=this.config.taskCreationData),this.config.taskCreationUrl?(requestUrl=this.config.taskCreationUrl,this.config.taskQueue?(taskQueue=this.config.taskQueue,loadingBar.start(),taskQueue.pollAllStop(),void taskQueue.create(requestUrl,requestData).then(function(result){var infoBox,message,task=result.task;result.finished?task.hasFile?taskQueue.download(task.id).then(function(){return taskQueue.archive(task.id)}).then(function(){self.trigger("finished",result),taskQueue.pollAll()}).catch(function(err){
self.trigger("error",err),taskQueue.pollAll()}):taskQueue.archive(task.id).then(function(){self.trigger("finished",result),taskQueue.pollAll()}).catch(function(err){self.trigger("error",err),taskQueue.pollAll()}):(message=__("<strong> %s </strong> has been moved to the background.",task.taskLabel),infoBox=feedback(null,{encodeHtml:!1,timeout:{info:8e3}}).info(message),taskQueue.trigger("taskcreated",{task:task,sourceDom:infoBox.getElement()}),self.trigger("enqueued",result)),loadingBar.stop()}).catch(function(err){taskQueue.pollAll(),loadingBar.stop(),self.trigger("error",err)})):this.trigger("error","the taskQueue model is required to create a task")
):this.trigger("error","the request url is required to create a task")},displayReport:function(report,title,result){var $reportContainer,self=this;if(this.config.taskReportContainer instanceof $$1)return $reportContainer=$$1(function(data,options){var html=Template(data,options);return html}({title:title})),this.config.taskReportContainer.html($reportContainer),reportFactory({actions:[{id:"continue",icon:"right",title:"continue",label:__("Continue")}]},report).on("action-continue",function(){self.trigger("continue",result)}).render($reportContainer.find(".report"))}};return function(component,config){return _.assign(component,taskableComponent),
component.off(".taskable").on("init.taskable",function(){_.defaults(this.config,config||{},defaultConfig)})}}),define("ui/taskQueueButton/standardButton",["lodash","ui/loadingButton/loadingButton","ui/taskQueueButton/taskable"],function(_,loadingButton,makeTaskable){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,loadingButton=loadingButton&&loadingButton.hasOwnProperty("default")?loadingButton.default:loadingButton,makeTaskable=makeTaskable&&makeTaskable.hasOwnProperty("default")?makeTaskable.default:makeTaskable;var defaultConfig={};return function(config){return config=_.defaults(config||{},defaultConfig),makeTaskable(loadingButton(config)).on(
"started",function(){this.createTask()}).on("finished",function(){this.terminate().reset()}).on("enqueued",function(){this.terminate().reset()})}}),define("css!ui/destination/css/selector",[],function(){}),define("ui/destination/selector",["jquery","lodash","i18n","ui/component","ui/dialog/confirm","ui/resource/selector","ui/loadingButton/loadingButton","ui/taskQueueButton/standardButton","handlebars","lib/dompurify/purify","css!ui/destination/css/selector.css"],function($$1,_,__,component,confirmDialog,resourceSelectorFactory,loadingButtonFactory,taskCreationButtonFactory,Handlebars,DOMPurify,selector_css){"use strict";function Helpers0(hb){
hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),
fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,options){if(_.contains(haystack,needle)
)return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,component=component&&component.hasOwnProperty("default")?component.default:component,confirmDialog=confirmDialog&&confirmDialog.hasOwnProperty("default")?confirmDialog.default:confirmDialog,resourceSelectorFactory=resourceSelectorFactory&&resourceSelectorFactory.hasOwnProperty("default")?resourceSelectorFactory.default:resourceSelectorFactory,loadingButtonFactory=loadingButtonFactory&&loadingButtonFactory.hasOwnProperty("default")?loadingButtonFactory.default:loadingButtonFactory,
taskCreationButtonFactory=taskCreationButtonFactory&&taskCreationButtonFactory.hasOwnProperty("default")?taskCreationButtonFactory.default:taskCreationButtonFactory,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,buffer="",functionType="function",
escapeExpression=this.escapeExpression;return buffer+='<div class="destination-selector">\n    ',!(stack1=helpers.if.call(depth0,depth0&&depth0.title,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){var stack1,helper,buffer="";return buffer+="\n    <h2>",stack1=(helper=helpers.title)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.title)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"</h2>\n    "},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+="\n    <div>\n        ",!(stack1=helpers.if.call(depth0,depth0&&depth0.description,{hash:{},inverse:this.noop,
fn:this.program(3,function(depth0,data){var stack1,helper,buffer="";return buffer+="\n        <p>",stack1=(helper=helpers.description)?helper.call(depth0,{hash:{},data:data}):typeof(helper=depth0&&depth0.description)===functionType?helper.call(depth0,{hash:{},data:data}):helper,buffer+=escapeExpression(stack1)+"</p>\n        "},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='\n        <div class="selector-container"></div>\n        <div class="actions">\n        </div>\n    </div>\n</div>\n'});function selectorTpl(data,options,asString){var html=Template(data,options);return html}var defaultConfig={title:__("Copy to"),description:__(
"Select a destination"),actionName:__("Copy"),icon:"copy"};return function($container,config){var destinationSelector=component({update:function(results,params){this.resourceSelector&&this.resourceSelector.update(results,params)}},defaultConfig).setTemplate(selectorTpl).on("init",function(){this.render($container)}).on("render",function(){var button,self=this,$component=this.getElement(),getSelectedUri=function(){var uris,select=self.resourceSelector.getSelection();if(_.isPlainObject(select)&&(uris=_.pluck(select,"uri")).length)return uris[0]};(button=this.config.taskQueue?taskCreationButtonFactory({type:"info",icon:this.config.icon,
label:this.config.actionName,terminatedLabel:"Interrupted",taskQueue:this.config.taskQueue,taskCreationData:this.config.taskCreationData||{},taskCreationUrl:this.config.taskCreationUrl,taskReportContainer:$container}).on("finished",function(result){self.trigger("finished",result,button),this.reset()}).on("continue",function(){self.trigger("continue")}):loadingButtonFactory({type:"info",icon:this.config.icon,label:this.config.actionName,terminatedLabel:"Interrupted"})).on("started",function(){function triggerAction(){self.trigger("select",getSelectedUri())}self.config.confirm?confirmDialog(self.config.confirm,triggerAction,function(){button.terminate().reset(
)}):triggerAction()}).on("error",function(err){self.trigger("error",err)}).render($component.find(".actions")).disable(),this.resourceSelector=resourceSelectorFactory($$1(".selector-container",$component),{selectionMode:"single",selectClass:!0,classUri:this.config.classUri,showContext:!1,showSelection:!1,preventSelection:this.config.preventSelection}),this.resourceSelector.spread(this,["query","error","update"]),this.resourceSelector.on("change",function(selected){selected&&0<_.size(selected)?(button.enable(),_.isPlainObject(button.config.taskCreationData)&&(button.config.taskCreationData.classUri=getSelectedUri())):button.disable()})});return _.defer(
function(){destinationSelector.init(config)}),destinationSelector}}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory(require("lodash"),require("core/promise"),require("core/eventifier")):"function"==typeof define&&define.amd?define("core/polling",["lodash","core/promise","core/eventifier"],factory):(global=global||self)["core/polling"]=factory(global._,global["core/promise"],global["core/eventifier"])}(this,function(_,Promise,eventifier){"use strict";_=_&&_.hasOwnProperty("default")?_.default:_,Promise=Promise&&Promise.hasOwnProperty("default")?Promise.default:Promise,
eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier.default:eventifier;return function(config,argument_1){var timer,promise,interval,max,iter,action,context,autoStart,state={},startTimer=function(){timer=setTimeout(iteration,interval),state.stopped=!1,state.pending=!0},stopTimer=function(){clearTimeout(timer),timer=null,state.stopped=!0,state.pending=!1},iteration=function(){max&&max<=iter?polling.stop():(iter=(iter||0)+1,state.processing=!0,state.pending=!1,polling.trigger("call"),action.call(context,polling),promise||state.stopped||(state.processing=!1,startTimer()))},polling={async:function(){var resolver={};return(promise=new Promise(
function(resolve,reject){resolver.resolve=resolve,resolver.reject=reject})).then(function(){promise=null,state.processing=!1,state.stopped||startTimer(),polling.trigger("resolved")}).catch(function(){promise=null,state.processing=!1,polling.stop(),polling.trigger("rejected")}),polling.trigger("async",resolver),resolver},next:function(){var _next;return state.stopped&&(iter=0),stopTimer(),max&&max<=iter||(state.stopped=!1,promise?(_next=this.next.bind(this),promise.then(_next).catch(_next)):(this.trigger("next"),iteration())),this},start:function(){return timer||(iter=0,startTimer(),this.trigger("start")),this},stop:function(){return stopTimer(),this.trigger(
"stop"),this},setInterval:function(value){return interval=Math.abs(parseInt(value,10)||6e4),this.trigger("setinterval",interval),this},getInterval:function(){return interval},setAction:function(fn){return action=fn,this.trigger("setaction",action),this},getAction:function(){return action},setContext:function(ctx){return context=ctx||this,this.trigger("setcontext",ctx),this},getContext:function(){return context},setMax:function(value){return max=Math.abs(parseInt(value,10)||0),this},getMax:function(){return max},getIteration:function(){return iter||0},is:function(stateName){return!!state[stateName]}};return eventifier(polling),interval=6e4,context=polling,
action=null,autoStart=!(state.stopped=!0),iter=0,_.isFunction(config)&&(polling.setAction(config),config=null),_.isObject(config)&&(polling.setAction(config.action),polling.setInterval(config.interval||argument_1),polling.setContext(config.context),polling.setMax(config.max),autoStart=!!config.autoStart),autoStart&&polling.start(),polling}}),define("ui/taskQueue/taskQueueModel",["jquery","lodash","core/eventifier","core/polling","core/dataProvider/request","ui/feedback","jquery.fileDownload"],function($,_,eventifier,polling,request,feedback,jquery_fileDownload){"use strict";$=$&&$.hasOwnProperty("default")?$.default:$,_=_&&_.hasOwnProperty("default"
)?_.default:_,eventifier=eventifier&&eventifier.hasOwnProperty("default")?eventifier.default:eventifier,polling=polling&&polling.hasOwnProperty("default")?polling.default:polling,request=request&&request.hasOwnProperty("default")?request.default:request,feedback=feedback&&feedback.hasOwnProperty("default")?feedback.default:feedback;var _defaults={url:{get:"",archive:"",all:"",download:""},pollSingleIntervals:[{iteration:4,interval:1e3}],pollAllIntervals:[{iteration:10,interval:5e3},{iteration:0,interval:1e4}]};function hasSameState(task1,task2){return task1.status===task2.status||("created"===task1.status||"in_progress"===task1.status)&&(
"created"===task2.status||"in_progress"===task2.status)}return function(config){var model,_cache,singlePollings={};return config=_.defaults(config||{},_defaults),model=eventifier({setEndpoints:function(urls){return _.assign(config.url,urls||{}),this},get:function(taskId){var status;if(!config.url||!config.url.get)throw new TypeError("config.url.get is not configured while get() is being called");return(status=request(config.url.get,{taskId:taskId},"GET",{},!0).then(function(taskData){return taskData&&taskData.status?(_cache?_cache[taskData.id]?hasSameState(_cache[taskData.id],taskData)||model.trigger("singletaskstatuschange",taskData):model.trigger(
"singletaskadded",taskData):_cache={},_cache[taskData.id]=taskData):Promise.reject(new Error("failed to get task data"))})).catch(function(err){model.trigger("error",err)}),status},getCached:function(taskId){return _cache&&_cache[taskId]?Promise.resolve(_cache[taskId]):this.get(taskId)},getAll:function(){var status;if(!config.url||!config.url.all)throw new TypeError("config.url.all is not configured while getAll() is being called");return(status=request(config.url.all,{limit:100},"GET",{},!0).then(function(taskData){var newCache={};return taskData?(_cache?(_.forEach(taskData,function(task){var id=task.id;_cache[id]?hasSameState(_cache[id],task
)||model.trigger("multitaskstatuschange",task):model.trigger("multitaskadded",task),newCache[id]=task}),_.forEach(_.difference(_.keys(_cache),_.keys(newCache)),function(id){model.trigger("taskremoved",_cache[id])})):_.forEach(taskData,function(task){newCache[task.id]=task}),_cache=newCache,taskData):Promise.reject(new Error("failed to get all task data"))})).catch(function(err){model.trigger("error",err)}),status},archive:function(taskId){var status;if(!config.url||!config.url.archive)throw new TypeError("config.url.archive is not configured while archive() is being called");return(status=request(config.url.archive,{taskId:taskId},"GET",{},!0)).catch(
function(res){model.trigger("error",res)}),status},pollAll:function(immediate){var self=this,loop=0,pollingIntervals=function(){if(config.pollAllIntervals&&_.isArray(config.pollAllIntervals))return _.cloneDeep(config.pollAllIntervals)}(),_updateInterval=function(pollingInstance){var pollingInterval;loop?loop--:(pollingInterval=pollingIntervals.shift())&&void 0!==pollingInterval.iteration&&pollingInterval.interval&&(loop=pollingInterval.iteration,pollingInstance.setInterval(pollingInterval.interval))};if(!config.url||!config.url.all)throw new TypeError("config.url.all is not configured while pollAll() is being called");return this.globalPolling||(
this.globalPolling=polling({action:function(){var statusArr,done=this.async();model.getAll().then(function(taskDataArray){if(model.trigger("pollAll",taskDataArray),-1===(statusArr=_.map(taskDataArray,"status")).indexOf("in_progress")&&-1===statusArr.indexOf("created"))return done.reject();_updateInterval(self.globalPolling),done.resolve()}).catch(function(){done.reject()})}}),_updateInterval(this.globalPolling)),this.globalPolling.start(),this.trigger("pollAllStart"),immediate&&this.globalPolling.next(),model},pollAllStop:function(){return this.globalPolling&&(this.globalPolling.stop(),this.trigger("pollAllStop")),this},pollSingle:function(taskId){
var self=this,loop=0,pollingIntervals=function(){if(config.pollSingleIntervals&&_.isArray(config.pollSingleIntervals))return _.cloneDeep(config.pollSingleIntervals)}(),_updateInterval=function(pollingInstance){var pollingInterval;return loop?(loop--,!0):!!((pollingInterval=pollingIntervals.shift())&&pollingInterval.iteration&&pollingInterval.interval)&&(loop=pollingInterval.iteration,pollingInstance.setInterval(pollingInterval.interval),!0)};if(!config.url||!config.url.get)throw new TypeError("config.url.get is not configured while pollSingle() is being called");return singlePollings[taskId]&&singlePollings[taskId].stop(),new Promise(function(resolve){
var poll=polling({action:function(){var done=this.async();self.get(taskId).then(function(taskData){"completed"===taskData.status||"failed"===taskData.status?(poll.stop(),self.trigger("pollSingleFinished",taskId,taskData),resolve({finished:!0,task:taskData})):_updateInterval(poll)?(self.trigger("pollSingle",taskId,taskData),done.resolve()):(self.trigger("pollSingleFinished",taskId,taskData),resolve({finished:!1,task:taskData}))}).catch(function(){done.reject()})}});_updateInterval(poll),singlePollings[taskId]=poll.start(),self.trigger("pollSingleStart",taskId)})},pollSingleStop:function(taskId){return singlePollings&&singlePollings[taskId]&&(
singlePollings[taskId].stop(),this.trigger("pollSingleStop",taskId)),this},create:function(url,data){var taskCreate,self=this;return(taskCreate=request(url,data,"POST",{},!0).then(function(creationResult){return creationResult&&creationResult.task&&creationResult.task.id?(self.trigger("created",creationResult),self.pollSingle(creationResult.task.id).then(function(result){return creationResult.extra&&(result.extra=creationResult.extra),result.finished?self.trigger("fastFinished",result):self.trigger("enqueued",result),result})):Promise.reject(new Error("failed to get task data"))})).catch(function(err){model.trigger("error",err)}),taskCreate},
download:function(taskId){if(!config.url||!config.url.download)throw new TypeError("config.url.download is not configured while download() is being called");return new Promise(function(resolve,reject){$.fileDownload(config.url.download,{httpMethod:"POST",data:{taskId:taskId},successCallback:function(result){resolve(result)},failCallback:function(err){reject(err)}})})},redirect:function(taskId){return this.getCached(taskId).then(function(taskData){var redirectUrl=(taskData||{}).redirectUrl;if(!redirectUrl)throw new TypeError("config.redirectUrl is not configured while redirect() is being called");if(0!==redirectUrl.indexOf("http"))throw new TypeError(
"redirectUrl does not look like a proper url: "+redirectUrl);return request(taskData.redirectUrl)}).then(function(response){_.isEmpty(response)||(window.location.href=response)}).catch(function(err){throw err&&202===err.code&&err.response&&err.response.errorMessage&&feedback().error(err.response.errorMessage),err})}})}}),define("ui/taskQueue/taskQueue",["util/url","ui/taskQueue/taskQueueModel"],function(urlHelper,taskQueueModelFactory){"use strict";return urlHelper=urlHelper&&urlHelper.hasOwnProperty("default")?urlHelper.default:urlHelper,(taskQueueModelFactory=taskQueueModelFactory&&taskQueueModelFactory.hasOwnProperty("default"
)?taskQueueModelFactory.default:taskQueueModelFactory)({url:{get:urlHelper.route("get","TaskQueueWebApi","tao"),archive:urlHelper.route("archive","TaskQueueWebApi","tao"),all:urlHelper.route("getAll","TaskQueueWebApi","tao"),download:urlHelper.route("download","TaskQueueWebApi","tao")},pollSingleIntervals:[{iteration:3,interval:1e3}],pollAllIntervals:[{iteration:1,interval:8e3},{iteration:0,interval:5e3}]})}),define("css!ui/switch/css/switch",[],function(){}),define("ui/switch/switch",["jquery","lodash","i18n","ui/component","lib/uuid","handlebars","lib/dompurify/purify","css!ui/switch/css/switch.css"],function($$1,_,__,component,uuid,Handlebars,DOMPurify,
switch_css){"use strict";function Helpers0(hb){hb.registerHelper("__",function(key){return __(key)}),hb.registerHelper("dompurify",function(context){return DOMPurify.sanitize(context)}),hb.registerHelper("join",function(arr,keyValueGlue,fragmentGlue,wrapper){var fragments=[];return keyValueGlue="string"==typeof keyValueGlue?keyValueGlue:void 0,fragmentGlue="string"==typeof fragmentGlue?fragmentGlue:" ",wrapper="string"==typeof wrapper?wrapper:'"',_.forIn(arr,function(value,key){var fragment="";null!==value||void 0!==value?"boolean"==typeof value?value=value?"true":"false":"object"==typeof value&&(value=_.values(value).join(" ")):value="",
void 0!==keyValueGlue&&(fragment+=key+keyValueGlue),fragment+=wrapper+value+wrapper,fragments.push(fragment)}),fragments.join(fragmentGlue)}),hb.registerHelper("for",function(startIndex,stopIndex,increment,options){var ret="";startIndex=parseInt(startIndex),stopIndex=parseInt(stopIndex),increment=parseInt(increment);for(var i=startIndex;i<stopIndex;i+=increment)ret+=options.fn(_.extend({},this,{i:i}));return ret}),hb.registerHelper("equal",function(var1,var2,options){return var1==var2?options.fn(this):options.inverse(this)}),hb.registerHelper("property",function(name,context){return context[name]||""}),hb.registerHelper("includes",function(haystack,needle,
options){if(_.contains(haystack,needle))return options.fn(this)})}$$1=$$1&&$$1.hasOwnProperty("default")?$$1.default:$$1,_=_&&_.hasOwnProperty("default")?_.default:_,__=__&&__.hasOwnProperty("default")?__.default:__,component=component&&component.hasOwnProperty("default")?component.default:component,uuid=uuid&&uuid.hasOwnProperty("default")?uuid.default:uuid,Handlebars=Handlebars&&Handlebars.hasOwnProperty("default")?Handlebars.default:Handlebars,DOMPurify=DOMPurify&&DOMPurify.hasOwnProperty("default")?DOMPurify.default:DOMPurify,Helpers0.__initialized||(Helpers0(Handlebars),Helpers0.__initialized=!0);var Template=Handlebars.template(function(Handlebars,
depth0,helpers,partials,data){this.compilerInfo=[4,">= 1.0.0"],helpers=this.merge(helpers,Handlebars.helpers),data=data||{};var stack1,helper,buffer="",escapeExpression=this.escapeExpression;function program5(depth0,data){return"active"}return buffer+='<div class="switch ',!(stack1=helpers.if.call(depth0,depth0&&depth0.monoStyle,{hash:{},inverse:this.noop,fn:this.program(1,function(depth0,data){return"monostyle"},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='" title="',buffer+=escapeExpression(stack1=(helper=helpers.title)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.title)?helper.call(depth0,{hash:{},data:data
}):helper)+'">\n    <input type="checkbox" name="',buffer+=escapeExpression(stack1=(helper=helpers.name)?helper.call(depth0,{hash:{},data:data}):"function"==typeof(helper=depth0&&depth0.name)?helper.call(depth0,{hash:{},data:data}):helper)+'" ',!(stack1=helpers.if.call(depth0,null==(stack1=depth0&&depth0.on)||!1===stack1?stack1:stack1.active,{hash:{},inverse:this.noop,fn:this.program(3,function(depth0,data){return"checked"},data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='>\n    <label>\n        <span class="off ',!(stack1=helpers.if.call(depth0,null==(stack1=depth0&&depth0.off)||!1===stack1?stack1:stack1.active,{hash:{},inverse:this.noop,
fn:this.program(5,program5,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='">'+escapeExpression("function"==typeof(stack1=null==(stack1=depth0&&depth0.off)||!1===stack1?stack1:stack1.label)?stack1.apply(depth0):stack1)+'</span>\n        <span class="on  ',!(stack1=helpers.if.call(depth0,null==(stack1=depth0&&depth0.on)||!1===stack1?stack1:stack1.active,{hash:{},inverse:this.noop,fn:this.program(5,program5,data),data:data}))&&0!==stack1||(buffer+=stack1),buffer+='">'+escapeExpression("function"==typeof(stack1=null==(stack1=depth0&&depth0.on)||!1===stack1?stack1:stack1.label)?stack1.apply(depth0):stack1)+"</span>\n    </label>\n</div>\n"})
;function switchTpl(data,options,asString){var html=Template(data,options);return html}var states_on="on",states_off="off",defaultConfig={on:{label:__("On")},off:{label:__("Off"),active:!0},title:""};return function($container,config){var onElt,offElt,switchComponent=component({getName:function(){return this.config.name},isOn:function(){return this.is(states_on)},isOff:function(){return!this.is(states_on)},setOn:function(){return this.isOn()||this.setState(states_on,!0),this.is("rendered")&&(offElt.removeClass("active"),onElt.addClass("active"),this.trigger("change",states_on).trigger(states_on)),this},setOff:function(){return this.isOff()||this.setState(
states_on,!1),this.is("rendered")&&(onElt.removeClass("active"),offElt.addClass("active"),this.trigger("change",states_off).trigger(states_off)),this},toggle:function(){return this.isOn()?this.setOff():this.setOn()},getValue:function(){return this.is(states_on)?states_on:states_off}},defaultConfig).setTemplate(switchTpl).on("init",function(){this.config.name||(this.config.name="switch-"+uuid()),this.config.on=_.defaults(this.config.on,defaultConfig.on),this.config.off=_.defaults(this.config.off,defaultConfig.off),!0===this.config.on.active?(this.config.off.active=!1,this.setOn()):this.setOff(),this.render($container)}).on("render",function(){var self=this,
$component=this.getElement();onElt=$$1("."+states_on,$component),offElt=$$1("."+states_off,$component),$$1(":checkbox",$component).on("change",function(e){e.preventDefault(),self.toggle()})});return _.defer(function(){switchComponent.init(config)}),switchComponent}}),define("css!taoLtiConsumerCss/wizard",[],function(){}),define("taoLtiConsumer/controller/DeliveryMgmt/wizard",["lodash","jquery","i18n","ui/filter","ui/feedback","util/url","layout/actions","core/promise","ui/taskQueue/taskQueue","ui/taskQueueButton/standardButton","ui/switch/switch","css!taoLtiConsumerCss/wizard.css"],function(_,$,__,filterFactory,feedback,urlUtils,actionManager,Promise,
taskQueue,taskCreationButtonFactory,switchFactory){"use strict";var provider_listProviders=function(data){return new Promise(function(resolve,reject){$.ajax({url:urlUtils.route("getAvailableLtiProviders","DeliveryMgmt","taoLtiConsumer"),data:{q:data.q,page:data.page},type:"GET",dataType:"JSON"}).done(function(tests){tests?resolve(tests):reject(new Error(__("Unable to load lti providers")))}).fail(function(){reject(new Error(__("Unable to load lti providers")))})})},provider_listTests=function(data){return new Promise(function(resolve,reject){$.ajax({url:urlUtils.route("getAvailableTests","DeliveryMgmt","taoDeliveryRdf"),data:{q:data.q,page:data.page},
type:"GET",dataType:"JSON"}).done(function(tests){tests?resolve(tests):reject(new Error(__("Unable to load tests")))}).fail(function(){reject(new Error(__("Unable to load tests")))})})},refreshTree=function(uriResource){actionManager.trigger("refresh",{uri:uriResource})};return{start:function(){var taskCompiledCreationButton,taskLtiCreationButton,$multiForm=$(".multi-form-container"),$switch=$(".form-switch",$multiForm),$compiledForm=$("#simpleWizard"),$ltiForm=$("#simpleLtiWizard"),$testFilterContainer=$compiledForm.find(".test-select-container"),$providerFilterContainer=$ltiForm.find(".lti-provider-select-container"),$testFormElement=$("#test"),
$providerFormElement=$("#ltiProvider"),$compiledFormContentBlock=$(".compiled-delivery-form-content"),$ltiFormContentBlock=$(".lti-delivery-form-content"),$compiledContainer=$compiledForm.closest(".content-block"),$ltiContainer=$ltiForm.closest(".content-block"),$oldCompiledSubmitter=$compiledForm.find(".form-submitter"),$oldLtiSubmitter=$ltiForm.find(".form-submitter");$ltiFormContentBlock.addClass("hidden"),switchFactory($switch,{off:{label:__("TAO delivery"),active:!0},on:{label:__("LTI based delivery")},monoStyle:!0}).on("change",function(){$compiledFormContentBlock.toggleClass("hidden"),$ltiFormContentBlock.toggleClass("hidden")}),filterFactory(
$testFilterContainer,{placeholder:__("Select the test you want to publish to the test-takers"),width:"64%",quietMillis:1e3,label:__("Select the test")}).on("change",function(chosenTest){$testFormElement.val(chosenTest),chosenTest?taskCompiledCreationButton.enable():taskCompiledCreationButton.disable()}).on("request",function(params){provider_listTests(params.data).then(function(tests){params.success(tests)}).catch(function(err){params.error(err),feedback().error(err)})}).render("<%- text %>"),filterFactory($providerFilterContainer,{placeholder:__("Select the Provider you want to publish"),width:"64%",quietMillis:1e3,label:__("LTI Provider")}).on("change",
function(chosenProvider){$providerFormElement.val(chosenProvider),chosenProvider?taskLtiCreationButton.enable():taskLtiCreationButton.disable()}).on("request",function(params){provider_listProviders(params.data).then(function(tests){params.success(tests)}).catch(function(err){params.error(err),feedback().error(err)})}).render("<%- text %>"),taskCompiledCreationButton=taskCreationButtonFactory({type:"info",icon:"delivery",title:__("Publish the test"),label:__("Publish"),taskQueue:taskQueue,taskCreationUrl:$compiledForm.prop("action"),taskCreationData:function(){return $compiledForm.serializeArray()},taskReportContainer:$compiledContainer}).on("finished",
function(result){result.task&&result.task.report&&_.isArray(result.task.report.children)&&result.task.report.children.length&&result.task.report.children[0]&&(result.task.report.children[0].data&&result.task.report.children[0].data.uriResource?(feedback().info(__("%s completed",result.task.taskLabel)),refreshTree(result.task.report.children[0].data.uriResource)):this.displayReport(result.task.report.children[0],__("Error")))}).on("continue",function(){refreshTree()}).on("error",function(err){feedback().error(err),this.trigger("finished")}).render($oldCompiledSubmitter.closest(".form-toolbar")).disable(),$oldCompiledSubmitter.replaceWith(
taskCompiledCreationButton.getElement()),taskLtiCreationButton=taskCreationButtonFactory({type:"info",icon:"delivery",title:__("Publish the test"),label:__("Publish"),taskQueue:taskQueue,taskCreationUrl:$ltiForm.prop("action"),taskCreationData:function(){return $ltiForm.serializeArray()},taskReportContainer:$ltiContainer}).on("finished",function(result){result.task&&result.task.report&&_.isArray(result.task.report.children)&&result.task.report.children.length&&result.task.report.children[0]&&(result.task.report.children[0].data&&result.task.report.children[0].data.uriResource?(feedback().info(__("%s completed",result.task.taskLabel)),refreshTree(
result.task.report.children[0].data.uriResource)):this.displayReport(result.task.report.children[0],__("Error")))}).on("continue",function(){refreshTree()}).on("error",function(err){feedback().error(err),this.trigger("finished")}).render($oldLtiSubmitter.closest(".form-toolbar")).disable(),$oldLtiSubmitter.replaceWith(taskLtiCreationButton.getElement())}}}),define("taoLtiConsumer/controller/routes",{DeliveryMgmt:{actions:{wizard:"controller/DeliveryMgmt/wizard"}}}),function(c){var d=document,a="appendChild",i="styleSheet",s=d.createElement("style");s.type="text/css",d.getElementsByTagName("head")[0][a](s),s[i]?s[i].cssText=c:s[a](d.createTextNode(c))}(
'@charset "UTF-8";\n/*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n/* Style of advanced components */\n/* toggler */\n.toggler:after {\n  margin-left: 3px;\n  position: relative;\n  top: 2px;\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n}\n.toggler.opened:after {\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n}\n\n.toggled {\n  display: none;\n}\n\n/* Adder */\n.adder:before {\n  margin-right: 5px;\n  font-size: 10.5px;\n  font-size: 1.05rem;\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n}\n\n/* Closer / Deleter */\n.closer:before, .deleter:before {\n  margin-right: 5px;\n  font-size: 10.5px;\n  font-size: 1.05rem;\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n}\n\n.undobox {\n  display: block;\n  position: fixed;\n  top: 50px;\n  left: 50%;\n  margin-left: -200px;\n  width: 400px;\n  z-index: 100005;\n}\n\n/* Incrementer and duration */\ninput[data-increment], input.duration-ctrl {\n  width: 40px !important;\n  min-width: 40px !important;\n  text-align: right;\n}\n\n.duration-ctrl-wrapper, .incrementer-ctrl-wrapper {\n  position: relative;\n  display: inline-block;\n  border: 1px solid #ddd;\n  border-radius: 2px;\n  border-radius: 2px;\n}\n.duration-ctrl-wrapper .incrementer, .incrementer-ctrl-wrapper .incrementer {\n  text-align: right;\n  border: none;\n  padding-right: 18px;\n}\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl {\n  border-left: 1px #ddd solid;\n  display: inline-block;\n  height: 100%;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a {\n  outline: 0 !important;\n  cursor: pointer;\n  display: inline-block;\n  line-height: 13px;\n  color: #222;\n  background: #f3f1ef;\n  padding: 0 4px 0 4px;\n  font-size: 10.5px;\n  font-size: 1.05rem;\n  position: absolute;\n  right: 0;\n  height: 50%;\n  text-align: center;\n}\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.inc, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.inc {\n  top: 0;\n  border-top-right-radius: 2px;\n}\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.dec, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.dec {\n  top: 50%;\n  border-bottom-right-radius: 2px;\n}\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.inc:before, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.inc:before {\n  position: relative;\n  bottom: 0px;\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n}\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.dec:before, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a.dec:before {\n  position: relative;\n  top: 0px;\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n}\n.duration-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a:hover, .incrementer-ctrl-wrapper .incrementer ~ .incrementer-ctrl > a:hover {\n  background-color: #3e7da7;\n  color: white;\n}\n\n.duration-ctrl-wrapper ~ .separator {\n  padding: 0 3px;\n  text-align: center;\n  opacity: 0.7;\n}\n\n/* InPlacer */\n[data-in-place], .inplace {\n  cursor: pointer;\n  min-height: 1em;\n}\n[data-in-place] input, .inplace input {\n  cursor: auto;\n}\n[data-in-place]:hover, .inplace:hover {\n  border: dotted 1px #3e7da7;\n}\n\n/* ListBox  */\nul.listbox {\n  margin: 0.1em 0;\n  padding: 0;\n  list-style-type: none;\n  display: block;\n}\nul.listbox > li {\n  white-space: no-wrap;\n  position: relative;\n  min-width: 75%;\n  border: solid 1px #ddd;\n  border-bottom-width: 0;\n  vertical-align: top;\n  margin: 0;\n  padding: 0.3em 2em 0.3em 0.2em;\n  background-color: #f3f1ef;\n  min-height: 1.5em;\n}\nul.listbox > li > .closer, ul.listbox > li > .deleter {\n  position: absolute;\n  right: 5px;\n  top: 0;\n}\nul.listbox > li:first-child {\n  border-radius: 2px 2px 0 0;\n}\nul.listbox > li:last-child {\n  border-radius: 0 0 2px 2px;\n  border-bottom-width: 1px;\n}\nul.listbox > li.placeholder {\n  background: none;\n  margin: 0.5em;\n  opacity: 0.6;\n}\n\n/* Modal styles */\n.modal {\n  background-color: white;\n  border: 1px solid #ddd;\n  box-shadow: 3px 3px 5px #666666;\n  height: auto;\n  opacity: 0;\n  top: -1000px;\n  padding: 40px;\n  position: fixed;\n  z-index: 105002;\n  margin: auto;\n  left: 0;\n  right: 0;\n  overflow: hidden;\n}\n.modal .modal-close {\n  position: absolute;\n  right: 12px;\n  top: 10px;\n  cursor: pointer;\n  font-weight: bold;\n  color: #222;\n  font-size: 20px;\n  font-size: 2rem;\n}\n.modal .modal-close:hover {\n  opacity: 0.6;\n}\n.modal .modal-body h4 {\n  font-size: 16px;\n  font-size: 1.6rem;\n  margin-top: 0;\n  margin-bottom: 8px;\n}\n.modal .modal-body .content, .modal .modal-body .message {\n  margin-bottom: 8px;\n}\n.modal .modal-body .buttons {\n  top: 16px;\n  position: relative;\n}\n.modal .modal-body .buttons button {\n  border-radius: 2px;\n  margin-left: 8px;\n  height: 36px;\n  text-shadow: none;\n  text-transform: uppercase;\n  color: #0e5d91 !important;\n  background: none;\n}\n.modal .modal-body .buttons button:focus, .modal .modal-body .buttons button:hover {\n  background: #dbe7ef;\n}\n.modal[class^=icon-]:before, .modal[class*=" icon-"]:before {\n  font-size: 44px;\n  font-size: 4.4rem;\n  color: #0e5d91;\n  position: absolute;\n}\n.modal[class^=icon-].icon-result-nok:before, .modal[class*=" icon-"].icon-result-nok:before {\n  color: #ba122b;\n}\n.modal[class^=icon-].icon-warning:before, .modal[class*=" icon-"].icon-warning:before {\n  color: #c96043;\n}\n.modal[class^=icon-].icon-result-ok:before, .modal[class*=" icon-"].icon-result-ok:before {\n  color: #0e914b;\n}\n.modal[class^=icon-].error:before, .modal[class*=" icon-"].error:before {\n  color: #ba122b;\n}\n.modal[class^=icon-].danger:before, .modal[class*=" icon-"].danger:before {\n  color: #c96043;\n}\n.modal[class^=icon-].warning:before, .modal[class*=" icon-"].warning:before {\n  color: #d8ae5b;\n}\n.modal[class^=icon-].info:before, .modal[class*=" icon-"].info:before {\n  color: #0e5d91;\n}\n.modal[class^=icon-].success:before, .modal[class*=" icon-"].success:before {\n  color: #0e914b;\n}\n.modal[class^=icon-] .modal-body, .modal[class*=" icon-"] .modal-body {\n  font-family: "Franklin Gothic", "Franklin Gothic Medium", "Source Sans Pro", sans-serif !important;\n  line-height: 1.4;\n  margin-left: 8.5rem;\n}\n\n.modal-bg {\n  background: none repeat scroll 0 0 black;\n  opacity: 0.45;\n  -ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=45)";\n  filter: alpha(opacity=45);\n  display: none;\n  position: fixed;\n  height: 100%;\n  width: 100%;\n  left: 0;\n  top: 0;\n  z-index: 100001;\n  overflow: hidden;\n}\n\n/* Button groups */\nul[data-button-group], ul.button-group {\n  list-style-type: none;\n  padding: 0;\n  background-color: white;\n  border: 1px solid #ddd;\n  border-radius: 1px;\n  margin: 0 2px 2px 0;\n  display: inline-block;\n  border-radius: 2px;\n  font-size: 12px;\n  font-size: 1.2rem;\n}\nul[data-button-group] > li, ul.button-group > li {\n  border: 0 none;\n  color: #222;\n  cursor: pointer;\n  display: inline-block;\n  float: left;\n  min-width: 26px;\n  padding: 4px 6px;\n  text-align: center;\n  text-decoration: none !important;\n}\nul[data-button-group] > li.active, ul.button-group > li.active {\n  color: white;\n  background-color: #0e5d91;\n  transition: all 0.4s ease;\n}\nul[data-button-group] > li:hover, ul.button-group > li:hover {\n  color: white;\n  background-color: #3e7da7;\n  transition: all 0.4s ease;\n}\nul[data-button-group] > li.separator, ul.button-group > li.separator {\n  background-color: #ddd;\n  float: left;\n  height: 18px;\n  margin: 5px 2px 0 2px;\n  width: 1px;\n  min-width: 1px;\n  padding: 0;\n}\nul[data-button-group] > li[class^=icon-], ul[data-button-group] > li[class*=" icon-"], ul.button-group > li[class^=icon-], ul.button-group > li[class*=" icon-"] {\n  height: 16px;\n  margin-top: 1px;\n  width: 16px;\n  padding-top: 2px;\n}\n\n/* Media Preview */\n.previewer {\n  background-color: white;\n  margin: 5px;\n  min-width: 280px;\n  min-height: 200px;\n  text-align: center;\n}\n.previewer .nopreview {\n  color: #ddd;\n  text-align: center;\n  font-size: 20px;\n  font-size: 2rem;\n}\n.previewer .nopreview:before {\n  font-size: 60px;\n  font-size: 6rem;\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n  display: block !important;\n}\n\n/* Progress bar */\n.progressbar {\n  height: 2em;\n  text-align: left;\n  border: none;\n  height: 0.8em;\n  background-color: white;\n  border: 1px solid #ddd;\n}\n.progressbar > span {\n  height: 100%;\n  border: none;\n  background-color: #3e7da7;\n  display: block;\n  color: white;\n  transition: width 0.4s ease 0s;\n}\n.progressbar.info > span {\n  background-color: #0e5d91;\n}\n.progressbar.success > span {\n  background-color: #0e914b;\n}\n.progressbar.warning > span {\n  background-color: #d8ae5b;\n}\n.progressbar.error > span {\n  background-color: #ba122b;\n}\n/*# sourceMappingURL=components.css.map */@charset "UTF-8";\n/*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.class-selector {\n  padding: 5px;\n  position: relative;\n  opacity: 0;\n}\n.class-selector.rendered {\n  opacity: 1;\n  transition: opacity, 300ms, linear, 0s;\n}\n.class-selector a.selected {\n  display: inline-block;\n  position: relative;\n  border: 1px solid #ddd;\n  border-radius: 2px;\n  border-radius: 3px;\n  padding: 3px 20px 3px 10px;\n  text-decoration: none;\n  width: 100%;\n  background-color: white;\n}\n.class-selector a.selected.empty {\n  color: #a4a9b1;\n}\n.class-selector a.selected:after {\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n  position: absolute;\n  right: 10px;\n  top: 7px;\n}\n.class-selector .options {\n  position: absolute;\n  width: 100%;\n  background-color: #f3f1ef;\n  border: solid 1px #ddd;\n  -webkit-border-bottom-right-radius: 3px;\n  -webkit-border-bottom-left-radius: 3px;\n  -moz-border-radius-bottomright: 3px;\n  -moz-border-radius-bottomleft: 3px;\n  border-bottom-right-radius: 3px;\n  border-bottom-left-radius: 3px;\n  -ms-box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.2);\n  -o-box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.2);\n  box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.2);\n  left: 0;\n  margin-top: 7px;\n  overflow-y: auto;\n  z-index: 100;\n  min-height: 100px;\n  max-height: 450px;\n  transition: max-height, 300ms, ease, 0s;\n}\n.class-selector .options.folded {\n  overflow: hidden;\n  min-height: 0;\n  max-height: 0;\n  border-width: 0;\n  transition: max-height, 300ms, ease, 0s;\n}\n.class-selector .options ul {\n  list-style-type: none;\n  padding: 0;\n  margin: 0 0 0 15px;\n}\n.class-selector .options ul li {\n  padding-top: 3px;\n}\n.class-selector .options ul li a {\n  text-decoration: none;\n  color: #222;\n}\n.class-selector .options ul li a:hover {\n  color: #0e5d91;\n  transition: color, 200ms, linear, 0s;\n}\n.class-selector .options ul li:before {\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n  color: #d8ae5b;\n  top: 2px;\n  -webkit-text-shadow: 1px 1px 0 #ad8b49;\n  -moz-text-shadow: 1px 1px 0 #ad8b49;\n  text-shadow: 1px 1px 0 #ad8b49;\n  margin-right: 4px;\n}\n.class-selector .options > ul {\n  margin: 5px 0 0 7px;\n}\n/*# sourceMappingURL=selector.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.ui-generis-validator {\n  color: #ba122b;\n  text-align: right;\n  width: 99%;\n}\n.ui-generis-validator input.error,\n.ui-generis-validator select.error,\n.ui-generis-validator textarea.error {\n  border-color: #ba122b;\n  color: #ba122b;\n}\n/*# sourceMappingURL=validator.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.ui-generis-widget {\n  margin: 10px 0px;\n}\n.ui-generis-widget > .left {\n  display: inline-block;\n  margin-top: 8px;\n  width: 34%;\n  vertical-align: top;\n}\n.ui-generis-widget > .right {\n  display: inline-block;\n  min-width: 150px;\n  width: 65%;\n}\n.ui-generis-widget > .right > input,\n.ui-generis-widget > .right > select,\n.ui-generis-widget > .right > textarea {\n  background-color: white;\n  border: 1px solid #ddd;\n  border-radius: 2px;\n  -webkit-border-radius: 2px;\n  color: #222;\n  font-family: "Franklin Gothic", "Franklin Gothic Medium", "Source Sans Pro", sans-serif;\n  padding: 8px;\n  width: 100%;\n}\n.ui-generis-widget > .right > input,\n.ui-generis-widget > .right > select {\n  font: inherit;\n  height: 36px;\n}\n.ui-generis-widget > .right > .check-box-input {\n  color: #222;\n  display: inline-block;\n  font-family: "Franklin Gothic", "Franklin Gothic Medium", "Source Sans Pro", sans-serif;\n  padding: 4px;\n  width: 100%;\n}\n.ui-generis-widget > .right > .check-box-input > .option {\n  padding-top: 4px;\n}\n.ui-generis-widget > .right input.error,\n.ui-generis-widget > .right select.error,\n.ui-generis-widget > .right textarea.error,\n.ui-generis-widget > .right .check-box-input.error {\n  border-color: #ba122b;\n  color: #ba122b;\n}\n.ui-generis-widget .validation-container {\n  color: #ba122b;\n  text-align: right;\n  width: 99%;\n}\n/*# sourceMappingURL=widget.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.ui-generis-form {\n  border: 1px solid #ddd;\n  border-radius: 2px;\n  -webkit-border-radius: 2px;\n  background-color: #f3f1ef;\n  padding: 20px;\n  position: relative;\n  margin: 20px;\n  width: 500px;\n}\n.ui-generis-form h2 {\n  margin-top: 0;\n}\n.ui-generis-form .toolbar {\n  margin-top: 30px;\n  text-align: right;\n}\n@keyframes spinner {\n  to {\n    transform: rotate(360deg);\n  }\n}\n/*# sourceMappingURL=form.css.map */@charset "UTF-8";\n/*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.resource-selector {\n  position: relative;\n  height: 100%;\n  display: box;\n  display: -webkit-flexbox;\n  display: flexbox;\n  display: -ms-flex;\n  display: flex;\n  flex-direction: column;\n  flex-wrap: nowrap;\n  flex-pack: start;\n  justify-content: flex-start;\n  flex-line-pack: start;\n  align-content: flex-start;\n  flex-align: stretch;\n  align-items: stretch;\n  opacity: 0;\n  background-color: #f3f1ef;\n  border: 1px solid #ddd;\n  border-radius: 2px;\n  -webkit-border-radius: 2px;\n}\n.resource-selector.rendered {\n  opacity: 1;\n  transition: opacity, 300ms, linear, 0s;\n}\n.resource-selector .resource-list {\n  position: relative;\n  height: 100%;\n  opacity: 0;\n}\n.resource-selector .resource-list.rendered {\n  opacity: 1;\n  transition: opacity, 300ms, linear, 0s;\n}\n.resource-selector .resource-list.multiple ul li a:after {\n  display: block;\n  transition: all, 200ms, linear, 0s;\n}\n.resource-selector .resource-list ul {\n  list-style-type: none;\n  padding: 0;\n  margin: 0;\n}\n.resource-selector .resource-list ul li {\n  position: relative;\n  height: 40px;\n  padding: 10px;\n  border-bottom: solid 1px #ddd;\n  transition: background-color, 200ms, linear, 0s;\n}\n.resource-selector .resource-list ul li a {\n  transition: color, 200ms, linear, 0s;\n  color: #222;\n  display: inline-block;\n  width: 100%;\n  padding-right: 25px;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n}\n.resource-selector .resource-list ul li a:after {\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n  color: #0e5d91;\n  position: absolute;\n  right: 17px;\n  top: 12px;\n  display: none;\n}\n.resource-selector .resource-list ul li a:hover {\n  text-decoration: none;\n}\n.resource-selector .resource-list ul li a > span {\n  color: #0e5d91;\n  margin-right: 4px;\n  font-size: 16px;\n  font-size: 1.6rem;\n  vertical-align: top;\n}\n.resource-selector .resource-list ul li.selected, .resource-selector .resource-list ul li:hover {\n  background-color: #3e7da7;\n  cursor: pointer;\n  transition: background-color, 200ms, linear, 0s;\n}\n.resource-selector .resource-list ul li.selected a, .resource-selector .resource-list ul li:hover a {\n  color: white;\n  transition: color, 200ms, linear, 0s;\n}\n.resource-selector .resource-list ul li.selected a:after, .resource-selector .resource-list ul li:hover a:after {\n  color: white;\n}\n.resource-selector .resource-list ul li.selected a > span, .resource-selector .resource-list ul li:hover a > span {\n  color: white;\n}\n.resource-selector .resource-list ul li.selected a:after {\n  content: "";\n}\n.resource-selector .resource-list ul li[data-access=denied] > a [class^=icon-], .resource-selector .resource-list ul li[data-access=denied] > a [class*=" icon-"], .resource-selector .resource-list ul li[data-access=partial] > a [class^=icon-], .resource-selector .resource-list ul li[data-access=partial] > a [class*=" icon-"] {\n  position: relative;\n}\n.resource-selector .resource-list ul li[data-access=denied] > a [class^=icon-]:after, .resource-selector .resource-list ul li[data-access=denied] > a [class*=" icon-"]:after, .resource-selector .resource-list ul li[data-access=partial] > a [class^=icon-]:after, .resource-selector .resource-list ul li[data-access=partial] > a [class*=" icon-"]:after {\n  content: "";\n  color: #555;\n  position: absolute;\n  left: 7px;\n  top: 6px;\n}\n.resource-selector .resource-list ul li[data-access=denied] {\n  color: #a4a9b1;\n  background-color: white;\n}\n.resource-selector .resource-list ul li[data-access=denied]:hover, .resource-selector .resource-list ul li[data-access=denied]:hover > a, .resource-selector .resource-list ul li[data-access=denied] > a, .resource-selector .resource-list ul li[data-access=denied] [class^=icon-]:before, .resource-selector .resource-list ul li[data-access=denied] [class*=" icon-"]:before {\n  cursor: auto;\n  background-color: white;\n  color: #a4a9b1 !important;\n}\n.resource-selector .resource-tree {\n  position: relative;\n  height: 100%;\n  opacity: 0;\n}\n.resource-selector .resource-tree.rendered {\n  opacity: 1;\n  transition: opacity, 300ms, linear, 0s;\n}\n.resource-selector .resource-tree.multiple ul li.selectable > a > .selector {\n  display: inline-block;\n}\n.resource-selector .resource-tree .clickable:hover:before {\n  content: " ";\n  display: inline-block;\n  position: absolute;\n  width: 25px;\n  height: 25px;\n  top: 7.5px;\n  left: 0;\n  border-radius: 50%;\n  background-color: #b9bfc3;\n  opacity: 0.5;\n}\n.resource-selector .resource-tree .clickable:focus {\n  outline: 0 none;\n}\n.resource-selector .resource-tree ul {\n  list-style-type: none;\n  padding: 0;\n  margin: 0;\n}\n.resource-selector .resource-tree ul li {\n  position: relative;\n  cursor: pointer;\n}\n.resource-selector .resource-tree ul li > a {\n  height: 40px;\n  line-height: 40px;\n  display: block;\n  width: 100%;\n  padding-right: 30px;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  border-bottom: solid 1px #ddd;\n  color: #222;\n}\n.resource-selector .resource-tree ul li.class .class-toggler {\n  display: inline-block;\n  position: relative;\n  width: 25px;\n  height: 40px;\n  text-align: center;\n}\n.resource-selector .resource-tree ul li.class .class-toggler:after {\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n  font-size: 15px;\n  font-size: 1.5rem;\n  position: relative;\n}\n.resource-selector .resource-tree ul li.class.empty .class-toggler {\n  visibility: hidden;\n}\n.resource-selector .resource-tree ul li.class > a > .icon-folder:before {\n  content: "";\n  color: #d8ae5b;\n  margin-right: 4px;\n}\n.resource-selector .resource-tree ul li.class > a:hover {\n  background-color: #e7eff4;\n  color: #222;\n  transition: all, 200ms, linear, 0s;\n}\n.resource-selector .resource-tree ul li.class.selected > a {\n  background-color: #3e7da7;\n  color: white;\n  transition: all, 200ms, linear, 0s;\n}\n.resource-selector .resource-tree ul li.class.selected > a:before, .resource-selector .resource-tree ul li.class.selected > a:after {\n  color: white;\n}\n.resource-selector .resource-tree ul li.class.selected > a:hover {\n  background-color: #266d9c;\n  transition: all, 200ms, linear, 0s;\n}\n.resource-selector .resource-tree ul li.class.selected > a .clickable:hover:before {\n  background-color: #518ab0;\n}\n.resource-selector .resource-tree ul li.class.closed > a > .class-toggler:after {\n  content: "";\n}\n.resource-selector .resource-tree ul li.class.closed > a > .icon-folder:before {\n  content: "";\n}\n.resource-selector .resource-tree ul li.class.closed > ul {\n  display: none;\n}\n.resource-selector .resource-tree ul li.instance > a > [class^=icon-], .resource-selector .resource-tree ul li.instance > a > [class*=" icon-"] {\n  color: #0e5d91;\n  margin-right: 4px;\n  padding-left: 25px;\n  font-size: 16px;\n  font-size: 1.6rem;\n}\n.resource-selector .resource-tree ul li.instance:hover {\n  background-color: #e7eff4;\n  color: #222;\n  transition: all, 200ms, linear, 0s;\n}\n.resource-selector .resource-tree ul li.instance.selected {\n  background-color: #3e7da7;\n  transition: all, 200ms, linear, 0s;\n}\n.resource-selector .resource-tree ul li.instance.selected > a, .resource-selector .resource-tree ul li.instance.selected > a > [class^=icon-], .resource-selector .resource-tree ul li.instance.selected > a > [class*=" icon-"] {\n  color: white;\n}\n.resource-selector .resource-tree ul li.instance.selected:hover {\n  background-color: #266d9c;\n  transition: all, 200ms, linear, 0s;\n}\n.resource-selector .resource-tree ul li.instance.selected .clickable:hover:before {\n  background-color: #518ab0;\n}\n.resource-selector .resource-tree ul li > a > .selector {\n  display: none;\n  position: absolute;\n  top: 0;\n  right: 8px;\n  line-height: 40px;\n  height: 40px;\n  width: 25px;\n  text-align: center;\n}\n.resource-selector .resource-tree ul li > a > .selector:after {\n  transition: all, 200ms, linear, 0s;\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n  font-size: 15px;\n  font-size: 1.5rem;\n  color: #0e5d91;\n  line-height: 40px;\n  position: relative;\n}\n.resource-selector .resource-tree ul li.selected > a > .selector:after {\n  content: "";\n}\n.resource-selector .resource-tree ul li.selected > a > .selector:after, .resource-selector .resource-tree ul li.selected > a:hover > .selector:after {\n  color: white;\n}\n.resource-selector .resource-tree ul li[data-access=denied] > a [class^=icon-], .resource-selector .resource-tree ul li[data-access=denied] > a [class*=" icon-"], .resource-selector .resource-tree ul li[data-access=partial] > a [class^=icon-], .resource-selector .resource-tree ul li[data-access=partial] > a [class*=" icon-"] {\n  position: relative;\n}\n.resource-selector .resource-tree ul li[data-access=denied] > a [class^=icon-]:after, .resource-selector .resource-tree ul li[data-access=denied] > a [class*=" icon-"]:after, .resource-selector .resource-tree ul li[data-access=partial] > a [class^=icon-]:after, .resource-selector .resource-tree ul li[data-access=partial] > a [class*=" icon-"]:after {\n  content: "";\n  color: #555;\n  position: absolute;\n  left: 7px;\n  top: 6px;\n}\n.resource-selector .resource-tree ul li[data-access=denied] {\n  color: #a4a9b1;\n  background-color: white;\n}\n.resource-selector .resource-tree ul li[data-access=denied]:hover, .resource-selector .resource-tree ul li[data-access=denied]:hover > a, .resource-selector .resource-tree ul li[data-access=denied] > a, .resource-selector .resource-tree ul li[data-access=denied] [class^=icon-]:before, .resource-selector .resource-tree ul li[data-access=denied] [class*=" icon-"]:before {\n  cursor: auto;\n  background-color: white;\n  color: #a4a9b1 !important;\n}\n.resource-selector .resource-tree ul li a:hover {\n  text-decoration: none;\n}\n.resource-selector .filters {\n  position: relative;\n  height: 100%;\n  opacity: 0;\n}\n.resource-selector .filters.rendered {\n  opacity: 1;\n  transition: opacity, 300ms, linear, 0s;\n}\n.resource-selector .filters .ui-generis-form {\n  margin: 0;\n  padding: 10px;\n  width: 100%;\n  background-color: #f3f1ef;\n  border: none;\n}\n.resource-selector .filters .ui-generis-form h2 {\n  margin: 0;\n}\n.resource-selector .filters .ui-generis-form .left {\n  width: 100%;\n}\n.resource-selector .filters .ui-generis-form .toolbar {\n  margin: 0;\n}\n.resource-selector nav {\n  height: 40px;\n  flex: 0 1 40px;\n  border-top: solid 1px #ddd;\n}\n.resource-selector .context {\n  display: box;\n  display: -webkit-flexbox;\n  display: flexbox;\n  display: -ms-flex;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n  flex-pack: start;\n  justify-content: flex-start;\n  flex-line-pack: start;\n  align-content: flex-start;\n  flex-align: stretch;\n  align-items: stretch;\n  padding-right: 16px;\n}\n.resource-selector .context .class-context {\n  -ms-order: 0;\n  order: 0;\n  flex-item-align: stretch;\n  align-self: stretch;\n  flex: 1 1 auto;\n  flex: 1 1;\n  overflow: hidden;\n}\n.resource-selector .context .class-context .class-selector {\n  position: static;\n}\n.resource-selector .context .class-context .class-selector .options {\n  max-height: calc(100% - 120px);\n}\n.resource-selector .context .class-context .class-selector .options.folded {\n  max-height: 0;\n}\n.resource-selector .context > a {\n  display: inline-block;\n  width: 40px;\n  height: 40px;\n  padding: 10px 0 0 12px;\n  color: #222;\n  border-left: solid 1px white;\n  text-shadow: 0 0 0 transparent;\n  text-decoration: none;\n}\n.resource-selector .context > a:hover, .resource-selector .context > a.active {\n  color: #3e7da7;\n  transition: color, 200ms, linear, 0s;\n}\n.resource-selector .selection {\n  display: box;\n  display: -webkit-flexbox;\n  display: flexbox;\n  display: -ms-flex;\n  display: flex;\n  flex-direction: row;\n  flex-wrap: nowrap;\n  flex-pack: start;\n  justify-content: flex-start;\n  flex-line-pack: start;\n  align-content: flex-start;\n  flex-align: stretch;\n  align-items: stretch;\n  padding-right: 16px;\n}\n.resource-selector .selection .selection-control {\n  flex: 0 0 80px;\n}\n.resource-selector .selection .selection-control > label {\n  display: inline-block;\n  width: 40px;\n  height: 40px;\n  padding: 10px 0 0 12px;\n  color: #222;\n  border-left: solid 1px white;\n  text-shadow: 0 0 0 transparent;\n  text-decoration: none;\n  width: 36px;\n  padding: 10px 0 0 8px;\n  margin: 0;\n}\n.resource-selector .selection .selection-control > label:hover, .resource-selector .selection .selection-control > label.active {\n  color: #3e7da7;\n  transition: color, 200ms, linear, 0s;\n}\n.resource-selector .selection .selection-control > a {\n  display: inline-block;\n  width: 40px;\n  height: 40px;\n  padding: 10px 0 0 12px;\n  color: #222;\n  border-left: solid 1px white;\n  text-shadow: 0 0 0 transparent;\n  text-decoration: none;\n  width: 38px;\n}\n.resource-selector .selection .selection-control > a:hover, .resource-selector .selection .selection-control > a.active {\n  color: #3e7da7;\n  transition: color, 200ms, linear, 0s;\n}\n.resource-selector .selection .selection-control .selection-toggle .icon-multi-select:before {\n  font-size: 16px;\n  font-size: 1.6rem;\n}\n.resource-selector .selection .selection-control .selection-toggle.hidden {\n  display: inline-block !important;\n  visibility: hidden;\n}\n.resource-selector .selection .search {\n  -ms-order: 0;\n  order: 0;\n  flex-item-align: stretch;\n  align-self: stretch;\n  flex: 1 1 auto;\n  flex: 1 1;\n  position: relative;\n  padding: 6px 6px 6px 5px;\n}\n.resource-selector .selection .search:before {\n  /* use !important to prevent issues with browser extensions that change fonts */\n  font-family: "tao" !important;\n  speak: none;\n  font-style: normal;\n  font-weight: normal;\n  font-variant: normal;\n  text-transform: none;\n  line-height: 1;\n  /* Better Font Rendering =========== */\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  content: "";\n  position: absolute;\n  left: 12px;\n  top: 12px;\n  opacity: 0.4;\n}\n.resource-selector .selection .search input {\n  border-radius: 2px;\n  max-width: inherit;\n  width: 100%;\n  padding: 4px 25px;\n}\n.resource-selector .selection .search > a.filters-opener {\n  position: absolute;\n  right: 12px;\n  top: 10px;\n  font-size: 16px;\n  font-size: 1.6rem;\n  text-decoration: none;\n}\n.resource-selector .selection .filters-container {\n  position: absolute;\n  width: 100%;\n  background-color: #f3f1ef;\n  border: solid 1px #ddd;\n  -webkit-border-bottom-right-radius: 3px;\n  -webkit-border-bottom-left-radius: 3px;\n  -moz-border-radius-bottomright: 3px;\n  -moz-border-radius-bottomleft: 3px;\n  border-bottom-right-radius: 3px;\n  border-bottom-left-radius: 3px;\n  -ms-box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.2);\n  -o-box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.2);\n  box-shadow: 1px 1px 2px 0 rgba(0, 0, 0, 0.2);\n  left: 0;\n  top: 80px;\n  overflow-y: auto;\n  z-index: 100;\n  max-height: calc(100% - 110px);\n  transition: max-height, 300ms, ease, 0s;\n}\n.resource-selector .selection .filters-container.folded {\n  overflow: hidden;\n  max-height: 0;\n  border-width: 0;\n  transition: max-height, 300ms, ease, 0s;\n}\n.resource-selector main {\n  -ms-order: 0;\n  order: 0;\n  flex-item-align: stretch;\n  align-self: stretch;\n  flex: 1 1 auto;\n  flex: 1 1;\n  min-height: 150px;\n  border-top: solid 1px #ddd;\n  background-color: white;\n  height: 100%;\n  overflow-y: scroll;\n}\n.resource-selector main .no-results {\n  display: inline-block;\n  width: 100%;\n  text-align: center;\n  margin: 10px auto;\n  opacity: 0.75;\n}\n.resource-selector main .more {\n  height: 45px;\n  padding: 10px;\n}\n.resource-selector main.loading .more {\n  opacity: 0.65;\n  cursor: inherit;\n}\n.resource-selector footer {\n  height: 30px;\n  flex: 0 1 30px;\n  border-top: solid 1px #ddd;\n  background-color: #f3f1ef;\n  text-align: center;\n  padding: 5px;\n}\n/*# sourceMappingURL=selector.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.loading-button [class^=icon-], .loading-button [class*=" icon-"] {\n  padding: 0;\n}\n.loading-button .action-label, .loading-button .terminated-label {\n  margin-left: 9px;\n}\n.loading-button .spinner-icon, .loading-button .terminated-label {\n  display: none;\n}\n.loading-button.started {\n  cursor: default;\n  opacity: 0.5;\n}\n.loading-button.started .spinner-icon {\n  display: inline-block;\n  transform: translateZ(0);\n  transform-origin: 50% 50%;\n  animation: loading-button-rotate 1.4s infinite linear;\n}\n@keyframes loading-button-rotate {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n.loading-button.started .start-icon {\n  display: none;\n}\n.loading-button.terminated .action-label {\n  display: none;\n}\n.loading-button.terminated .terminated-label {\n  display: inline-block;\n}\n/*# sourceMappingURL=button.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\ndiv.task-report-container {\n  width: 100%;\n}\n/*# sourceMappingURL=taskable.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.destination-selector {\n  position: relative;\n  width: 400px;\n  opacity: 0;\n}\n.destination-selector.rendered {\n  opacity: 1;\n  transition: opacity, 300ms, linear, 0s;\n}\n.destination-selector > div {\n  border: 1px solid #ddd;\n  border-radius: 2px;\n  -webkit-border-radius: 2px;\n  background-color: #f3f1ef;\n  padding: 20px;\n  height: 500px;\n  position: relative;\n}\n.destination-selector > div > p {\n  font-weight: bold;\n}\n.destination-selector .selector-container {\n  position: relative;\n  height: calc(100% - 90px);\n}\n.destination-selector .actions {\n  margin-top: 30px;\n  text-align: right;\n}\n/*# sourceMappingURL=selector.css.map *//*\nUsage:\n- linear-gradient((color1, color2, color3)) - returns linear-gradient with evenly distributed colors,\n   if 3 colors used then the position of each will be 33,33%\n- linear-gradient((color1 0%, color2 30%, color3 80%)) - returns linear-gradient with manually distributed colors,\n   first param - color, second - position. Also you can use px or other valid units for set position.\n*/\n/* Do not edit */\n.switch {\n  display: inline-block;\n  position: relative;\n}\n.switch input {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n  opacity: 0;\n  cursor: pointer;\n}\n.switch label {\n  border: solid 1px #a4a9b1;\n  background-color: #f3f1ef;\n  border-radius: 2px;\n  padding: 1px;\n}\n.switch label span {\n  display: inline-block;\n  position: relative;\n  min-width: 50px;\n  border-radius: 2px;\n  text-align: center;\n}\n.switch input ~ label .on {\n  color: #222;\n  background-color: #f3f1ef;\n  transition: background-color 0.4s ease-out;\n}\n.switch input ~ label .off {\n  color: white;\n  background-color: #a4a9b1;\n  transition: background-color 0.4s ease-out;\n}\n.switch input:checked ~ label .on {\n  color: white;\n  background-color: #0e5d91;\n  transition: background-color 0.4s ease-out;\n}\n.switch input:checked ~ label .off {\n  color: #222;\n  background-color: #f3f1ef;\n  transition: background-color 0.4s ease-out;\n}\n.switch input:focus ~ label {\n  border: solid 1px #0e5d91;\n}\n.switch.monostyle input ~ label .off {\n  color: white;\n  background-color: #0e5d91;\n  transition: background-color 0.4s ease-out;\n}\n.switch.monostyle input:checked ~ label .off {\n  color: #222;\n  background-color: #f3f1ef;\n  transition: background-color 0.4s ease-out;\n}\n/*# sourceMappingURL=switch.css.map */.section-container .content-block .multi-form-container{background:#f3f1ef;padding:30px;border:1px #ddd solid;border:1px solid #ddd;border-radius:2px;-webkit-border-radius:2px;min-width:550px}.section-container .content-block .multi-form-container form{background:inherit;padding:0;border:none}.section-container .content-block .multi-form-container form .form-toolbar .loading-button{float:right}.section-container .content-block .multi-form-container .form-switch-block{padding-bottom:30px}.section-container .content-block .multi-form-container .form-switch-block>label{display:inline-block;width:35%}.section-container .content-block .multi-form-container .form-switch-block .form-switch{display:inline-block;width:64%}.section-container .content-block .multi-form-container .form-switch-block .form-switch label{display:flex;flex-wrap:nowrap;padding:0px}.section-container .content-block .multi-form-container .form-switch-block .form-switch label span{padding:2px 8px}\n\n/*# sourceMappingURL=wizard.css.map */'
),define("taoLtiConsumer/loader/taoLtiConsumer.bundle",function(){});
//# sourceMappingURL=taoLtiConsumer.min.js.map